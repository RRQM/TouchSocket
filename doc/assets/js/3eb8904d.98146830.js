"use strict";(self.webpackChunkfurion=self.webpackChunkfurion||[]).push([[5887],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>c});var r=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var p=r.createContext({}),s=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},d=function(e){var n=s(e.components);return r.createElement(p.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=s(t),c=i,k=u["".concat(p,".").concat(c)]||u[c]||m[c]||a;return t?r.createElement(k,o(o({ref:n},d),{},{components:t})):r.createElement(k,o({ref:n},d))}));function c(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,o=new Array(a);o[0]=u;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var s=2;s<a;s++)o[s]=t[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},6132:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>p,toc:()=>d});var r=t(7462),i=(t(7294),t(3905)),a=t(4996);const o={id:"friendly-exception",title:"7. \u53cb\u597d\u5f02\u5e38\u5904\u7406",sidebar_label:"7. \u53cb\u597d\u5f02\u5e38\u5904\u7406"},l=void 0,p={unversionedId:"friendly-exception",id:"friendly-exception",title:"7. \u53cb\u597d\u5f02\u5e38\u5904\u7406",description:"7.1 \u4ec0\u4e48\u662f\u5f02\u5e38",source:"@site/docs/friendly-exception.mdx",sourceDirName:".",slug:"/friendly-exception",permalink:"/docs/friendly-exception",draft:!1,editUrl:"https://gitee.com/dotnetchina/Furion/tree/v4/handbook/docs/friendly-exception.mdx",tags:[],version:"current",frontMatter:{id:"friendly-exception",title:"7. \u53cb\u597d\u5f02\u5e38\u5904\u7406",sidebar_label:"7. \u53cb\u597d\u5f02\u5e38\u5904\u7406"},sidebar:"docs",previous:{title:"6. \u89c4\u8303\u5316\u63a5\u53e3\u6587\u6863 (Swagger)",permalink:"/docs/specification-document"},next:{title:"8. \u6570\u636e\u6821\u9a8c",permalink:"/docs/data-validation"}},s={},d=[{value:"7.1 \u4ec0\u4e48\u662f\u5f02\u5e38",id:"71-\u4ec0\u4e48\u662f\u5f02\u5e38",level:2},{value:"7.2 \u5904\u7406\u5f02\u5e38\u65b9\u5f0f",id:"72-\u5904\u7406\u5f02\u5e38\u65b9\u5f0f",level:2},{value:"7.3 \u4ec0\u4e48\u662f\u53cb\u597d\u5f02\u5e38\u5904\u7406",id:"73-\u4ec0\u4e48\u662f\u53cb\u597d\u5f02\u5e38\u5904\u7406",level:2},{value:"7.3.1 \u975e\u53cb\u597d\u5f02\u5e38\u5904\u7406",id:"731-\u975e\u53cb\u597d\u5f02\u5e38\u5904\u7406",level:3},{value:"7.3.2 \u53cb\u597d\u5f02\u5e38\u5904\u7406",id:"732-\u53cb\u597d\u5f02\u5e38\u5904\u7406",level:3},{value:"7.4 \u53cb\u597d\u5f02\u5e38\u5904\u7406\u4f7f\u7528\u793a\u4f8b",id:"74-\u53cb\u597d\u5f02\u5e38\u5904\u7406\u4f7f\u7528\u793a\u4f8b",level:2},{value:"7.4.1 \u6ce8\u518c\u53cb\u597d\u5f02\u5e38\u670d\u52a1",id:"741-\u6ce8\u518c\u53cb\u597d\u5f02\u5e38\u670d\u52a1",level:3},{value:"7.4.2 \u4e24\u4e2a\u4f8b\u5b50",id:"742-\u4e24\u4e2a\u4f8b\u5b50",level:3},{value:"\u7b80\u5355\u629b\u4e2a\u5f02\u5e38",id:"\u7b80\u5355\u629b\u4e2a\u5f02\u5e38",level:4},{value:"\u629b\u51fa\u7279\u5b9a\u7c7b\u578b\u5f02\u5e38",id:"\u629b\u51fa\u7279\u5b9a\u7c7b\u578b\u5f02\u5e38",level:4},{value:"7.5 \u5173\u4e8e Oops.Oh",id:"75-\u5173\u4e8e-oopsoh",level:2},{value:"7.5.1 \u4e3a\u4ec0\u4e48\u8d77\u8fd9\u4e2a\u540d\u5b57\uff1f",id:"751-\u4e3a\u4ec0\u4e48\u8d77\u8fd9\u4e2a\u540d\u5b57",level:3},{value:"7.5.2 <code>Oops.Oh</code> \u91cd\u8f7d\u65b9\u6cd5",id:"752-oopsoh-\u91cd\u8f7d\u65b9\u6cd5",level:3},{value:"7.6 \u6700\u4f73\u5b9e\u8df5 \ud83e\udd17",id:"76-\u6700\u4f73\u5b9e\u8df5-",level:2},{value:"7.6.1 \u521b\u5efa\u5f02\u5e38\u4fe1\u606f\u7c7b\u578b",id:"761-\u521b\u5efa\u5f02\u5e38\u4fe1\u606f\u7c7b\u578b",level:3},{value:"7.6.2 \u5173\u4e8e <code>[ErrorCodeItemMetadata]</code>",id:"762-\u5173\u4e8e-errorcodeitemmetadata",level:3},{value:"7.6.3 \u9759\u6001\u5f02\u5e38\u7c7b\u4f7f\u7528",id:"763-\u9759\u6001\u5f02\u5e38\u7c7b\u4f7f\u7528",level:3},{value:"7.6.4 \u5f02\u5e38\u65b9\u6cd5\u91cd\u8bd5",id:"764-\u5f02\u5e38\u65b9\u6cd5\u91cd\u8bd5",level:3},{value:"7.6.5 \u66f4\u591a\u4f8b\u5b50",id:"765-\u66f4\u591a\u4f8b\u5b50",level:3},{value:"7.7 \u591a\u4e2a\u5f02\u5e38\u4fe1\u606f\u7c7b\u578b",id:"77-\u591a\u4e2a\u5f02\u5e38\u4fe1\u606f\u7c7b\u578b",level:2},{value:"7.8 <code>IErrorCodeTypeProvider</code> \u63d0\u4f9b\u5668",id:"78-ierrorcodetypeprovider-\u63d0\u4f9b\u5668",level:2},{value:"7.9 <code>appsetting.json</code> \u4e2d\u914d\u7f6e",id:"79-appsettingjson-\u4e2d\u914d\u7f6e",level:2},{value:"\u4f7f\u7528\u793a\u4f8b",id:"\u4f7f\u7528\u793a\u4f8b",level:4},{value:"7.10 <code>[IfException]</code> \u4f7f\u7528",id:"710-ifexception-\u4f7f\u7528",level:2},{value:"7.10.1 \u4f7f\u7528\u793a\u4f8b",id:"7101-\u4f7f\u7528\u793a\u4f8b",level:3},{value:"7.10.2 \u66f4\u591a\u4f8b\u5b50",id:"7102-\u66f4\u591a\u4f8b\u5b50",level:3},{value:"7.11 \u5f02\u5e38\u6d88\u606f\u4f18\u5148\u7ea7",id:"711-\u5f02\u5e38\u6d88\u606f\u4f18\u5148\u7ea7",level:2},{value:"7.12 \u591a\u8bed\u8a00\u652f\u6301",id:"712-\u591a\u8bed\u8a00\u652f\u6301",level:2},{value:"7.13 \u89c4\u8303\u5316\u7ed3\u679c\u5f02\u5e38\u5904\u7406",id:"713-\u89c4\u8303\u5316\u7ed3\u679c\u5f02\u5e38\u5904\u7406",level:2},{value:"7.14 \u5168\u5c40\u5f02\u5e38\u5904\u7406\u63d0\u4f9b\u5668",id:"714-\u5168\u5c40\u5f02\u5e38\u5904\u7406\u63d0\u4f9b\u5668",level:2},{value:"7.15 <code>FriendlyExceptionSettings</code> \u914d\u7f6e",id:"715-friendlyexceptionsettings-\u914d\u7f6e",level:2},{value:"7.16 <code>BadPageResult</code> \u9519\u8bef\u9875",id:"716-badpageresult-\u9519\u8bef\u9875",level:2},{value:"7.17 \u53cd\u9988\u4e0e\u5efa\u8bae",id:"717-\u53cd\u9988\u4e0e\u5efa\u8bae",level:2}],m={toc:d};function u(e){let{components:n,...t}=e;return(0,i.kt)("wrapper",(0,r.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"71-\u4ec0\u4e48\u662f\u5f02\u5e38"},"7.1 \u4ec0\u4e48\u662f\u5f02\u5e38"),(0,i.kt)("p",null,"\u5f02\u5e38\u4e00\u822c\u662f\u6307\u8fd0\u884c\u671f\uff08\u6b64\u5904\u7279\u6307 ",(0,i.kt)("inlineCode",{parentName:"p"},"Exception")," \u7c7b\uff09\u4f1a\u53d1\u751f\u7684\u5bfc\u81f4\u7a0b\u5e8f\u610f\u5916\u4e2d\u6b62\u7684\u95ee\u9898\uff0c\u662f\u4e00\u79cd\u5bf9\u95ee\u9898\u7684\u63cf\u8ff0\u540e\u7684\u5c01\u88c5\u5bf9\u8c61\u3002"),(0,i.kt)("p",null,"\u5728\u8fc7\u53bb\u5f00\u53d1\u4e2d\uff0c\u901a\u5e38\u5f02\u5e38\u7531\u7cfb\u7edf\u8fd0\u884c\u65f6\u51fa\u9519\u629b\u51fa\uff0c\u4f46\u73b0\u5728\u7684\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u5e94\u5728\u7a0b\u5e8f\u5f00\u53d1\u4e2d\u5408\u7406\u7684\u629b\u51fa\u5f02\u5e38\uff0c\u6bd4\u5982\u66f4\u65b0\u4e00\u6761\u4e0d\u5b58\u5728\u7684\u5b9e\u4f53\uff0c\u6216\u67e5\u8be2\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u6570\u636e\u7b49\u7b49\u3002"),(0,i.kt)("h2",{id:"72-\u5904\u7406\u5f02\u5e38\u65b9\u5f0f"},"7.2 \u5904\u7406\u5f02\u5e38\u65b9\u5f0f"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4e0d\u5904\u7406\uff0c\u76f4\u63a5\u4e2d\u65ad\u7a0b\u5e8f\u6267\u884c\uff08\u4e0d\u63a8\u8350\uff09"),(0,i.kt)("li",{parentName:"ul"},"\u901a\u8fc7 ",(0,i.kt)("inlineCode",{parentName:"li"},"try catch finally")," \u5904\u7406\uff08\u4e0d\u63a8\u8350\uff09"),(0,i.kt)("li",{parentName:"ul"},"\u5168\u5c40\u7edf\u4e00\u5904\u7406\uff0c\u5e76\u8bb0\u5f55\u5f02\u5e38\u4fe1\u606f",(0,i.kt)("strong",{parentName:"li"},"\uff08\u63a8\u8350\uff09")),(0,i.kt)("li",{parentName:"ul"},"\u5f02\u5e38\u6ce8\u89e3\u65b9\u5f0f\u5904\u7406\uff0c\u652f\u6301",(0,i.kt)("strong",{parentName:"li"},"\u672c\u5730\u5316")," ",(0,i.kt)("strong",{parentName:"li"},"\uff08\u63a8\u8350\uff09"))),(0,i.kt)("h2",{id:"73-\u4ec0\u4e48\u662f\u53cb\u597d\u5f02\u5e38\u5904\u7406"},"7.3 \u4ec0\u4e48\u662f\u53cb\u597d\u5f02\u5e38\u5904\u7406"),(0,i.kt)("h3",{id:"731-\u975e\u53cb\u597d\u5f02\u5e38\u5904\u7406"},"7.3.1 \u975e\u53cb\u597d\u5f02\u5e38\u5904\u7406"),(0,i.kt)("p",null,"\u5728\u4e86\u89e3\u53cb\u597d\u5f02\u5e38\u5904\u7406\u4e4b\u524d\u53ef\u4ee5\u770b\u770b\u975e\u53cb\u597d\u5f02\u5e38\u5904\u7406\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5bf9\u7ec8\u7aef\u7528\u6237\u629b\u51fa ",(0,i.kt)("inlineCode",{parentName:"li"},"500\u72b6\u6001\u7801")," \u5806\u6808\u4fe1\u606f"),(0,i.kt)("li",{parentName:"ul"},"\u5927\u91cf\u7684 ",(0,i.kt)("inlineCode",{parentName:"li"},"try catch")," \u4ee3\u7801\uff0c\u6c61\u67d3\u6b63\u5e38\u4e1a\u52a1\u903b\u8f91"),(0,i.kt)("li",{parentName:"ul"},"\u6ca1\u6709\u89c4\u8303\u5316\u7684\u5f02\u5e38\u72b6\u6001\u7801\u548c\u5f02\u5e38\u6d88\u606f\u7ba1\u7406"),(0,i.kt)("li",{parentName:"ul"},"\u6ca1\u6709\u5f02\u5e38\u65e5\u5fd7\u6536\u96c6\u8bb0\u5f55"),(0,i.kt)("li",{parentName:"ul"},"\u4e0d\u652f\u6301\u5f02\u5e38\u6d88\u606f\u672c\u5730\u5316\u5904\u7406"),(0,i.kt)("li",{parentName:"ul"},"\u4e0d\u652f\u6301\u5f02\u5e38\u7b56\u7565\uff0c\u5931\u8d25\u540e\u7a0b\u5e8f\u7acb\u5373\u7ec8\u6b62"),(0,i.kt)("li",{parentName:"ul"},"\u4e0d\u652f\u6301\u5206\u5e03\u5f0f\u4e8b\u52a1 CAP"),(0,i.kt)("li",{parentName:"ul"},"\u4e0d\u652f\u6301\u5f02\u5e38\u4f20\u64ad"),(0,i.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u7684\u5f02\u5e38\u683c\u5f0f\u6742\u4e71")),(0,i.kt)("h3",{id:"732-\u53cb\u597d\u5f02\u5e38\u5904\u7406"},"7.3.2 \u53cb\u597d\u5f02\u5e38\u5904\u7406"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5bf9\u7ec8\u7aef\u7528\u6237\u63d0\u793a\u53cb\u597d"),(0,i.kt)("li",{parentName:"ul"},"\u5bf9\u540e\u7aef\u5f00\u53d1\u4eba\u5458\u63d0\u4f9b\u8be6\u7ec6\u7684\u5f02\u5e38\u5806\u6808"),(0,i.kt)("li",{parentName:"ul"},"\u4e0d\u5e72\u6270\u6b63\u5e38\u4e1a\u52a1\u903b\u8f91\u4ee3\u7801\uff0c\u5982 \u6ca1\u6709 ",(0,i.kt)("inlineCode",{parentName:"li"},"try catch")," \u4ee3\u7801"),(0,i.kt)("li",{parentName:"ul"},"\u652f\u6301\u5f02\u5e38\u72b6\u6001\u7801\u591a\u65b9\u8bbe\u7f6e"),(0,i.kt)("li",{parentName:"ul"},"\u652f\u6301\u5f02\u5e38\u6d88\u606f\u672c\u5730\u5316"),(0,i.kt)("li",{parentName:"ul"},"\u5f02\u5e38\u4fe1\u606f\u7edf\u4e00\u914d\u7f6e\u7ba1\u7406"),(0,i.kt)("li",{parentName:"ul"},"\u652f\u6301\u5f02\u5e38\u7b56\u7565\uff0c\u5982\u91cd\u8bd5"),(0,i.kt)("li",{parentName:"ul"},"\u652f\u6301\u5f02\u5e38\u65e5\u5fd7\u6536\u96c6\u8bb0\u5f55"),(0,i.kt)("li",{parentName:"ul"},"\u652f\u6301 CAP \u5206\u5e03\u5f0f\u4e8b\u52a1\u5173\u8054"),(0,i.kt)("li",{parentName:"ul"},"\u652f\u6301\u5185\u90e8\u5f02\u5e38\u5916\u90e8\u4f20\u64ad"),(0,i.kt)("li",{parentName:"ul"},"\u652f\u6301\u8fd4\u56de\u7edf\u4e00\u7684\u5f02\u5e38\u683c\u5f0f\u6570\u636e")),(0,i.kt)("h2",{id:"74-\u53cb\u597d\u5f02\u5e38\u5904\u7406\u4f7f\u7528\u793a\u4f8b"},"7.4 \u53cb\u597d\u5f02\u5e38\u5904\u7406\u4f7f\u7528\u793a\u4f8b"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Furion")," \u6846\u67b6\u63d0\u4f9b\u4e86\u975e\u5e38\u7075\u6d3b\u7684\u53cb\u597d\u5f02\u5e38\u5904\u7406\u65b9\u5f0f\u3002"),(0,i.kt)("admonition",{title:"\u5c0f\u63d0\u793a",type:"tip"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},".AddFriendlyException()")," \u9ed8\u8ba4\u5df2\u7ecf\u96c6\u6210\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"AddInject()")," \u4e2d\u4e86\uff0c",(0,i.kt)("strong",{parentName:"p"},"\u65e0\u9700\u518d\u6b21\u6ce8\u518c"),"\u3002\u4e5f\u5c31\u662f ",(0,i.kt)("inlineCode",{parentName:"p"},"7.4.1")," \u7ae0\u8282\u53ef\u4e0d\u914d\u7f6e\u3002")),(0,i.kt)("h3",{id:"741-\u6ce8\u518c\u53cb\u597d\u5f02\u5e38\u670d\u52a1"},"7.4.1 \u6ce8\u518c\u53cb\u597d\u5f02\u5e38\u670d\u52a1"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:'showLineNumbers  {11} title="Furion.Web.Core\\FurWebCoreStartup.cs"',showLineNumbers:!0,"":!0,"{11}":!0,title:'"Furion.Web.Core\\FurWebCoreStartup.cs"'},"using Microsoft.Extensions.DependencyInjection;\n\nnamespace Furion.Web.Core\n{\n    [AppStartup(800)]\n    public sealed class FurWebCoreStartup : AppStartup\n    {\n        public void ConfigureServices(IServiceCollection services)\n        {\n            services.AddControllers()\n                    .AddFriendlyException();\n        }\n    }\n}\n")),(0,i.kt)("admonition",{title:"\u7279\u522b\u6ce8\u610f",type:"important"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},".AddFriendlyException()")," \u9700\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"services.AddControllers()")," \u4e4b\u540e\u6ce8\u518c\u3002")),(0,i.kt)("h3",{id:"742-\u4e24\u4e2a\u4f8b\u5b50"},"7.4.2 \u4e24\u4e2a\u4f8b\u5b50"),(0,i.kt)("h4",{id:"\u7b80\u5355\u629b\u4e2a\u5f02\u5e38"},"\u7b80\u5355\u629b\u4e2a\u5f02\u5e38"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {2,12}",showLineNumbers:!0,"":!0,"{2,12}":!0},'using Furion.DynamicApiController;\nusing Furion.FriendlyException;\n\nnamespace Furion.Application\n{\n    public class FurionAppService : IDynamicApiController\n    {\n        public int Get(int id)\n        {\n            if (id < 3)\n            {\n                throw Oops.Oh($"{id} \u4e0d\u80fd\u5c0f\u4e8e3");\n            }\n\n            return id;\n        }\n    }\n}\n')),(0,i.kt)("p",null,"\u5982\u4e0b\u56fe\u6240\u793a\uff1a"),(0,i.kt)("img",{src:(0,a.Z)("img/yhyc1.gif")}),(0,i.kt)("h4",{id:"\u629b\u51fa\u7279\u5b9a\u7c7b\u578b\u5f02\u5e38"},"\u629b\u51fa\u7279\u5b9a\u7c7b\u578b\u5f02\u5e38"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {2,13}",showLineNumbers:!0,"":!0,"{2,13}":!0},'using Furion.DynamicApiController;\nusing Furion.FriendlyException;\nusing System;\n\nnamespace Furion.Application\n{\n    public class FurionAppService : IDynamicApiController\n    {\n        public int Get(int id)\n        {\n            if (id < 3)\n            {\n                throw Oops.Oh($"{id} \u4e0d\u80fd\u5c0f\u4e8e3\u3002", typeof(InvalidOperationException));\n            }\n\n            return id;\n        }\n    }\n}\n')),(0,i.kt)("p",null,"\u5982\u4e0b\u56fe\u6240\u793a\uff1a"),(0,i.kt)("img",{src:(0,a.Z)("img/yhyc2.png")}),(0,i.kt)("h2",{id:"75-\u5173\u4e8e-oopsoh"},"7.5 \u5173\u4e8e Oops.Oh"),(0,i.kt)("p",null,"\u901a\u8fc7\u4e0a\u9762\u7684\u4f8b\u5b50\u53ef\u4ee5\u770b\u51fa\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"Oops.Oh(errorMessage)")," \u53ef\u4ee5\u7ed3\u5408 ",(0,i.kt)("inlineCode",{parentName:"p"},"throw")," \u629b\u51fa\u5f02\u5e38\u3002\u5bf9\u4e8e\u719f\u6089",(0,i.kt)("inlineCode",{parentName:"p"},"C#"),"\u7684\u4eba\u5458\u6765\u8bf4\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"throw")," \u540e\u9762\u53ea\u80fd ",(0,i.kt)("inlineCode",{parentName:"p"},"Exception")," \u5b9e\u4f8b\u3002",(0,i.kt)("inlineCode",{parentName:"p"},"Oops.Oh(...)")," \u65b9\u6cd5\u8fd4\u56de\u6b63\u662f ",(0,i.kt)("inlineCode",{parentName:"p"},"Exception")," \u5b9e\u4f8b\u3002"),(0,i.kt)("h3",{id:"751-\u4e3a\u4ec0\u4e48\u8d77\u8fd9\u4e2a\u540d\u5b57"},"7.5.1 \u4e3a\u4ec0\u4e48\u8d77\u8fd9\u4e2a\u540d\u5b57\uff1f"),(0,i.kt)("p",null,"\u8fd9\u4e2a\u540d\u5b57\u6765\u6e90\u4e8e\u4e00\u4e2a\u82f1\u8bed\u53e5\u5b50\uff1a",(0,i.kt)("inlineCode",{parentName:"p"},"Oh, Oops!"),"\uff0c\u610f\u601d\u662f ",(0,i.kt)("strong",{parentName:"p"},"\u5662\uff08\u54ce\uff09\uff0c\u51fa\u9519\u4e86\uff01"),"\uff0c\u6240\u4ee5\u5c31\u6709\u4e86 ",(0,i.kt)("inlineCode",{parentName:"p"},"Oops.Oh"),"\u3002"),(0,i.kt)("h3",{id:"752-oopsoh-\u91cd\u8f7d\u65b9\u6cd5"},"7.5.2 ",(0,i.kt)("inlineCode",{parentName:"h3"},"Oops.Oh")," \u91cd\u8f7d\u65b9\u6cd5"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {13,22,30,39}",showLineNumbers:!0,"":!0,"{13,22,30,39}":!0},'using System;\n\nnamespace Furion.FriendlyException\n{\n    public static class Oops\n    {\n        /// <summary>\n        /// \u629b\u51fa\u5b57\u7b26\u4e32\u5f02\u5e38\n        /// </summary>\n        /// <param name="errorMessage">\u5f02\u5e38\u6d88\u606f</param>\n        /// <param name="args">String.Format \u53c2\u6570</param>\n        /// <returns>\u5f02\u5e38\u5b9e\u4f8b</returns>\n        public static Exception Oh(string errorMessage, params object[] args);\n\n        /// <summary>\n        /// \u629b\u51fa\u5b57\u7b26\u4e32\u5f02\u5e38\n        /// </summary>\n        /// <param name="errorMessage">\u5f02\u5e38\u6d88\u606f</param>\n        /// <param name="exceptionType">\u5177\u4f53\u5f02\u5e38\u7c7b\u578b</param>\n        /// <param name="args">String.Format \u53c2\u6570</param>\n        /// <returns>\u5f02\u5e38\u5b9e\u4f8b</returns>\n        public static Exception Oh(string errorMessage, Type exceptionType, params object[] args);\n\n        /// <summary>\n        /// \u629b\u51fa\u9519\u8bef\u7801\u5f02\u5e38\n        /// </summary>\n        /// <param name="errorCode">\u9519\u8bef\u7801</param>\n        /// <param name="args">String.Format \u53c2\u6570</param>\n        /// <returns>\u5f02\u5e38\u5b9e\u4f8b</returns>\n        public static Exception Oh(object errorCode, params object[] args);\n\n        /// <summary>\n        /// \u629b\u51fa\u9519\u8bef\u7801\u5f02\u5e38\n        /// </summary>\n        /// <param name="errorCode">\u9519\u8bef\u7801</param>\n        /// <param name="exceptionType">\u5177\u4f53\u5f02\u5e38\u7c7b\u578b</param>\n        /// <param name="args">String.Format \u53c2\u6570</param>\n        /// <returns>\u5f02\u5e38\u5b9e\u4f8b</returns>\n        public static Exception Oh(object errorCode, Type exceptionType, params object[] args);\n    }\n}\n')),(0,i.kt)("h2",{id:"76-\u6700\u4f73\u5b9e\u8df5-"},"7.6 \u6700\u4f73\u5b9e\u8df5 \ud83e\udd17"),(0,i.kt)("p",null,"\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"Furion")," \u6846\u67b6\u4e2d\uff0c\u63d0\u4f9b\u4e86\u975e\u5e38\u7075\u6d3b\u4e14\u89c4\u8303\u5316\u7684\u53cb\u597d\u5f02\u5e38\u5904\u7406\u65b9\u5f0f\uff0c\u901a\u8fc7\u8fd9\u4e2a\u65b9\u5f0f\u53ef\u4ee5\u65b9\u4fbf\u7ba1\u7406\u5f02\u5e38\u72b6\u6001\u7801\u3001\u5f02\u5e38\u4fe1\u606f\u53ca\u5f02\u5e38\u672c\u5730\u5316\u3002"),(0,i.kt)("h3",{id:"761-\u521b\u5efa\u5f02\u5e38\u4fe1\u606f\u7c7b\u578b"},"7.6.1 \u521b\u5efa\u5f02\u5e38\u4fe1\u606f\u7c7b\u578b"),(0,i.kt)("p",null,"\u5b9e\u73b0\u81ea\u5b9a\u4e49\u5f02\u5e38\u4fe1\u606f\u7c7b\u578b\u5fc5\u987b\u9075\u5faa\u4ee5\u4e0b\u914d\u7f6e\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u7c7b\u578b\u5fc5\u987b\u662f\u516c\u5f00\u4e14\u662f ",(0,i.kt)("inlineCode",{parentName:"li"},"Enum")," \u679a\u4e3e\u7c7b\u578b"),(0,i.kt)("li",{parentName:"ul"},"\u679a\u4e3e\u7c7b\u578b\u5fc5\u987b\u8d34\u6709 ",(0,i.kt)("inlineCode",{parentName:"li"},"[ErrorCodeType]")," \u7279\u6027"),(0,i.kt)("li",{parentName:"ul"},"\u679a\u4e3e\u4e2d\u6bcf\u4e00\u9879\u5fc5\u987b\u8d34\u6709 ",(0,i.kt)("inlineCode",{parentName:"li"},"[ErrorCodeItemMetadata]")," \u7279\u6027")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {1,5,8,11,14,17}",showLineNumbers:!0,"":!0,"{1,5,8,11,14,17}":!0},'using Furion.FriendlyException;\n\nnamespace Furion.Application\n{\n    [ErrorCodeType]\n    public enum ErrorCodes\n    {\n        [ErrorCodeItemMetadata("{0} \u4e0d\u80fd\u5c0f\u4e8e {1}")]\n        z1000,\n\n        [ErrorCodeItemMetadata("\u6570\u636e\u4e0d\u5b58\u5728")]\n        x1000,\n\n        [ErrorCodeItemMetadata("{0} \u53d1\u73b0 {1} \u4e2a\u5f02\u5e38", "\u767e\u5c0f\u50e7", 2)]\n        x1001,\n\n        [ErrorCodeItemMetadata("\u670d\u52a1\u5668\u8fd0\u884c\u5f02\u5e38", ErrorCode = "Error")]\n        SERVER_ERROR\n    }\n}\n')),(0,i.kt)("admonition",{type:"important"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"Furion")," \u6846\u67b6\u63d0\u4f9b\u4e86 ",(0,i.kt)("inlineCode",{parentName:"p"},"[ErrorCodeType]")," \u7279\u6027\u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"IErrorCodeTypeProvider")," \u63d0\u4f9b\u5668\u63a5\u53e3\u6765\u63d0\u4f9b\u5f02\u5e38\u4fe1\u606f\u626b\u63cf\uff0c\u8fd9\u91cc\u7528\u7684\u662f ",(0,i.kt)("inlineCode",{parentName:"p"},"[ErrorCodeType]")," \u7279\u6027\u7c7b\u3002")),(0,i.kt)("h3",{id:"762-\u5173\u4e8e-errorcodeitemmetadata"},"7.6.2 \u5173\u4e8e ",(0,i.kt)("inlineCode",{parentName:"h3"},"[ErrorCodeItemMetadata]")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Furion")," \u6846\u67b6\u63d0\u4f9b\u4e86",(0,i.kt)("inlineCode",{parentName:"p"},"[ErrorCodeItemMetadata]")," \u7279\u6027\u7528\u6765\u6807\u8bc6",(0,i.kt)("strong",{parentName:"p"},"\u679a\u4e3e\u5b57\u6bb5"),"\u5f02\u5e38\u5143\u6570\u636e\uff0c\u8be5\u7279\u6027\u652f\u6301\u4f20\u5165 ",(0,i.kt)("inlineCode",{parentName:"p"},"\u6d88\u606f\u5185\u5bb9")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"\u683c\u5f0f\u5316\u53c2\u6570"),"\u3002\u6700\u7ec8\u4f1a\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"String.Format(\u6d88\u606f\u5185\u5bb9\uff0c\u683c\u5f0f\u5316\u53c2\u6570)")," \u8fdb\u884c\u683c\u5f0f\u5316\u3002"),(0,i.kt)("p",null,"\u5982\u679c\u6d88\u606f\u5185\u5bb9\u4e2d\u5305\u542b",(0,i.kt)("inlineCode",{parentName:"p"},"\u683c\u5f0f\u5316\u5360\u4f4d\u7b26"),"\u4f46\u672a\u6307\u5b9a",(0,i.kt)("inlineCode",{parentName:"p"},"\u683c\u5f0f\u5316\u53c2\u6570"),"\uff0c\u90a3\u4e48\u4f1a\u67e5\u627e\u5f02\u5e38\u6240\u5728\u65b9\u6cd5\u662f\u5426\u8d34\u6709 ",(0,i.kt)("inlineCode",{parentName:"p"},"[IfException]")," \u7279\u6027\u4e14\u542b\u6709\u683c\u5f0f\u5316\u53c2\u6570\uff0c\u63a5\u7740\u5c31\u4f1a\u67e5\u627e ",(0,i.kt)("inlineCode",{parentName:"p"},"Oops.Oh")," \u4e2d\u6307\u5b9a\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"\u683c\u5f0f\u5316\u53c2\u6570"),"\u3002"),(0,i.kt)("h3",{id:"763-\u9759\u6001\u5f02\u5e38\u7c7b\u4f7f\u7528"},"7.6.3 \u9759\u6001\u5f02\u5e38\u7c7b\u4f7f\u7528"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {2,12}",showLineNumbers:!0,"":!0,"{2,12}":!0},"using Furion.DynamicApiController;\nusing Furion.FriendlyException;\n\nnamespace Furion.Application\n{\n    public class FurionAppService : IDynamicApiController\n    {\n        public int Get(int id)\n        {\n            if (id < 3)\n            {\n                throw Oops.Oh(ErrorCodes.z1000, id, 3);\n            }\n\n            return id;\n        }\n    }\n}\n")),(0,i.kt)("p",null,"\u5982\u4e0b\u56fe\u6240\u793a\uff1a"),(0,i.kt)("img",{src:(0,a.Z)("img/yhyc3.gif")}),(0,i.kt)("h3",{id:"764-\u5f02\u5e38\u65b9\u6cd5\u91cd\u8bd5"},"7.6.4 \u5f02\u5e38\u65b9\u6cd5\u91cd\u8bd5"),(0,i.kt)("admonition",{title:"\u8c03\u6574\u8bf4\u660e",type:"important"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"v2.17.0+")," \u7248\u672c\u4e0b\u9762\u65b9\u6cd5\u8bf7\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"Retry.Invoke()")," \u66ff\u4ee3\u3002")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers",showLineNumbers:!0},"Oops.Retry(() => {\n    // Do.....\n}, 3, 1000);\n\n// \u5e26\u8fd4\u56de\u503c\nvar value = Oops.Retry<int>(() => {\n    // Do.....\n}, 3, 1000);\n\n// \u53ea\u6709\u7279\u5b9a\u5f02\u5e38\u624d\u76d1\u542c\nOops.Retry(() => {\n\n}, 3, 1000, typeof(ArgumentNullException));\n")),(0,i.kt)("h3",{id:"765-\u66f4\u591a\u4f8b\u5b50"},"7.6.5 \u66f4\u591a\u4f8b\u5b50"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {6}",showLineNumbers:!0,"":!0,"{6}":!0},'throw Oops.Oh(1000);\nthrow Oops.Oh(ErrorCodes.x1000);\nthrow Oops.Oh("\u54c8\u54c8\u54c8\u54c8");\nthrow Oops.Oh(errorCode: "x1001");\nthrow Oops.Oh(1000, typeof(Exception));\nthrow Oops.Oh(1000).StatusCode(400);    // \u8bbe\u7f6e\u9519\u8bef\u7801\nthrow Oops.Oh(1000).WithData(new Model {});    // \u8bbe\u7f6e\u989d\u5916\u6570\u636e\nthrow Oops.Bah("\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef"); // \u629b\u51fa\u4e1a\u52a1\u5f02\u5e38\uff0c\u72b6\u6001\u7801\u4e3a 400\nthrow Oops.Bah(1000);\n')),(0,i.kt)("h2",{id:"77-\u591a\u4e2a\u5f02\u5e38\u4fe1\u606f\u7c7b\u578b"},"7.7 \u591a\u4e2a\u5f02\u5e38\u4fe1\u606f\u7c7b\u578b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {5-6,21-22}",showLineNumbers:!0,"":!0,"{5-6,21-22}":!0},'using Furion.FriendlyException;\n\nnamespace Furion.Application\n{\n    [ErrorCodeType]\n    public enum ErrorCodes\n    {\n        [ErrorCodeItemMetadata("{0} \u4e0d\u80fd\u5c0f\u4e8e {1}")]\n        z1000,\n\n        [ErrorCodeItemMetadata("\u6570\u636e\u4e0d\u5b58\u5728")]\n        x1000,\n\n        [ErrorCodeItemMetadata("{0} \u53d1\u73b0 {1} \u4e2a\u5f02\u5e38", "\u767e\u5c0f\u50e7", 2)]\n        x1001,\n\n        [ErrorCodeItemMetadata("\u670d\u52a1\u5668\u8fd0\u884c\u5f02\u5e38", ErrorCode = "Error")]\n        SERVER_ERROR\n    }\n\n    [ErrorCodeType]\n    public enum UserErrorCodes\n    {\n        [ErrorCodeItemMetadata("\u7528\u6237\u6570\u636e\u4e0d\u5b58\u5728")]\n        u1000,\n\n        [ErrorCodeItemMetadata("\u5176\u4ed6\u5f02\u5e38")]\n        u1001\n    }\n}\n')),(0,i.kt)("admonition",{title:"\u7279\u522b\u6ce8\u610f",type:"important"},(0,i.kt)("p",{parentName:"admonition"},"\u591a\u4e2a\u5f02\u5e38\u9759\u6001\u7c7b\u4e2d\u4e5f\u5fc5\u987b\u4fdd\u8bc1\u5e38\u91cf\u503c\u552f\u4e00\u6027\uff0c\u4e0d\u53ef\u91cd\u590d\u3002")),(0,i.kt)("h2",{id:"78-ierrorcodetypeprovider-\u63d0\u4f9b\u5668"},"7.8 ",(0,i.kt)("inlineCode",{parentName:"h2"},"IErrorCodeTypeProvider")," \u63d0\u4f9b\u5668"),(0,i.kt)("p",null,"\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"Furion")," \u6846\u67b6\u4e2d\uff0c\u8fd8\u63d0\u4f9b\u4e86 ",(0,i.kt)("inlineCode",{parentName:"p"},"IErrorCodeTypeProvider")," \u5f02\u5e38\u6d88\u606f\u63d0\u4f9b\u5668\u63a5\u53e3\uff0c\u65b9\u4fbf\u5728\u4e0d\u80fd\u8d34 ",(0,i.kt)("inlineCode",{parentName:"p"},"[ErrorCodeType]")," \u7279\u6027\u60c5\u51b5\u4e0b\u4f7f\u7528\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {2,6,8-11}",showLineNumbers:!0,"":!0,"{2,6,8-11}":!0},"using Furion.FriendlyException;\nusing System;\n\nnamespace Furion.Application\n{\n    public class CustomErrorCodeTypeProvider : IErrorCodeTypeProvider\n    {\n        public Type[] Definitions => new[] {\n            typeof(ErrorCodes),\n            typeof(ErrorCodes2)\n        };\n    }\n}\n")),(0,i.kt)("p",null,"\u542f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"IErrorCodeTypeProvider")," \u63d0\u4f9b\u5668\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:'showLineNumbers  {11} title="Furion.Web.Core\\FurWebCoreStartup.cs"',showLineNumbers:!0,"":!0,"{11}":!0,title:'"Furion.Web.Core\\FurWebCoreStartup.cs"'},"using Microsoft.Extensions.DependencyInjection;\n\nnamespace Furion.Web.Core\n{\n    [AppStartup(800)]\n    public sealed class FurWebCoreStartup : AppStartup\n    {\n        public void ConfigureServices(IServiceCollection services)\n        {\n            services.AddControllers()\n                    .AddFriendlyException<CustomErrorCodeTypeProvider>();\n        }\n    }\n}\n")),(0,i.kt)("admonition",{title:"\u5c0f\u77e5\u8bc6",type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"\u53ea\u6709\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"IErrorCodeTypeProvider")," \u65b9\u5f0f\u624d\u9700\u4f7f\u7528\u6cdb\u578b\u65b9\u5f0f\u6ce8\u518c\u3002\u901a\u8fc7\u4e0a\u9762\u7684\u65b9\u5f0f\u6ce8\u518c\u53ef\u4ee5\u540c\u65f6\u652f\u6301 ",(0,i.kt)("inlineCode",{parentName:"p"},"IErrorCodeTypeProvider")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"[ErrorCodeType]")," \u65b9\u5f0f\u3002")),(0,i.kt)("h2",{id:"79-appsettingjson-\u4e2d\u914d\u7f6e"},"7.9 ",(0,i.kt)("inlineCode",{parentName:"h2"},"appsetting.json")," \u4e2d\u914d\u7f6e"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Furion")," \u6846\u67b6\u8fd8\u63d0\u4f9b\u4e86\u975e\u5e38\u7075\u6d3b\u7684\u914d\u7f6e\u6587\u4ef6\u914d\u7f6e\u5f02\u5e38\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5b9e\u73b0\u5f02\u5e38\u4fe1\u606f\u540e\u671f\u914d\u7f6e\uff0c\u4e5f\u5c31\u662f\u65e0\u9700\u5728\u5f00\u53d1\u9636\u6bb5\u9884\u5148\u5b9a\u4e49\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'showLineNumbers  {2-8} title="Furion.Web.Entry/appsettings.json"',showLineNumbers:!0,"":!0,"{2-8}":!0,title:'"Furion.Web.Entry/appsettings.json"'},'{\n  "ErrorCodeMessageSettings": {\n    "Definitions": [\n      ["5000", "{0} \u4e0d\u80fd\u5c0f\u4e8e {1}"],\n      ["5001", "\u6211\u53eb {0} \u540d\u5b57", "\u767e\u5c0f\u50e7"],\n      ["5002", "Oops! \u51fa\u9519\u4e86"]\n    ]\n  }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Definitions")," \u7c7b\u578b\u4e3a\u4e8c\u7ef4\u6570\u7ec4\uff0c\u4e8c\u7ef4\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e00\u4e2a\u6570\u7ec4\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a ",(0,i.kt)("inlineCode",{parentName:"p"},"ErrorCode")," \u4e5f\u5c31\u662f\u9519\u8bef\u7801\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a ",(0,i.kt)("inlineCode",{parentName:"p"},"ErrorMessage")," \u6d88\u606f\u5185\u5bb9\uff0c\u5269\u4f59\u53c2\u6570\u4f5c\u4e3a ",(0,i.kt)("inlineCode",{parentName:"p"},"ErrorMessage")," \u7684\u683c\u5f0f\u5316\u53c2\u6570\u3002"),(0,i.kt)("h4",{id:"\u4f7f\u7528\u793a\u4f8b"},"\u4f7f\u7528\u793a\u4f8b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {2,12}",showLineNumbers:!0,"":!0,"{2,12}":!0},"using Furion.DynamicApiController;\nusing Furion.FriendlyException;\n\nnamespace Furion.Application\n{\n    public class FurionAppService : IDynamicApiController\n    {\n        public int Get(int id)\n        {\n            if (id < 3)\n            {\n                throw Oops.Oh(5000, id, 3); // \u53ef\u4ee5\u5c06 5000\u4f5c\u4e3a\u5e38\u91cf\u914d\u7f6e\u8d77\u6765\n            }\n\n            return id;\n        }\n    }\n}\n")),(0,i.kt)("admonition",{title:"\u5c0f\u77e5\u8bc6",type:"tip"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"[ErrorCodeType]")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"IErrorCodeTypeProvider")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"appsettings.json")," \u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\u3002")),(0,i.kt)("h2",{id:"710-ifexception-\u4f7f\u7528"},"7.10 ",(0,i.kt)("inlineCode",{parentName:"h2"},"[IfException]")," \u4f7f\u7528"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Furion")," \u6846\u67b6\u63d0\u4f9b\u4e86 ",(0,i.kt)("inlineCode",{parentName:"p"},"[IfException]")," \u7279\u6027\u53ef\u4ee5",(0,i.kt)("strong",{parentName:"p"},"\u8986\u76d6\u9ed8\u8ba4\u6d88\u606f\u914d\u7f6e"),"\u3002\u4e5f\u5c31\u662f\u8986\u76d6 ",(0,i.kt)("inlineCode",{parentName:"p"},"\u5f02\u5e38\u6d88\u606f\u7c7b\u578b")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"appsettings.json")," \u4e2d\u7684\u914d\u7f6e\u3002"),(0,i.kt)("admonition",{title:"\u7279\u522b\u6ce8\u610f",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"[IfException]")," \u53ea\u80fd\u8d34\u5728\u65b9\u6cd5\u4e0a\uff0c\u652f\u6301\u591a\u4e2a\u3002")),(0,i.kt)("h3",{id:"7101-\u4f7f\u7528\u793a\u4f8b"},"7.10.1 \u4f7f\u7528\u793a\u4f8b"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5f02\u5e38\u6d88\u606f\u7c7b\u5b9a\u4e49")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {1,4}",showLineNumbers:!0,"":!0,"{1,4}":!0},'[ErrorCodeType]\npublic enum ErrorCodes\n{\n   [ErrorCodeItemMetadata("{0} \u4e0d\u80fd\u5c0f\u4e8e {1}")]\n   z1000\n}\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u8986\u76d6\u9ed8\u8ba4\u914d\u7f6e")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {8}",showLineNumbers:!0,"":!0,"{8}":!0},'using Furion.DynamicApiController;\nusing Furion.FriendlyException;\n\nnamespace Furion.Application\n{\n    public class FurionAppService : IDynamicApiController\n    {\n        [IfException(ErrorCodes.z1000, ErrorMessage = "\u6211\u8986\u76d6\u4e86\u9ed8\u8ba4\u7684\uff1a{0} \u4e0d\u80fd\u5c0f\u4e8e {1}")]\n        public int Get(int id)\n        {\n            if (id < 3)\n            {\n                throw Oops.Oh(ErrorCodes.z1000, id, 3);\n            }\n\n            return id;\n        }\n    }\n}\n')),(0,i.kt)("p",null,"\u5982\u4e0b\u56fe\u6240\u793a\uff1a"),(0,i.kt)("img",{src:(0,a.Z)("img/yhyc4.png")}),(0,i.kt)("h3",{id:"7102-\u66f4\u591a\u4f8b\u5b50"},"7.10.2 \u66f4\u591a\u4f8b\u5b50"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {2,8-11}",showLineNumbers:!0,"":!0,"{2,8-11}":!0},'using Furion.DynamicApiController;\nusing Furion.FriendlyException;\n\nnamespace Furion.Application\n{\n    public class FurionAppService : IDynamicApiController\n    {\n        [IfException(typeof(ExceptionType), ErrorMessage = "\u7279\u5b9a\u5f02\u5e38\u7c7b\u578b\u5168\u5c40\u62e6\u622a")]\n        [IfException(ErrorMessage = "\u5168\u5c40\u5f02\u5e38\u62e6\u622a")]\n        [IfException(ErrorCodes.z1000, ErrorMessage = "\u6211\u8986\u76d6\u4e86\u9ed8\u8ba4\u7684\uff1a{0} \u4e0d\u80fd\u5c0f\u4e8e {1}")]\n        [IfException(ErrorCodes.x1001, "\u683c\u5f0f\u5316\u53c2\u65701", "\u683c\u5f0f\u5316\u53c2\u65702", ErrorMessage = "\u6211\u8986\u76d6\u4e86\u9ed8\u8ba4\u7684\uff1a{0} \u4e0d\u80fd\u5c0f\u4e8e {1}")]\n        [IfException(ErrorCodes.x1000, "\u683c\u5f0f\u5316\u53c2\u65701", "\u683c\u5f0f\u5316\u53c2\u65702")]\n        [IfException(ErrorCodes.SERVER_ERROR, "\u683c\u5f0f\u5316\u53c2\u65701", "\u683c\u5f0f\u5316\u53c2\u65702")]\n        public int Get(int id)\n        {\n            if (id < 3)\n            {\n                throw Oops.Oh(ErrorCodes.z1000, id, 3);\n            }\n\n            return id;\n        }\n    }\n}\n')),(0,i.kt)("admonition",{title:"\u683c\u5f0f\u5316\u6d41\u7a0b",type:"important"},(0,i.kt)("p",{parentName:"admonition"},"\u5982\u679c\u6d88\u606f\u5185\u5bb9\u4e2d\u5305\u542b",(0,i.kt)("inlineCode",{parentName:"p"},"\u683c\u5f0f\u5316\u5360\u4f4d\u7b26"),"\u4f46\u672a\u6307\u5b9a",(0,i.kt)("inlineCode",{parentName:"p"},"\u683c\u5f0f\u5316\u53c2\u6570"),"\uff0c\u90a3\u4e48\u4f1a\u67e5\u627e\u5f02\u5e38\u6240\u5728\u65b9\u6cd5\u662f\u5426\u8d34\u6709 ",(0,i.kt)("inlineCode",{parentName:"p"},"[IfException]")," \u7279\u6027\u4e14\u542b\u6709\u683c\u5f0f\u5316\u53c2\u6570\uff0c\u63a5\u7740\u5c31\u4f1a\u67e5\u627e ",(0,i.kt)("inlineCode",{parentName:"p"},"Oops.Oh")," \u4e2d\u6307\u5b9a\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"\u683c\u5f0f\u5316\u53c2\u6570"),"\u3002")),(0,i.kt)("h2",{id:"711-\u5f02\u5e38\u6d88\u606f\u4f18\u5148\u7ea7"},"7.11 \u5f02\u5e38\u6d88\u606f\u4f18\u5148\u7ea7"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"[ErrorCodeItemMetadata]")," -> ",(0,i.kt)("inlineCode",{parentName:"p"},"appsettings.json")," -> ",(0,i.kt)("inlineCode",{parentName:"p"},"[IfException]"),"\u3002",(0,i.kt)("strong",{parentName:"p"},"\uff08\u4f4e -> \u9ad8\uff09")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[IfException]")," \u4f1a\u8986\u76d6 ",(0,i.kt)("inlineCode",{parentName:"li"},"appsettings.json")," \u5b9a\u4e49\u7684\u72b6\u6001\u7801\u6d88\u606f\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"appsettings.json")," \u4f1a\u8986\u76d6 ",(0,i.kt)("inlineCode",{parentName:"li"},"[ErrorCodeItemMetadata]")," \u5b9a\u4e49\u7684\u6d88\u606f\u3002")),(0,i.kt)("h2",{id:"712-\u591a\u8bed\u8a00\u652f\u6301"},"7.12 \u591a\u8bed\u8a00\u652f\u6301"),(0,i.kt)("p",null,"\u53c2\u89c1 ",(0,i.kt)("a",{parentName:"p",href:"./local-language"},"\u3010\u5168\u7403\u5316\u548c\u672c\u5730\u5316\uff08\u591a\u8bed\u8a00\uff09\u3011")," \u7ae0\u8282"),(0,i.kt)("h2",{id:"713-\u89c4\u8303\u5316\u7ed3\u679c\u5f02\u5e38\u5904\u7406"},"7.13 \u89c4\u8303\u5316\u7ed3\u679c\u5f02\u5e38\u5904\u7406"),(0,i.kt)("admonition",{title:"\u67e5\u770b\u89c4\u8303\u5316\u7ed3\u679c\u6587\u6863",type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"\u5982\u9700\u81ea\u5b9a\u4e49\u89c4\u8303\u5316\u7ed3\u679c\u53ef\u67e5\u9605 \u3010",(0,i.kt)("a",{parentName:"p",href:"/docs/specification-document#67-%E7%BB%9F%E4%B8%80%E8%BF%94%E5%9B%9E%E5%80%BC%E6%A8%A1%E5%9E%8B%E8%A7%84%E8%8C%83%E5%8C%96%E7%BB%93%E6%9E%9Capi-%E8%BF%94%E5%9B%9E%E5%80%BC"},"6.7 \u7edf\u4e00\u8fd4\u56de\u503c\u6a21\u578b"),"\u3011")),(0,i.kt)("h2",{id:"714-\u5168\u5c40\u5f02\u5e38\u5904\u7406\u63d0\u4f9b\u5668"},"7.14 \u5168\u5c40\u5f02\u5e38\u5904\u7406\u63d0\u4f9b\u5668"),(0,i.kt)("p",null,"\u901a\u5e38\u6211\u4eec\u9700\u8981\u5728\u5f02\u5e38\u6355\u83b7\u7684\u65f6\u5019\u5199\u65e5\u5fd7\uff0c\u8fd9\u65f6\u5019\u5c31\u9700\u8981\u4f7f\u7528\u5230 ",(0,i.kt)("inlineCode",{parentName:"p"},"IGlobalExceptionHandler")," \u5f02\u5e38\u5b9a\u4e49\u5904\u7406\u7a0b\u5e8f\uff0c\u5982\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers  {8}",showLineNumbers:!0,"":!0,"{8}":!0},"using Furion.DependencyInjection;\nusing Furion.FriendlyException;\nusing Microsoft.AspNetCore.Mvc.Filters;\nusing System.Threading.Tasks;\n\nnamespace Furion.Application\n{\n    public class LogExceptionHandler : IGlobalExceptionHandler, ISingleton\n    {\n        public Task OnExceptionAsync(ExceptionContext context)\n        {\n            // \u5199\u65e5\u5fd7\n\n            return Task.CompletedTask;\n        }\n    }\n}\n")),(0,i.kt)("h2",{id:"715-friendlyexceptionsettings-\u914d\u7f6e"},"7.15 ",(0,i.kt)("inlineCode",{parentName:"h2"},"FriendlyExceptionSettings")," \u914d\u7f6e"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"HideErrorCode"),"\uff1a\u9690\u85cf\u9519\u8bef\u7801\uff0c",(0,i.kt)("inlineCode",{parentName:"li"},"bool")," \u7c7b\u578b\uff0c\u9ed8\u8ba4 ",(0,i.kt)("inlineCode",{parentName:"li"},"false")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"DefaultErrorCode"),"\uff1a\u9ed8\u8ba4\u9519\u8bef\u7801\uff0c",(0,i.kt)("inlineCode",{parentName:"li"},"string")," \u7c7b\u578b"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"DefaultErrorMessage"),"\uff1a\u9ed8\u8ba4\u9519\u8bef\u6d88\u606f\uff0c",(0,i.kt)("inlineCode",{parentName:"li"},"string")," \u7c7b\u578b"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ThrowBah"),"\uff1a\u662f\u5426\u5c06 ",(0,i.kt)("inlineCode",{parentName:"li"},"Oops.Oh")," \u9ed8\u8ba4\u629b\u51fa\u4e3a\u4e1a\u52a1\u5f02\u5e38\uff0c",(0,i.kt)("inlineCode",{parentName:"li"},"bool")," \u7c7b\u578b\uff0c\u9ed8\u8ba4 ",(0,i.kt)("inlineCode",{parentName:"li"},"false"),"\uff0c\u8bbe\u7f6e ",(0,i.kt)("inlineCode",{parentName:"li"},"true")," \u4e4b\u540e ",(0,i.kt)("inlineCode",{parentName:"li"},"Oops.Oh")," \u9ed8\u8ba4\u8fdb\u5165 ",(0,i.kt)("inlineCode",{parentName:"li"},"OnValidateFailed")," \u5904\u7406\uff0c\u800c\u4e0d\u662f ",(0,i.kt)("inlineCode",{parentName:"li"},"OnException")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"LogError"),"\uff1a\u662f\u5426\u8f93\u51fa\u5f02\u5e38\u65e5\u5fd7\uff0c",(0,i.kt)("inlineCode",{parentName:"li"},"bool")," \u7c7b\u578b\uff0c\u9ed8\u8ba4 ",(0,i.kt)("inlineCode",{parentName:"li"},"true"))),(0,i.kt)("p",null,"\u914d\u7f6e\u793a\u4f8b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:"showLineNumbers",showLineNumbers:!0},'{\n  "FriendlyExceptionSettings": {\n    "DefaultErrorMessage": "\u7cfb\u7edf\u5f02\u5e38\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458"\n  }\n}\n')),(0,i.kt)("h2",{id:"716-badpageresult-\u9519\u8bef\u9875"},"7.16 ",(0,i.kt)("inlineCode",{parentName:"h2"},"BadPageResult")," \u9519\u8bef\u9875"),(0,i.kt)("admonition",{title:"\u7248\u672c\u8bf4\u660e",type:"important"},(0,i.kt)("p",{parentName:"admonition"},"\u4ee5\u4e0b\u5185\u5bb9\u4ec5\u9650 ",(0,i.kt)("inlineCode",{parentName:"p"},"Furion 3.6.1 +")," \u7248\u672c\u4f7f\u7528\u3002")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Furion")," \u5728\u8be5\u7248\u672c\u4e4b\u540e\u5185\u7f6e\u4e86 ",(0,i.kt)("inlineCode",{parentName:"p"},"BadPageResult")," \u9519\u8bef\u7ed3\u679c\u7c7b\u578b\uff0c\u8be5\u7c7b\u578b\u6d3e\u751f\u81ea ",(0,i.kt)("inlineCode",{parentName:"p"},"IActionResult"),"\uff0c\u5982\u9700\u8fd4\u56de\u53ea\u9700\u8981\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"Action")," \u4e2d\u8fd4\u56de\u5373\u53ef\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs",metastring:"showLineNumbers{1,7}","showLineNumbers{1,7}":!0},"using Furion.FriendlyException;\n\npublic IActionResult Add(Person person)\n{\n    if(!ModelState.IsValid)\n    {\n        return new BadPageResult();\n    }\n}\n")),(0,i.kt)("img",{src:(0,a.Z)("img/er1.png")}),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"BadPageResult")," \u66f4\u591a\u914d\u7f6e",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u6784\u9020\u51fd\u6570 ",(0,i.kt)("inlineCode",{parentName:"li"},"statusCode"),"\uff1a\u72b6\u6001\u7801\uff0c",(0,i.kt)("inlineCode",{parentName:"li"},"int")," \u7c7b\uff0c\u9ed8\u8ba4 400"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Title"),"\uff1a\u9875\u9762\u6807\u9898\uff0c",(0,i.kt)("inlineCode",{parentName:"li"},"string")," \u7c7b\u578b\uff0c\u9ed8\u8ba4 ",(0,i.kt)("inlineCode",{parentName:"li"},"ModelState Invalid")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Description"),"\uff1a\u9875\u9762\u63cf\u8ff0\uff0c",(0,i.kt)("inlineCode",{parentName:"li"},"string")," \u7c7b\u578b\uff0c\u9ed8\u8ba4 ",(0,i.kt)("inlineCode",{parentName:"li"},"User data verification failed. Please input it correctly.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Code"),"\uff1a\u8be6\u7ec6\u9519\u8bef\u4ee3\u7801\uff0c",(0,i.kt)("inlineCode",{parentName:"li"},"string")," \u7c7b\u578b\uff0c\u652f\u6301 ",(0,i.kt)("inlineCode",{parentName:"li"},"\u4ee3\u7801"),"\uff0c\u9ed8\u8ba4\u7a7a\u5b57\u7b26\u4e32"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"CodeLang"),"\uff1a\u8be6\u7ec6\u9519\u8bef\u4ee3\u7801\u8bed\u8a00\uff0c",(0,i.kt)("inlineCode",{parentName:"li"},"string")," \u7c7b\u578b\uff0c\u9ed8\u8ba4 ",(0,i.kt)("inlineCode",{parentName:"li"},"json")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Base64Icon"),"\uff1a\u9875\u9762\u56fe\u6807\uff0c",(0,i.kt)("inlineCode",{parentName:"li"},"string")," \u7c7b\u578b\uff0c\u5e26\u9ed8\u8ba4\u503c\uff0c\u81ea\u5b9a\u4e49\u5fc5\u987b\u662f ",(0,i.kt)("inlineCode",{parentName:"li"},"base64")," \u683c\u5f0f\u56fe\u6807")))),(0,i.kt)("h2",{id:"717-\u53cd\u9988\u4e0e\u5efa\u8bae"},"7.17 \u53cd\u9988\u4e0e\u5efa\u8bae"),(0,i.kt)("admonition",{title:"\u4e0e\u6211\u4eec\u4ea4\u6d41",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"\u7ed9 Furion \u63d0 ",(0,i.kt)("a",{parentName:"p",href:"https://gitee.com/dotnetchina/Furion/issues/new?issue"},"Issue"),"\u3002")))}u.isMDXComponent=!0}}]);