"use strict";(self.webpackChunktouchsocket=self.webpackChunktouchsocket||[]).push([[5264],{3905:(t,e,n)=>{n.d(e,{Zo:()=>d,kt:()=>m});var r=n(7294);function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var l=r.createContext({}),c=function(t){var e=r.useContext(l),n=e;return t&&(n="function"==typeof t?t(e):o(o({},e),t)),n},d=function(t){var e=c(t.components);return r.createElement(l.Provider,{value:e},t.children)},p={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},u=r.forwardRef((function(t,e){var n=t.components,i=t.mdxType,a=t.originalType,l=t.parentName,d=s(t,["components","mdxType","originalType","parentName"]),u=c(n),m=i,y=u["".concat(l,".").concat(m)]||u[m]||p[m]||a;return n?r.createElement(y,o(o({ref:e},d),{},{components:n})):r.createElement(y,o({ref:e},d))}));function m(t,e){var n=arguments,i=e&&e.mdxType;if("string"==typeof t||i){var a=n.length,o=new Array(a);o[0]=u;var s={};for(var l in e)hasOwnProperty.call(e,l)&&(s[l]=e[l]);s.originalType=t,s.mdxType="string"==typeof t?t:i,o[1]=s;for(var c=2;c<a;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},9817:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var r=n(7462),i=(n(7294),n(3905));const a={id:"fastbinaryformatter",title:"\u9ad8\u6027\u80fd\u5e8f\u5217\u5316"},o=void 0,s={unversionedId:"fastbinaryformatter",id:"fastbinaryformatter",title:"\u9ad8\u6027\u80fd\u5e8f\u5217\u5316",description:"\u4e00\u3001\u8bf4\u660e",source:"@site/docs/fastbinaryformatter.mdx",sourceDirName:".",slug:"/fastbinaryformatter",permalink:"/touchsocket/docs/fastbinaryformatter",draft:!1,editUrl:"https://gitee.com/rrqm_home/touchsocket/tree/master/handbook/docs/fastbinaryformatter.mdx",tags:[],version:"current",lastUpdatedBy:"\u82e5\u6c5d\u68cb\u8317",lastUpdatedAt:1675229490,formattedLastUpdatedAt:"Feb 1, 2023",frontMatter:{id:"fastbinaryformatter",title:"\u9ad8\u6027\u80fd\u5e8f\u5217\u5316"},sidebar:"docs",previous:{title:"\u5e94\u7528\u4fe1\u4f7f",permalink:"/touchsocket/docs/appmessenger"},next:{title:"Json\u5e8f\u5217\u5316",permalink:"/touchsocket/docs/jsonserialize"}},l={},c=[{value:"\u4e00\u3001\u8bf4\u660e",id:"\u4e00\u8bf4\u660e",level:2},{value:"\u4e8c\u3001\u5e8f\u5217\u5316",id:"\u4e8c\u5e8f\u5217\u5316",level:2},{value:"\u4e09\u3001\u53cd\u5e8f\u5217\u5316",id:"\u4e09\u53cd\u5e8f\u5217\u5316",level:2},{value:"\u56db\u3001\u5feb\u6377\u5e8f\u5217\u5316",id:"\u56db\u5feb\u6377\u5e8f\u5217\u5316",level:2},{value:"image.png",id:"imagepng",level:2},{value:"\u4e94\u3001\u6027\u80fd\u5bf9\u6bd4",id:"\u4e94\u6027\u80fd\u5bf9\u6bd4",level:2}],d={toc:c};function p(t){let{components:e,...n}=t;return(0,i.kt)("wrapper",(0,r.Z)({},d,n,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"\u4e00\u8bf4\u660e"},"\u4e00\u3001\u8bf4\u660e"),(0,i.kt)("p",null,"\u8be5\u5e8f\u5217\u5316\u4ee5\u4e8c\u8fdb\u5236\u65b9\u5f0f\u8fdb\u884c\u5e8f\u5217\u5316\uff0c\u4e0d\u8981\u6c42\u7c7b\u578b\u76f8\u540c\uff0c\u4ec5\u4e3a",(0,i.kt)("a",{parentName:"p",href:"https://www.yuque.com/eo2w71/rrqm/d104f4159d543b4ae28db195ef623cf7#Y0Cko"},"\u76f8\u4f3c\u7ed3\u6784"),"\u5373\u53ef\u3002\u652f\u6301",(0,i.kt)("strong",{parentName:"p"},"\u57fa\u7840\u7c7b\u578b"),"\u3001",(0,i.kt)("strong",{parentName:"p"},"\u81ea\u5b9a\u4e49\u5b9e\u4f53\u7c7b"),"\u3001",(0,i.kt)("strong",{parentName:"p"},"\u7ed3\u6784\u4f53"),"\u3001",(0,i.kt)("strong",{parentName:"p"},"\u6570\u636e"),"\u3001",(0,i.kt)("strong",{parentName:"p"},"\u5b57\u5178"),"\u3001",(0,i.kt)("strong",{parentName:"p"},"List"),"\u3001\u4ee5\u53ca\u81ea\u5b9a\u4e49\u5e8f\u5217\u5316\u3002\n",(0,i.kt)("a",{parentName:"p",href:"https://www.nuget.org/packages/RRQMCore/"})),(0,i.kt)("h2",{id:"\u4e8c\u5e8f\u5217\u5316"},"\u4e8c\u3001\u5e8f\u5217\u5316"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp"}," public static void FastBinarySerialize(ByteBlock stream, object obj)\n {\n     FastBinaryFormatter bf = new FastBinaryFormatter();\n     bf.Serialize(stream, obj);\n }\n")),(0,i.kt)("h2",{id:"\u4e09\u53cd\u5e8f\u5217\u5316"},"\u4e09\u3001\u53cd\u5e8f\u5217\u5316"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp"},"public object RRQMBinaryDeserialize(byte[] data, int offset, Type type)\n{\n    FastBinaryFormatter bf = new FastBinaryFormatter();\n    return bf.Deserialize(data, offset, type);\n}\n")),(0,i.kt)("h2",{id:"\u56db\u5feb\u6377\u5e8f\u5217\u5316"},"\u56db\u3001\u5feb\u6377\u5e8f\u5217\u5316"),(0,i.kt)("p",null,"\u5728\u9759\u6001\u7c7b",(0,i.kt)("inlineCode",{parentName:"p"},"SerializeConvert"),"\u4e2d\uff0c\u63d0\u4f9b\u4e86\u5feb\u6377\u7684\u5e8f\u5217\u5316\u65b9\u5f0f\uff0c\u4ee5\u4f9b\u65b9\u4fbf\u4f7f\u7528\u3002"),(0,i.kt)("h2",{id:"imagepng"},(0,i.kt)("img",{parentName:"h2",src:"https://cdn.nlark.com/yuque/0/2022/png/25438888/1663812694768-3b2d4cb6-c589-4479-9f9b-222a9ab65991.png#clientId=u051b4acd-2df2-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=326&id=ud292820e&name=image.png&originHeight=326&originWidth=1152&originalType=binary&ratio=1&rotation=0&showTitle=false&size=345481&status=done&style=none&taskId=u77352d5a-8e74-4dd0-ac51-49017d791ed&title=&width=1152",alt:"image.png"})),(0,i.kt)("h2",{id:""}),(0,i.kt)("h2",{id:"\u4e94\u6027\u80fd\u5bf9\u6bd4"},"\u4e94\u3001\u6027\u80fd\u5bf9\u6bd4"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u5f85\u6d4b\u8bd5\u7c7b")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp"},' [Serializable]\npublic class Student\n{\n    public int P1 { get; set; }\n    public string P2 { get; set; }\n    public long P3 { get; set; }\n    public byte P4 { get; set; }\n    public DateTime P5 { get; set; }\n    public double P6 { get; set; }\n    public byte[] P7 { get; set; }\n\n    public List<int> List1 { get; set; }\n    public List<string> List2 { get; set; }\n    public List<byte[]> List3 { get; set; }\n\n    public Dictionary<int, int> Dic1 { get; set; }\n    public Dictionary<int, string> Dic2 { get; set; }\n    public Dictionary<string, string> Dic3 { get; set; }\n    public Dictionary<int, Arg> Dic4 { get; set; }\n}\n[Serializable]\npublic class Arg\n{\n    public Arg(int myProperty)\n    {\n        this.MyProperty = myProperty;\n    }\n\n    public Arg()\n    {\n        Person person = new Person();\n        person.Name = "\u5f20\u4e09";\n        person.Age = 18;\n    }\n\n    public int MyProperty { get; set; }\n}\n[Serializable]\npublic class Person\n{\n    public string Name { get; set; }\n    public int Age { get; set; }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\u4ee3\u7801")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csharp"},' Student student = new Student();\nstudent.P1 = 10;\nstudent.P2 = "\u82e5\u6c5d\u68cb\u8317";\nstudent.P3 = 100;\nstudent.P4 = 0;\nstudent.P5 = DateTime.Now;\nstudent.P6 = 10;\nstudent.P7 = new byte[1024 * 64];\n\nRandom random = new Random();\nrandom.NextBytes(student.P7);\n\nstudent.List1 = new List<int>();\nstudent.List1.Add(1);\nstudent.List1.Add(2);\nstudent.List1.Add(3);\n\nstudent.List2 = new List<string>();\nstudent.List2.Add("1");\nstudent.List2.Add("2");\nstudent.List2.Add("3");\n\nstudent.List3 = new List<byte[]>();\nstudent.List3.Add(new byte[1024]);\nstudent.List3.Add(new byte[1024]);\nstudent.List3.Add(new byte[1024]);\n\nstudent.Dic1 = new Dictionary<int, int>();\nstudent.Dic1.Add(1, 1);\nstudent.Dic1.Add(2, 2);\nstudent.Dic1.Add(3, 3);\n\nstudent.Dic2 = new Dictionary<int, string>();\nstudent.Dic2.Add(1, "1");\nstudent.Dic2.Add(2, "2");\nstudent.Dic2.Add(3, "3");\n\nstudent.Dic3 = new Dictionary<string, string>();\nstudent.Dic3.Add("1", "1");\nstudent.Dic3.Add("2", "2");\nstudent.Dic3.Add("3", "3");\n\nstudent.Dic4 = new Dictionary<int, Arg>();\nstudent.Dic4.Add(1, new Arg(1));\nstudent.Dic4.Add(2, new Arg(2));\nstudent.Dic4.Add(3, new Arg(3));\n\nBytePool bytePool = new BytePool(1024 * 1024 * 10, 102400);\n\nTimeSpan timeSpan1 = TimeMeasurer.Run(() =>\n{\n    for (int i = 0; i < 100000; i++)\n    {\n        ByteBlock byteBlock = bytePool.GetByteBlock(1024 * 100);\n        SerializeConvert.RRQMBinarySerialize(byteBlock, student,true);\n        Student student1 = SerializeConvert.RRQMBinaryDeserialize<Student>(byteBlock.Buffer,\n        byteBlock.Dispose();\n        if (i % 1000 == 0)\n        {\n            Console.WriteLine(i);\n        }\n    }\n});\n\nTimeSpan timeSpan2 = TimeMeasurer.Run(() =>\n{\n    for (int i = 0; i < 100000; i++)\n    {\n        ByteBlock byteBlock = bytePool.GetByteBlock(1024 * 100);\n        SerializeConvert.BinarySerialize(byteBlock, student);\n        byteBlock.Position = 0;\n        Student student1 = SerializeConvert.BinaryDeserialize<Student>(byteBlock);\n        byteBlock.Dispose();\n        if (i % 1000 == 0)\n        {\n            Console.WriteLine(i);\n        }\n    }\n});\n\nConsole.WriteLine($"RRQM:{timeSpan1}");\nConsole.WriteLine($"System:{timeSpan2}");\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\u7ed3\u679c")),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/img_convert/787c262d6b61cdba0d8ee2f5a4239d8f.png#crop=0&crop=0&crop=1&crop=1&id=UIsJi&originHeight=1569&originWidth=2376&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=",alt:null})))}p.isMDXComponent=!0}}]);