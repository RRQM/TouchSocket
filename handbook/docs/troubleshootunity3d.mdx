---
id: troubleshootunity3d
title: Unity3D相关
---

## 【问】程序集用于Unity 3D时，有莫名其妙的异常？

【描述】

我将TouchSocket程序集引入到U3D中后，使用了相关功能，或者其他组件功能，在编辑器界面正常，但是发布到PC、Android等平台时无法使用？

### 【解决1】

首先查看项目是否设置了`IL2CPP`，如果设置了的话，可以考虑是否能设置为`Mono`，如果能，则OK。

<img src={require('../static/img/docs/troubleshootunity3d-1.png').default} width="300" />


### 【解决2】

需要unity内link.xml设置(放置在Assets文件夹内)。 [unity官方文档 托管代码剥离](https://docs.unity3d.com/cn/current/Manual/ManagedCodeStripping.html#LinkXML)

下列仅示例部分，如果是其他组件，则添加相应程序集名称。

```csharp xml
<linker>
	<assembly fullname="TouchSocket" />
</linker>
```

然后在程序运作最开始时调用全局设置

```csharp
GlobalEnvironment.OptimizedPlatforms = OptimizedPlatforms.Unity;
```

## 【问】程序集用于Unity 3D时，Json序列化有问题？

### 【解决】
这是因为unity中不支持代码生成的Json序列化，所以必须用IL2cpp版的json。下面提供该版本。

[IL2cpp版Newtonsoft.Json](../static/files/Newtonsoft.Json.dll)

