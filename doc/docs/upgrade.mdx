---
id: upgrade
title: 1.6 更新日志
sidebar_label: 1.6 更新日志
---

import useBaseUrl from "@docusaurus/useBaseUrl";
import Tag from "@site/src/components/Tag.js";

:::tip `Furion` 框架升级/发版规则

**升级前重点关注可能造成【破坏性】的标签类型**：<Tag>修复</Tag>、<Tag>调整</Tag>、<Tag>移除</Tag>、<Tag>升级</Tag>

版本号规则：`主版本号.次版本号.修订版本号`

- 只要【确认】为框架 `bug`，则当天修复，当天发版，修订版本号 `加 1`。
- 只要 `.NET SDK` 版本更新，则当天升级，当天发版，修订版本号 `加 1`。
- 如果 `.csproj` 文件有变更，则当天发版，修订版本号 `加 1`。
- 如果新增 `拓展包`，为了版本号统一，则当天发版，修订版本号 `加 1`。
- 如果涉及到代码重构，则当天发版，次版本号 `加 1`，修订版本号 `清 0`。
- 如果 `.NET SDK` 主版本号升级，则当天发版，主版本号 `加 1`。

如有意外不能当天发版，则会在 `Issue` 中说明具体发版时间，正常不会超过 `3` 天。

:::

## v4.8.4（当前版本，全新定时任务）

<img src={useBaseUrl("img/domyself.png")} />

:::tip 更好的 `Furion`，更好的自己

在过去两年，实现 `Furion` 从无到有，编写文档已逾三百万字，过程心酸开源人自知。

这一路日夜兼程，嘲讽批评常伴眼耳，即便辛苦无奈、想过放弃，但为了那微不足道的成就感依然努力着。

当然，也收获了不少... 越来越多拥趸者，越发精湛技术能力，更高层次思维模式，还有许多跨界跨行朋友。

在 《[开源指北](https://gitee.com/opensource-guide/comments/)》中，我曾说道：**“开源如同人的脸，好坏一面便知，缺点可能会受到嘲讽批评，优点也会收获赞扬尊重。别担心，他们正在塑造更好的你。”**

`.NET` 要在国内真正发展起来，必须得有一些追逐梦想的人在做着不计付出的事情，而我希望自己能贡献一份微薄之力。所以，这一次重新起航，重塑 `Furion` 重塑自己。也许未来在某个 IT 圈但凡有人谈起 `.NET` 还能瞟到 `Furion` 的身影。

:::

:::important 版本细节

- `v4.8.4` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I68573](https://gitee.com/dotnetchina/Furion/issues/I68573) <sup>2022.12.30</sup>
- `v4.8.3` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I657O5](https://gitee.com/dotnetchina/Furion/issues/I657O5) <sup>2022.12.08</sup>
- `v4.8.2` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I63CTP](https://gitee.com/dotnetchina/Furion/issues/I63CTP) <sup>2022.11.27</sup>
- `v4.8.1` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I62RX3](https://gitee.com/dotnetchina/Furion/issues/I62RX3) <sup>2022.11.24</sup>
- `v4.8.0` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I62NZV](https://gitee.com/dotnetchina/Furion/issues/I62NZV) <sup>2022.11.23</sup>

:::

- **新特性**

  - &nbsp;<Tag>新增</Tag> **🎉 [全新的定时任务模块](/docs/job)** <sup>4.8.0</sup> 【[查看源码](https://gitee.com/dotnetchina/Furion/tree/v4/framework/Furion/Schedule)】
  - &nbsp;<Tag>新增</Tag> **🎉 [全新的 `Cron` 表达式模块](/docs/cron)** <sup>4.8.0</sup> 【[查看源码](https://gitee.com/dotnetchina/Furion/tree/v4/framework/Furion/TimeCrontab)】
  - &nbsp;<Tag>新增</Tag> **🎉 [全新的任务队列模块](/docs/task-queue)** <sup>4.8.3</sup> 【[查看源码](https://gitee.com/dotnetchina/Furion/tree/v4/framework/Furion/TaskQueue)】
  - &nbsp;<Tag>新增</Tag> `*.bcmap` 和 `.properties` 文件类型 `MIME` 支持 <sup>4.8.4.9</sup> <sup>⏱️2023.01.06</sup> [!694](https://gitee.com/dotnetchina/Furion/pulls/694)
  - &nbsp;<Tag>新增</Tag> 定时任务 `Dashboard` 查看作业触发器最近运行记录功能 <sup>4.8.4.3</sup> <sup>⏱️2023.01.03</sup> [e7d24d8](https://gitee.com/dotnetchina/Furion/commit/e7d24d84bcc448b0a13f8e0b76328669261af44b)
  - &nbsp;<Tag>新增</Tag> 定时任务作业触发器 `trigger.GetTimelines()` 获取最近 `10` 条运行记录列表 <sup>4.8.4.3</sup> <sup>⏱️2023.01.03</sup> [e7d24d8](https://gitee.com/dotnetchina/Furion/commit/e7d24d84bcc448b0a13f8e0b76328669261af44b)
  - &nbsp;<Tag>新增</Tag> **定时任务 `Dashboard` 看板** <sup>4.8.4</sup> <sup>⏱️2022.12.30</sup> [d3f9669](https://gitee.com/dotnetchina/Furion/commit/d3f966921dfa757c12c2bd071fb19fc166a2f24e)
  - &nbsp;<Tag>新增</Tag> 定时任务 `IScheduler.GetEnumerable()` 方法，可将作业计划转换成可枚举字典 <sup>4.8.4</sup> <sup>⏱️2022.12.30</sup> [4d5235c](https://gitee.com/dotnetchina/Furion/commit/4d5235c37a9ef5e66e92847e65ef9786bcd7387c)
  - &nbsp;<Tag>新增</Tag> `L.SetCurrentUICulture(culture)` 和 `L.GetCurrentUICulture()` 静态方法，可在运行时动态修改当前线程区域性 <sup>4.8.3.10</sup> <sup>⏱️2022.12.23</sup> [#I66JWA](https://gitee.com/dotnetchina/Furion/issues/I66JWA)
  - &nbsp;<Tag>新增</Tag> `L.SetCulture(culture, immediately)` 方法重载，可配置运行时修改多语言立即有效 <sup>4.8.3.10</sup> <sup>⏱️2022.12.23</sup> [#I66JWA](https://gitee.com/dotnetchina/Furion/issues/I66JWA)
  - &nbsp;<Tag>新增</Tag> 定时任务配置选项 `options.JobDetail.LogEnabled` 配置，可自动输出执行日志 <sup>4.8.3.7</sup> <sup>⏱️2022.12.14</sup> [58d2c20](https://gitee.com/dotnetchina/Furion/commit/58d2c20de05dc458b206863f7814e89866e7522b)
  - &nbsp;<Tag>新增</Tag> `ValidationTypes` 更多常见验证格式（`手机机身码类型`，`统一社会信用代码`，`GUID/UUID`，`base64`） <sup>4.8.3.6</sup> <sup>⏱️2022.12.13</sup> [3680d7a](https://gitee.com/dotnetchina/Furion/commit/3680d7a7a53515dfb78625f2c6a393a788025685)
  - &nbsp;<Tag>新增</Tag> **定时任务 `IScheduler` 对象每次操作后自动刷新和提供手动刷新 `Reload()` 方法** <sup>4.8.3.3</sup> <sup>⏱️2022.12.09</sup> [#I65EQ1](https://gitee.com/dotnetchina/Furion/issues/I65EQ1#note_15047484_link)
  - &nbsp;<Tag>新增</Tag> 定时任务间隔分钟作业触发器 `Triggers.PeriodMinutes(5)` 和 `[PeriodMinutes(5)]` 特性 <sup>4.8.2.8</sup> <sup>⏱️2022.12.01</sup> [8e1f06f](https://gitee.com/dotnetchina/Furion/commit/8e1f06fa2161ee2bf8bcea29af8aaa5a60ef9db9)
  - &nbsp;<Tag>新增</Tag> 定时任务工作日作业触发器 `Triggers.Workday()` 和 `[Workday]` 特性 <sup>4.8.2.6</sup> <sup>⏱️2022.11.30</sup> [28b2d20](https://gitee.com/dotnetchina/Furion/commit/28b2d20b3f6034a4cdf5827576c34412315fbb15)
  - &nbsp;<Tag>新增</Tag> 定时任务作业校对功能，可对误差进行校正 <sup>4.8.2.6</sup> <sup>⏱️2022.11.30</sup> [f725a25](https://gitee.com/dotnetchina/Furion/commit/f725a252e6a89f9dea6489d4e54452077b1935e5)
  - &nbsp;<Tag>新增</Tag> `Crontab.ParseAt(..)` 静态方法 <sup>4.8.2.6</sup> <sup>⏱️2022.11.30</sup> [035cc23](https://gitee.com/dotnetchina/Furion/commit/035cc23a20045e9673a1406b94e72030f5f18375)
  - &nbsp;<Tag>新增</Tag> `Crontab` 所有 `Macro At` 静态方法 <sup>4.8.2.6</sup> <sup>⏱️2022.11.30</sup> [a15b69d](https://gitee.com/dotnetchina/Furion/commit/a15b69d0eeb4bdc8d0ec042cfec22ff0049dc89f)
  - &nbsp;<Tag>新增</Tag> `Crontab.Workday` 表示周一至周五的 `Macro` 静态属性 <sup>4.8.2.6</sup> <sup>⏱️2022.11.30</sup> [a15b69d](https://gitee.com/dotnetchina/Furion/commit/a15b69d0eeb4bdc8d0ec042cfec22ff0049dc89f)
  - &nbsp;<Tag>新增</Tag> **定时任务 `Triggers` 所有带 `At` 的 `Cron` 表达式触发器构建器及特性** <sup>4.8.2.5</sup> <sup>⏱️2022.11.29</sup> [#I63PLR](https://gitee.com/dotnetchina/Sundial/issues/I63PLR)
  - &nbsp;<Tag>新增</Tag> **`App.GetThreadId()` 和 `App.GetTraceId()` 获取线程 `Id` 和请求 `TraceId`** <sup>4.8.2.4</sup> <sup>⏱️2022.11.29</sup> [910fc1f](https://gitee.com/dotnetchina/Furion/commit/910fc1fbad9e40245c5694f30457cd4d2ca0d630)
  - &nbsp;<Tag>新增</Tag> **`App.GetExecutionTime(() => { /*Your Code*/ })` 获取代码执行耗时** <sup>4.8.2.4</sup> <sup>⏱️2022.11.29</sup> [5ab4b19](https://gitee.com/dotnetchina/Furion/commit/5ab4b19786e53d8934de08fd2f5430fc66c3b9a1)
  - &nbsp;<Tag>新增</Tag> 定时任务批量添加 `SchedulerBuilder` 作业功能 <sup>4.8.2.4</sup> <sup>⏱️2022.11.29</sup> [5faa67b](https://gitee.com/dotnetchina/Furion/commit/5faa67b7817459cb0ee0add86a6e53c17ff51a05)
  - &nbsp;<Tag>新增</Tag> 定时任务 `BuildSqlType` 配置，可设置生成不同数据库类型的 `SQL` 语句 <sup>4.8.2.3</sup> <sup>⏱️2022.11.29</sup> [293f9bc](https://gitee.com/dotnetchina/Furion/commit/293f9bce34fc4f70eacae1043ed697d31da88409) [!675](https://gitee.com/dotnetchina/Furion/pulls/675)
  - &nbsp;<Tag>新增</Tag> `JobDetail` 和 `Trigger` 自定义 `ConvertToSQL` 输出 `SQL` 配置 <sup>4.8.2</sup> <sup>⏱️2022.11.27</sup> [0bb9d8f](https://gitee.com/dotnetchina/Furion/commit/0bb9d8f1f3606af145b44c2984b87fdc020f02e1)
  - &nbsp;<Tag>新增</Tag> 动态作业处理程序委托支持 <sup>4.8.1.8</sup> <sup>⏱️2022.11.27</sup> [e02266c](https://gitee.com/dotnetchina/Furion/commit/e02266c44187dbc2b416abe1ca4112ce13c89180)
  - &nbsp;<Tag>新增</Tag> **作业触发器 `ResetOnlyOnce` 属性，支持只运行一次的作业重新启动服务重复执行** <sup>4.8.1.5</sup> <sup>⏱️2022.11.25</sup> [a8be728](https://gitee.com/dotnetchina/Furion/commit/a8be728eac986ebc5f44718b08c67aaee8b89dc6)
  - &nbsp;<Tag>新增</Tag> 事件总线支持简单的 `Order` 编排规则 <sup>4.8.0</sup> [833c0d4](https://gitee.com/dotnetchina/Furion/commit/833c0d4d069bca5f5304aa21cb32c7f902c20c69)
  - &nbsp;<Tag>新增</Tag> 远程请求代理模式对于基元类型参数支持自动获取参数名 <sup>4.8.0</sup> [#I60OT6](https://gitee.com/dotnetchina/Furion/issues/I60OT6)
  - &nbsp;<Tag>新增</Tag> 动态 `WebAPI` 自动识别方法的接口参数是否是服务，如果是自动添加 `[FromServices]` 特性 <sup>4.8.0</sup> [fae60a9](https://gitee.com/dotnetchina/Furion/commit/fae60a9c3097ec19ac2b3cd75ce1710ccd3e9294)
  - &nbsp;<Tag>新增</Tag> 远程请求 `[QueryString]` 特性添加时间格式化 `Format` 属性 <sup>4.8.1.2</sup> [!670](https://gitee.com/dotnetchina/Furion/pulls/670)
  - &nbsp;<Tag>新增</Tag> `Serve.Run` 模式的 `.ConfigureServices` 方法 <sup>4.8.0</sup> [023391b](https://gitee.com/dotnetchina/Furion/commit/023391b428f4239d926c3abb6cb0e2b92a0d738a)
  - &nbsp;<Tag>新增</Tag> `Serve.RunGeneric` 通用泛型主机方法 <sup>4.8.0</sup> [6865f3d](https://gitee.com/dotnetchina/Furion/commit/6865f3d3d890ee3c90901eaa949ad058d34b477d)
  - &nbsp;<Tag>新增</Tag> **`Serve.Run()` 的 `additional` 参数** <sup>4.8.0</sup> [023391b](https://gitee.com/dotnetchina/Furion/commit/023391b428f4239d926c3abb6cb0e2b92a0d738a)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

极速入门现在可以便捷注册服务，写测试例子的时候非常有用，无需编写 `Startup.cs`。

```cs showLineNumbers {1,7,13,19}
Serve.Run(additional: services =>
{
    services.AddRemoteRequest();
});

// 通用泛型主机方式
Serve.RunGeneric(additional: services =>
{
    services.AddRemoteRequest();
});

// 还可以省去 additional
Serve.Run(services =>
{
    services.AddRemoteRequest();
});

// 通用泛型主机方式
Serve.RunGeneric(services =>
{
    services.AddRemoteRequest();
});
```

  </div>
</details>

- - &nbsp;<Tag>新增</Tag> `Serve.Run` 主机返回值 `IHost` <sup>4.8.0</sup> [#I61XHV](https://gitee.com/dotnetchina/Furion/issues/I61XHV)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

在 `Winfom/WPF` 应用程序中，我们希望关闭窗体或退出应用程序时，能够关闭 `Serve` 主机：

```cs showLineNumbers {1,5,8,11-17}
using Microsoft.Extensions.Hosting;

public partial class App : Application
{
    private readonly IHost _host;
    public App()
    {
        _host = Serve.Run(silence: true);
    }

    protected override void OnExit(ExitEventArgs e)
    {
        _host.StopAsync();
        _host.Dispose();

        base.OnExit(e);
    }
}
```

  </div>
</details>

- - &nbsp;<Tag>新增</Tag> **日志 `JSON` 自动美化格式化器 `LoggerFormatter.JsonIndented`** <sup>4.8.0</sup> [7b9268c](https://gitee.com/dotnetchina/Furion/commit/7b9268cc2428b5ee6cc5ed259e5c45a6830bddb1)
- - &nbsp;<Tag>新增</Tag> `LoggingMonitor` 的 `JsonIndented` 配置，可配置是否美化 `JSON` <sup>4.8.0</sup> [7b9268c](https://gitee.com/dotnetchina/Furion/commit/7b9268cc2428b5ee6cc5ed259e5c45a6830bddb1)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

默认情况下，配置输出 `JSON` 格式化 `LoggerFormatter.Json` 会浓缩到一行显示。

新版本支持 `LoggerFormatter.JsonIndented` 美化 `JSON` 配置：

```cs showLineNumbers {2,4,8,10,14,16,20,22}
// 控制台日志
services.AddConsoleFormatter(options =>
{
    options.MessageFormat = LoggerFormatter.JsonIndented;
});

// 文件日志
services.AddFileLogging("mytemplate.log", options =>
{
    options.MessageFormat = LoggerFormatter.JsonIndented;
});

// 数据库日志
services.AddDatabaseLogging<DatabaseLoggingWriter>(options =>
{
    options.MessageFormat = LoggerFormatter.JsonIndented;
});

// LoggingMonitor 日志
services.AddMonitorLogging(options =>
{
    options.JsonIndented = true;
});
```

  </div>
</details>

- - &nbsp;<Tag>新增</Tag> **日志模块是否输出 `TraceId`，同一个请求的日志 `TraceId` 一致** <sup>4.8.1.3</sup> [#I62VGG](https://gitee.com/dotnetchina/Furion/issues/I62VGG)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

在生产环境中，日志的输出是非常频繁的，但是很难从日志文件中判断哪些日志是属于同一个请求输出的，所以新增 `WithTraceId` 配置。

```cs showLineNumbers {2,4,8,10,14,16,20,22}
// 控制台日志
services.AddConsoleFormatter(options =>
{
    options.WithTraceId = true;
});

// 文件日志
services.AddFileLogging("mytemplate.log", options =>
{
    options.WithTraceId = true;
});

// 数据库日志
services.AddDatabaseLogging<DatabaseLoggingWriter>(options =>
{
    options.WithTraceId = true;
});
```

输出日志如下：

```bash showLineNumbers {15,17}
info: 2022-11-24 14:34:55.1717549 +08:00 星期四 L System.Logging.EventBusService[0] #1
      EventBus Hosted Service is running.
info: 2022-11-24 14:34:55.2504015 +08:00 星期四 L System.Logging.ScheduleService[0] #1
      Schedule Hosted Service is running.
info: 2022-11-24 14:34:56.4280796 +08:00 星期四 L Microsoft.Hosting.Lifetime[14] #1
      Now listening on: https://localhost:5001
info: 2022-11-24 14:34:56.4331170 +08:00 星期四 L Microsoft.Hosting.Lifetime[14] #1
      Now listening on: http://localhost:5000
info: 2022-11-24 14:34:56.4384567 +08:00 星期四 L Microsoft.Hosting.Lifetime[0] #1
      Application started. Press Ctrl+C to shut down.
info: 2022-11-24 14:34:56.4408766 +08:00 星期四 L Microsoft.Hosting.Lifetime[0] #1
      Hosting environment: Development
info: 2022-11-24 14:34:56.4427659 +08:00 星期四 L Microsoft.Hosting.Lifetime[0] #1
      Content root path: D:\Workplaces\OpenSources\Furion\samples\Furion.Web.Entry
info: 2022-11-24 14:35:06.8507338 +08:00 Thursday L Furion.Application.TestLoggerServices[0] #17 '00-48df9ac5c8280de2f301faa44a23a10c-b75678d9f3883b0b-00'
      我是一个日志 20
info: 2022-11-24 14:35:16.0373384 +08:00 星期四 L Furion.Application.TestLoggerServices[0] #17 '00-ff4fb15d6ff41a0411784e66400f0dfd-962bc25eff788b25-00'
      我是一个日志 20
```

  </div>
</details>

- **突破性变化**

  - &nbsp;<Tag>调整</Tag> **旧版本定时任务为 `弃用` 状态（2022 年 12 月 31 日彻底删除），如需取消警告在 `.csproj` 中添加 `<NoWarn>0618</NoWarn>`** <sup>4.8.0</sup> [旧版本文档](/docs/job-old)
  - &nbsp;<Tag>移除</Tag> `JSON` 静态类所有方法的 `serviceProvider` 参数（无破坏） <sup>4.8.0</sup> [962fb16](https://gitee.com/dotnetchina/Furion/commit/962fb167aa13c689b688035bef26dcac73d3fca4)
  - &nbsp;<Tag>移除</Tag> `Http` 静态类所有方法的 `serviceProvider` 参数（无破坏） <sup>4.8.0</sup> [962fb16](https://gitee.com/dotnetchina/Furion/commit/962fb167aa13c689b688035bef26dcac73d3fca4)
  - &nbsp;<Tag>调整</Tag> **定时任务底层所有代码，日志，注释，文档** <sup>4.8.1.10</sup> <sup>⏱️2022.12.05</sup>

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 定时任务停止作业触发器后运行记录不能写入最新记录问题 <sup>4.8.4.8</sup> <sup>⏱️2023.01.05</sup> [d4c553f](https://gitee.com/dotnetchina/Furion/commit/d4c553fb9b0037ab29942ccc2a25a386fc28c1db)
  - &nbsp;<Tag>修复</Tag> 数据库日志注册在一些特殊情况下丢失日志上下文问题 <sup>4.8.4.6</sup> <sup>⏱️2023.01.04</sup> [#I68PDF](https://gitee.com/dotnetchina/Furion/issues/I68PDF)
  - &nbsp;<Tag>修复</Tag> 定时任务使用 `Furion.Pure` 包访问 `Dashboard` 出现 `404` 问题 <sup>4.8.4.2</sup> <sup>⏱️2023.01.02</sup> [21977b7](https://gitee.com/dotnetchina/Furion/commit/21977b70ef84fd674bb306ab86ef032f7f28c7a7)
  - &nbsp;<Tag>修复</Tag> 在类中贴 `[SuppressMonitor]` 特性但 `LoggingMonitor` 依然输出问题 <sup>4.8.4</sup> <sup>⏱️2022.12.30</sup> [#I6882I](https://gitee.com/dotnetchina/Furion/issues/I6882I)
  - &nbsp;<Tag>修复</Tag> 远程请求配置 `WithEncodeUrl(false)` 对 `application/x-www-form-urlencoded` 请求类型无效 <sup>4.8.4</sup> <sup>⏱️2022.12.30</sup> [#I682DX](https://gitee.com/dotnetchina/Furion/issues/I682DX)
  - &nbsp;<Tag>修复</Tag> `LoggingMonitor` 序列化 `IQueryable<>` 或 `OData` 返回值类型出现死循环问题 <sup>4.8.3.4</sup> <sup>⏱️2022.12.10</sup> [7e8c9d0](https://gitee.com/dotnetchina/Furion/commit/7e8c9d0e3910c4d0cfa18a7a15cbe8415d34dd66)
  - &nbsp;<Tag>修复</Tag> 定时任务通过 `scheduler.RemoveTrigger(triggerId)` 报异常问题 <sup>4.8.3.3</sup> <sup>⏱️2022.12.09</sup> [#I65EQ1](https://gitee.com/dotnetchina/Furion/issues/I65EQ1#note_15047484_link)
  - &nbsp;<Tag>修复</Tag> 定时任务作业触发器配置了 `EndTime` 和 `StartTime` 之后 `Status` 没有对应上 <sup>4.8.3.1</sup> <sup>⏱️2022.12.09</sup> [52a5506](https://gitee.com/dotnetchina/Furion/commit/52a5506c2fda7c31df01b2e90af7ad6b0c5f94aa)
  - &nbsp;<Tag>修复</Tag> 定时任务通过 `scheduler.AddTrigger(triggerBuilder)` 无效的问题 <sup>4.8.3.1</sup> <sup>⏱️2022.12.09</sup> [#I65EQ1](https://gitee.com/dotnetchina/Furion/issues/I65EQ1)
  - &nbsp;<Tag>修复</Tag> 作业拥有多个触发器时暂停作业后依然存在个别未暂停的清空（并发问题） <sup>4.8.2.12</sup> <sup>⏱️2022.12.07</sup> [#I655W9](https://gitee.com/dotnetchina/Furion/issues/I655W9)
  - &nbsp;<Tag>修复</Tag> **通过 `Ctrl + C` 终止应用程序后获取 `TraceId` 出现对象已释放异常** <sup>4.8.1.12</sup> <sup>⏱️2022.12.07</sup> [55c3e49](https://gitee.com/dotnetchina/Furion/commit/55c3e4942b1f89e0548d4cf90453937ba4ea512c)
  - &nbsp;<Tag>修复</Tag> **`cli.ps1` 脚本不支持 `EFCore 7.0` 问题** <sup>4.8.1.12</sup> <sup>⏱️2022.12.07</sup> [!676](https://gitee.com/dotnetchina/Furion/pulls/676)
  - &nbsp;<Tag>修复</Tag> `EFCore` 实体监听器 `IEntityChangedListener` 问题 <sup>4.8.1.7</sup> <sup>⏱️2022.11.26</sup> [#I61CTI](https://gitee.com/dotnetchina/Furion/issues/I61CTI)
  - &nbsp;<Tag>修复</Tag> 定时任务生成的 `SQL` 语句不支持 `MySQL` 问题 <sup>4.8.1.7</sup> <sup>⏱️2022.11.26</sup> [#I638ZC](https://gitee.com/dotnetchina/Furion/issues/I638ZC)
  - &nbsp;<Tag>修复</Tag> 运行时启动/暂停作业无效问题 <sup>4.8.1.6</sup> <sup>⏱️2022.11.25</sup> [#I6368M](https://gitee.com/dotnetchina/Furion/issues/I6368M)
  - &nbsp;<Tag>修复</Tag> 作业触发器不符合下一次执行规律但 `NextRunTime` 不为 `null` 情况 <sup>4.8.1.5</sup> <sup>⏱️2022.11.25</sup> [a8be728](https://gitee.com/dotnetchina/Furion/commit/a8be728eac986ebc5f44718b08c67aaee8b89dc6)
  - &nbsp;<Tag>修复</Tag> 从 `.NET6/7` 降级回 `.NET5` 找不到 `.AddDateOnlyConverters()` 和 `.AddTimeOnlyConverters()` 拓展方法问题 <sup>4.8.0</sup> [cdddf8d](https://gitee.com/dotnetchina/Furion/commit/cdddf8dbf628abb85e0816335ebae6bee96f6dc1)
  - &nbsp;<Tag>修复</Tag> `Retry.InvokeAsync` 方法如果不传入 `fallbackPolicy` 参数报空异常问题 <sup>4.8.0</sup> [21af847](https://gitee.com/dotnetchina/Furion/commit/21af847b02ae6044d344450620fa4e549480e387)
  - &nbsp;<Tag>修复</Tag> 动态 `WebAPI` 不支持在 `.NET7` 不声明 `[FromServices]` 自动注入问题 <sup>4.8.0</sup> [#I62HP1](https://gitee.com/dotnetchina/Furion/issues/I62HP1)
  - &nbsp;<Tag>修复</Tag> 远程请求 `GetAsStreamAsync()` 报 `System.InvalidOperationException: Response Content-Length mismatch` 异常问题 <sup>4.8.1</sup> [#I62QY4](https://gitee.com/dotnetchina/Furion/issues/I62QY4)
  - &nbsp;<Tag>修复</Tag> `LoggingMonitor` 配置 `WriteFilter` 不起作用问题 <sup>4.8.1.2</sup> [#I62P52](https://gitee.com/dotnetchina/Furion/issues/I62P52) [90bcfda](https://gitee.com/dotnetchina/Furion/commit/90bcfda4e3af24df399cc6bdb5c558c2bbed2536)
  - &nbsp;<Tag>修复</Tag> `EFCore` 个别关系型数据库 `PostgreSQL/SqlServer/MySql` 出现短暂不能连接问题 <sup>4.8.1.3</sup> [2c530ef](https://gitee.com/dotnetchina/Furion/commit/2c530ef3886327b572ffaa9a7ad43be5e629e854)
  - &nbsp;<Tag>修复</Tag> 日志模块因 `v4.8.0+` 版本导致写入数据库日志空异常问题 <sup>4.8.2.1</sup> <sup>⏱️2022.11.28</sup> [8d9d72b](https://gitee.com/dotnetchina/Furion/commit/8d9d72b5bfcb8dfc730462c9313266ec0661d561)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> 定时任务调度器时间精度，控制持续执行一年误差在 `100ms` 以内 <sup>4.8.2.9</sup> <sup>⏱️2022.12.01</sup> [334d089](https://gitee.com/dotnetchina/Furion/commit/334d08989503bacd8bf2abb2cc87cf2031dc9da6)
  - &nbsp;<Tag>调整</Tag> 定时任务作业计划工厂 `GetNextRunJobs()` 方法逻辑 <sup>4.8.2.7</sup> <sup>⏱️2022.11.30</sup> [#I63VS2](https://gitee.com/dotnetchina/Furion/issues/I63VS2)
  - &nbsp;<Tag>调整</Tag> `LoggingMonitor` 解析授权逻辑，如果接口未授权则不打印授权信息 <sup>4.8.2.1</sup> <sup>⏱️2022.11.28</sup> [#I63D2E](https://gitee.com/dotnetchina/Furion/issues/I63D2E)

- **文档**

  - &nbsp;<Tag>新增</Tag> **[新版本定时任务文档](/docs/job)**
  - &nbsp;<Tag>新增</Tag> **[Cron 表达式解析文档](/docs/cron)**
  - &nbsp;<Tag>新增</Tag> **[任务队列文档](/docs/task-queue)**
  - &nbsp;<Tag>新增</Tag> [Schedular](/docs/global/schedular) 全局静态类文档
  - &nbsp;<Tag>新增</Tag> [TaskQueued](/docs/global/taskqueued) 全局静态类文档
  - &nbsp;<Tag>新增</Tag> 作业执行器实现超时文档 <sup>4.8.3.8</sup> <sup>⏱️2022.12.20</sup>
  - &nbsp;<Tag>新增</Tag> 作业触发器 `ResetOnlyOnce` 文档 <sup>4.8.1.5</sup> <sup>⏱️2022.11.25</sup> [a8be728](https://gitee.com/dotnetchina/Furion/commit/a8be728eac986ebc5f44718b08c67aaee8b89dc6)
  - &nbsp;<Tag>新增</Tag> **通过 `Roslyn` 动态编译代码创建 `IJob` 类型文档** <sup>4.8.1.5</sup> <sup>⏱️2022.11.25</sup> [2c5e5be](https://gitee.com/dotnetchina/Furion/commit/2c5e5befc7a335d6ef0e75eea0061aee1e4dd061)
  - &nbsp;<Tag>新增</Tag> 自定义 `JobDetail` 和 `Trigger` 输出 `SQL` 文档 <sup>4.8.2</sup> <sup>⏱️2022.11.27</sup> [0bb9d8f](https://gitee.com/dotnetchina/Furion/commit/0bb9d8f1f3606af145b44c2984b87fdc020f02e1)
  - &nbsp;<Tag>新增</Tag> 远程请求 `[QueryString]` 配置时间类型 `Format` 格式化文档 <sup>4.8.1.2</sup> <sup>⏱️2022.11.25</sup> [!673](https://gitee.com/dotnetchina/Furion/pulls/673)
  - &nbsp;<Tag>更新</Tag> `Serve.Run()` 入门文档文档、安全授权文档、前端接口代理文档、事件总线文档、日志文档、Worker Service 文档、数据库实体触发器文档、`App` 静态类文档、包管理工具文档

---

## v4.7.9（已发布）

:::caution .NET7 发布

**🚀🎉🔥 2022 年 11 月 08 日，微软发布了 .NET7 首个正式版。**

`Furion` 第一时间完成了适配，**`v4` 版本开始一套代码支持 `.NET5-.NET7/N`，支持所有 `Furion` 版本升级**。

:::

:::important 版本细节

- `v4.7.9` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I60MFK](https://gitee.com/dotnetchina/Furion/issues/I60MFK) <sup>2022.11.11</sup>
- `v4.7.7` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I60GZ8](https://gitee.com/dotnetchina/Furion/issues/I60GZ8) <sup>2022.11.10</sup>
- `v4.7.6` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I60591](https://gitee.com/dotnetchina/Furion/issues/I60591) <sup>2022.11.08</sup>
- `v4.7.5` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I600R4](https://gitee.com/dotnetchina/Furion/issues/I600R4) <sup>2022.11.08</sup>
- `v4.7.3` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5Z9TI](https://gitee.com/dotnetchina/Furion/issues/I5Z9TI) <sup>2022.11.03</sup>
- `v4.7.2` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5YG48](https://gitee.com/dotnetchina/Furion/issues/I5YG48) <sup>2022.10.30</sup>
- `v4.7.1` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5Y6U3](https://gitee.com/dotnetchina/Furion/issues/I5Y6U3) <sup>2022.10.28</sup>
- `v4.7.0` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5Y04N](https://gitee.com/dotnetchina/Furion/issues/I5Y04N) <sup>2022.10.27</sup>

:::

- **新特性**

  - &nbsp;<Tag>新增</Tag> 日志模块时间格式化默认输出 `毫秒` 部分，针对并发比较高的场景 <sup>4.7.0</sup> [c0dc36c](https://gitee.com/dotnetchina/Furion/commit/c0dc36c4a2294596cbf3f5cdbdb2589c447bf746)
  - &nbsp;<Tag>新增</Tag> 写入数据库日志死循环输出检测机制 <sup>4.7.0</sup> [30dea0c](https://gitee.com/dotnetchina/Furion/commit/30dea0cebf8a946bea670fa0d2f82cde8321b847)
  - &nbsp;<Tag>新增</Tag> `LoggingMonitor` 输出 `系统信息`，`.NET 架构` 和 `基础框架` <sup>4.7.1</sup> [aeda902](https://gitee.com/dotnetchina/Furion/commit/aeda90259ef0684bff6308e2f387d89ac9081d37)
  - &nbsp;<Tag>新增</Tag> 远程请求 `.SetQueries(obj, ignoreNullValue)` 重载方法 <sup>4.7.3</sup> [#I5Z8KC](https://gitee.com/dotnetchina/Furion/issues/I5Z8KC)
  - &nbsp;<Tag>新增</Tag> 远程请求 `.GetCookies()` 和 `.GetSetCookies()` 拓展方法 <sup>4.7.5</sup> [#I5ZY1L](https://gitee.com/dotnetchina/Furion/issues/I5ZY1L)
  - &nbsp;<Tag>新增</Tag> 事件总线 `.ReplaceStorerOrFallback` 自定义事件源存储器方法，可在自定义初始失败时回退到默认值 <sup>4.7.6</sup> [#I602NU](https://gitee.com/dotnetchina/Furion/issues/I602NU)
  - &nbsp;<Tag>新增</Tag> `LoggingMonitor` 输出 `启动信息`，`Cookies` 和 `请求端源` 信息 <sup>4.7.7</sup> [3037b04](https://gitee.com/dotnetchina/Furion/commit/3037b04cac8cfa70d6e7f1dba62d48362f75e778)
  - &nbsp;<Tag>新增</Tag> **`JSON` 序列化 `DateOnly` 和 `TimeOnly` 类型转换器：`.AddDateOnlyConverters()` 和 `.AddTimeOnlyConverters()`** <sup>4.7.9</sup> [!657](https://gitee.com/dotnetchina/Furion/pulls/657) [47a5fcb](https://gitee.com/dotnetchina/Furion/commit/47a5fcbe9dbcff4fb35addc178d2715dbb3544a2)
  - &nbsp;<Tag>新增</Tag> **`HttpContext.ReadBodyContentAsync()` 拓展方法重复读取 `Body` 内容** <sup>4.7.9</sup> [#I60IYU](https://gitee.com/dotnetchina/Furion/issues/I60IYU)

- **突破性变化**

  - &nbsp;<Tag>新增</Tag> **所有脚手架支持 `-f` 指定 `.NET` 版本** <sup>4.7.6</sup> [#I603AZ](https://gitee.com/dotnetchina/Furion/issues/I603AZ)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```bash showLineNumbers {2,5,8}
# 创建 .NET5 版本
dotnet new furionapi -n 项目名称 -f net5

# 创建 .NET6 版本
dotnet new furionapi -n 项目名称 -f net6

# 创建 .NET7 版本
dotnet new furionapi -n 项目名称 -f net7
```

  </div>
</details>

- - &nbsp;<Tag>升级</Tag> **适配 `.NET 6.0.11` 和 `.NET 7`** <sup>4.7.5</sup> [7df3195](https://gitee.com/dotnetchina/Furion/commit/7df31951cc565327ae101d416551c6de3afa401b)
- - &nbsp;<Tag>升级</Tag> **所有脚手架至 `.NET 7`** <sup>4.7.5</sup> [7df3195](https://gitee.com/dotnetchina/Furion/commit/7df31951cc565327ae101d416551c6de3afa401b)
- - &nbsp;<Tag>调整</Tag> **`LogContext` 类型的所有方法至 `Furion.Logging` 命名空间下，解决空异常问题** <sup>4.7.3</sup> [#I5YOT3](https://gitee.com/dotnetchina/Furion/issues/I5YOT3)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

由：

```cs showLineNumbers
var value = logContext.Get("Key");  // 过去如果 logContext == null 报错
```

改为：

```cs showLineNumbers {1}
using Furion.Logging;

var value = logContext.Get("Key");  // 新版本不会报错，且 value = null
```

  </div>
</details>

- - &nbsp;<Tag>调整</Tag> **旧版本定时任务为 `弃用` 状态（一周内发布新版），如需取消警告在 `.csproj` 中添加 `<NoWarn>0618</NoWarn>`** <sup>4.7.9</sup> [0ff3ac0](https://gitee.com/dotnetchina/Furion/commit/0ff3ac0fcc54c510ce444b80e9f83eb2c81dc9ba)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> **生成 `JWT Token` 时间戳和自动刷新逻辑在高并发下检查有效性不够精确问题，原因是时间戳丢掉了毫秒部分** <sup>4.7.0</sup> [3c0c017](https://gitee.com/dotnetchina/Furion/commit/3c0c017ca43c9043bb5806b2951a5bcc7d571142)
  - &nbsp;<Tag>修复</Tag> **在 `IDatabaseLoggingWriter` 实现类中输出日志导致死循环问题** <sup>4.7.0</sup> [30dea0c](https://gitee.com/dotnetchina/Furion/commit/30dea0cebf8a946bea670fa0d2f82cde8321b847)
  - &nbsp;<Tag>修复</Tag> 规范化结果 `OnResponseStatusCodes` 方法在 `Response` 已完成写入时设置出现异常问题 <sup>4.7.2</sup> [#I5YBHL](https://gitee.com/dotnetchina/Furion/issues/I5YBHL)
  - &nbsp;<Tag>修复</Tag> `L.SetCulture("zh-CN");` 在 `Response` 已完成写入时设置出现异常问题 <sup>4.7.2</sup> [#I5YBHL](https://gitee.com/dotnetchina/Furion/issues/I5YBHL)
  - &nbsp;<Tag>修复</Tag> 动态 `WebAPI` 在类上配置 `[Route]` 特性且包含 `[action]` 模板导致生成错误接口路径 <sup>4.7.2</sup> [#I5YEZQ](https://gitee.com/dotnetchina/Furion/issues/I5YEZQ)
  - &nbsp;<Tag>修复</Tag> 启用二级虚拟目录 `AppSettings:VirtualPath` 导致 `swagger` 的 `miniprofile` 加载失败 <sup>4.7.3</sup> [#I5Z8RM](https://gitee.com/dotnetchina/Furion/issues/I5Z8RM)
  - &nbsp;<Tag>修复</Tag> `LoggingMonitor` 监听带有 `[FromServices]` 的方法参数或接口类型参数出错 <sup>4.7.7</sup> [3037b04](https://gitee.com/dotnetchina/Furion/commit/3037b04cac8cfa70d6e7f1dba62d48362f75e778)
  - &nbsp;<Tag>修复</Tag> `HttpRequest` 通过 `.ReadBodyContentAsync()` 读取不到 `Body` 问题 <sup>4.7.9</sup> [#I60IYU](https://gitee.com/dotnetchina/Furion/issues/I60IYU)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> `JSON Schema` 配置，新增日志更多参数提醒 <sup>4.7.0</sup> [74bee56](https://gitee.com/dotnetchina/Furion/commit/74bee56ce2a6d305c3825d72e42f6dcaff102aaf)
  - &nbsp;<Tag>调整</Tag> 日志记录时间格式默认输出带 `7位` 的毫秒值 <sup>4.7.1</sup> [aeda902](https://gitee.com/dotnetchina/Furion/commit/aeda90259ef0684bff6308e2f387d89ac9081d37)
  - &nbsp;<Tag>调整</Tag> 所有脚手架默认启用 `单文件/独立部署` 配置 <sup>4.7.7</sup> [1277f53](https://gitee.com/dotnetchina/Furion/commit/1277f53085833001d241c713b1ec4b8e0a27843e)

- **文档**

  - &nbsp;<Tag>新增</Tag> `IIS` 回收问题解决方案文档
  - &nbsp;<Tag>新增</Tag> 远程请求获取 `Cookies` 文档
  - &nbsp;<Tag>新增</Tag> `LoggingMonitor` 写入数据库文档
  - &nbsp;<Tag>新增</Tag> JSON 序列化 `DateOnly` 和 `TimeOnly` 类型处理文档
  - &nbsp;<Tag>新增</Tag> `HttpContext` 读取 `Body` 内容文档
  - &nbsp;<Tag>新增</Tag> `PM2` 配置文件 `json` 部署文档
  - &nbsp;<Tag>更新</Tag> 日志记录文档、定时任务文档、远程请求文档、脚手架文档

- **特别贡献**

  - [@YaChengMu](https://gitee.com/YaChengMu)：[!657](https://gitee.com/dotnetchina/Furion/pulls/657)
  - [@LiuDanK](https://gitee.com/LiuDanK_admin)：[#I60MP2](https://gitee.com/dotnetchina/Furion/issues/I60MP2)

---

## v4.6.9（已发布）

:::important 版本细节

- `v4.6.9` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5XKW4](https://gitee.com/dotnetchina/Furion/issues/I5XKW4) <sup>2022.10.25</sup>
- `v4.6.8` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5X2Q0](https://gitee.com/dotnetchina/Furion/issues/I5X2Q0) <sup>2022.10.22</sup>
- `v4.6.7` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5WQPP](https://gitee.com/dotnetchina/Furion/issues/I5WQPP) <sup>2022.10.20</sup>
- `v4.6.6` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5WOIV](https://gitee.com/dotnetchina/Furion/issues/I5WOIV) <sup>2022.10.20</sup>
- `v4.6.5` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5VPD1](https://gitee.com/dotnetchina/Furion/issues/I5VPD1) <sup>2022.10.14</sup>
- `v4.6.4` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5VIAQ](https://gitee.com/dotnetchina/Furion/issues/I5VIAQ) <sup>2022.10.13</sup>
- `v4.6.3` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5V99T](https://gitee.com/dotnetchina/Furion/issues/I5V99T) <sup>2022.10.12</sup>
- `v4.6.2` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5V6UE](https://gitee.com/dotnetchina/Furion/issues/I5V6UE) <sup>2022.10.12</sup>
- `v4.6.1` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5UYQW](https://gitee.com/dotnetchina/Furion/issues/I5UYQW) <sup>2022.10.11</sup>
- `v4.6.0` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5UQZ7](https://gitee.com/dotnetchina/Furion/issues/I5UQZ7) <sup>2022.10.10</sup>

:::

- **新特性**

  - &nbsp;<Tag>新增</Tag> `LoggingMonitor` 支持 `FileResult` 类型监听 <sup>4.6.0</sup> [bf9c0b1](https://gitee.com/dotnetchina/Furion/commit/bf9c0b1d7c695e800b3fdcca1ba578dd26e88d19)
  - &nbsp;<Tag>新增</Tag> `LogMessage` 结构 `UseUtcTimestamp` 字段，解释日志记录时间格式是 `UTC` 还是 `LOCAL` 时间 <sup>4.6.1</sup> [aab0371](https://gitee.com/dotnetchina/Furion/commit/aab0371d6473117e1e602eef1b9841c48d184e84)
  - &nbsp;<Tag>新增</Tag> 事件总线模块重试失败后支持回调 <sup>4.6.1</sup> [#I5UVMV](https://gitee.com/dotnetchina/Furion/issues/I5UVMV)
  - &nbsp;<Tag>新增</Tag> `LoggingMonitor` 支持序列化忽略指定属性名或属性类型 <sup>4.6.1</sup> [81c6343](https://gitee.com/dotnetchina/Furion/commit/81c6343a2ddb3751e72de7c5943048c903c638b4)
  - &nbsp;<Tag>新增</Tag> **`long` 序列化丢精度的 `JsonConvert` 内置转换器，`.AddLongTypeConverters()`** <sup>4.6.5</sup> [#I5VJHC](https://gitee.com/dotnetchina/Furion/issues/I5VJHC) [aded58d](https://gitee.com/dotnetchina/Furion/commit/aded58d0bc587d1a1844382c66ec1ab3de96be7c)
  - &nbsp;<Tag>新增</Tag> `app.EnableBuffering()` 拓展，解决 `Request.Body` 不能重复读问题 <sup>4.6.5</sup> [aded58d](https://gitee.com/dotnetchina/Furion/commit/aded58d0bc587d1a1844382c66ec1ab3de96be7c)
  - &nbsp;<Tag>新增</Tag> **支持特别接口使用特定的序列化规则** <sup>4.6.6</sup> [797b0bf](https://gitee.com/dotnetchina/Furion/commit/797b0bfe7c702877b1e0f56ee1a97d91fc80c551)
  - &nbsp;<Tag>新增</Tag> `LoggingMonitor` 自动解析 `JWT` 时间戳为时间格式 <sup>4.6.8</sup> [9e31b0b](https://gitee.com/dotnetchina/Furion/commit/9e31b0b0cf9adc5fbbf92efd67c781ba8d003cc9)

- **突破性变化**

  - &nbsp;<Tag>升级</Tag> **适配 `.NET 6.0.10` 和 `.NET 7 RC2`** <sup>4.6.2</sup> [6bb2fad](https://gitee.com/dotnetchina/Furion/commit/6bb2fadd6600edcebc1539faedba98d4db0e189e)
  - &nbsp;<Tag>新增</Tag> 内置 `Microsoft.AspNetCore.Mvc.NewtonsoftJson` 拓展，原因是太多人使用了 <sup>4.6.5</sup> [aded58d](https://gitee.com/dotnetchina/Furion/commit/aded58d0bc587d1a1844382c66ec1ab3de96be7c)
  - &nbsp;<Tag>移除</Tag> ~~`"some log".SetCategory(name)` 拓展方法~~ <sup>4.6.0</sup> [ec4838c](https://gitee.com/dotnetchina/Furion/commit/ec4838c218ed9c96ba92d7a80fd11539da59ca22)
  - &nbsp;<Tag>移除</Tag> ~~`DateOnlyJsonConverter` 和 `DateOnlyOffsetJsonConverter` 处理~~ <sup>4.6.5</sup> [aded58d](https://gitee.com/dotnetchina/Furion/commit/aded58d0bc587d1a1844382c66ec1ab3de96be7c)
  - &nbsp;<Tag>调整</Tag> **事件总线触发处理程序的逻辑，由过去的 `foreach` 改为 `Parallel.ForEach`，吞吐量提升近 4 倍** <sup>4.6.4</sup> [7384c9c](https://gitee.com/dotnetchina/Furion/commit/7384c9c3efb94883421379828565e61870f1640c)
  - &nbsp;<Tag>调整</Tag> **~~`.AddDateFormatString()`~~ 名称为 `.AddDateTimeTypeConverters()`** <sup>4.6.5</sup> [aded58d](https://gitee.com/dotnetchina/Furion/commit/aded58d0bc587d1a1844382c66ec1ab3de96be7c)
  - &nbsp;<Tag>调整</Tag> **重构日志模块设置上下文数据功能** <sup>4.6.0</sup> [1c198ee](https://gitee.com/dotnetchina/Furion/commit/1c198ee2701e0ca76bca1057df6fce6789344c35)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

由于过去版本设置日志上下文有多线程异常和堆内存溢出风险，所以重新设计了日志上下文的写法。

由：

```cs showLineNumbers {1}
_logger.ScopeContext(ctx => ctx.Set("Name", "Furion").Set("UserId", 10))
       .LogInformation("我是一个日志 {id}", 20);
```

改为：

```cs showLineNumbers {1,7}
using (var scope = _logger.ScopeContext(ctx => ctx.Set("Name", "Furion").Set("UserId", 10)))
{
  _logger.LogInformation("我是一个日志 {id}", 20);
}

// 也可以简写
using var scope = _logger.ScopeContext(ctx => ctx.Set("Name", "Furion").Set("UserId", 10));
_logger.LogInformation("我是一个日志 {id}", 20);
```

  </div>
</details>

- - &nbsp;<Tag>移除</Tag> ~~**远程请求 `.SetTimeout` 和 `[Timeout]` 配置方法，采用全局统一配置**~~ <sup>4.6.4</sup> [7384c9c](https://gitee.com/dotnetchina/Furion/commit/7384c9c3efb94883421379828565e61870f1640c)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

默认情况下，`HttpClient` 请求超时时间为 `100秒`，可根据实际情况进行设置：

```cs showLineNumbers {4,10}
// 配置默认 HttpClient
options.AddHttpClient(string.Empty, c =>
{
    c.Timeout = TimeSpan.FromMinutes(2);
});

// 配置特定客户端
options.AddHttpClient("github", c =>
{
    c.Timeout = TimeSpan.FromMinutes(2);
});
```

  </div>
</details>

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `4.5.9+` 版本新增的 `IncludeScopes` 配置导致日志上下文失效 <sup>4.6.0</sup> [4a76841](https://gitee.com/dotnetchina/Furion/commit/4a768415bb2effe47f1a6e12de0773d3bbd6f75c)
  - &nbsp;<Tag>修复</Tag> 多个 `sql` 共用 `DbParameters` 出现冲突问题 <sup>4.6.0</sup> [#I5UO2H](https://gitee.com/dotnetchina/Furion/issues/I5UO2H)
  - &nbsp;<Tag>修复</Tag> 高频率写入日志导致堆内存溢出的异常问题 <sup>4.6.0</sup> [#I5UJRS](https://gitee.com/dotnetchina/Furion/issues/I5UJRS)
  - &nbsp;<Tag>修复</Tag> 框架内部所有使用 `.CreateLogger` 创建的日志对象无法应用上下文问题 <sup>4.6.0</sup> [ec4838c](https://gitee.com/dotnetchina/Furion/commit/ec4838c218ed9c96ba92d7a80fd11539da59ca22)
  - &nbsp;<Tag>修复</Tag> 修复远程请求不能在 `Worker Serivce` 中进行构造函数注入，原因是注册为 `Scope` 范围作用域 <sup>4.6.3</sup> [974f835](https://gitee.com/dotnetchina/Furion/commit/974f835ccdcf84bc84dd6f7044589ae2a2e7a57b)
  - &nbsp;<Tag>修复</Tag> **个别服务器的 `SQL Server` 不支持 `TLS 1.2` 协议问题** <sup>4.6.3</sup> [974f835](https://gitee.com/dotnetchina/Furion/commit/974f835ccdcf84bc84dd6f7044589ae2a2e7a57b)
  - &nbsp;<Tag>修复</Tag> `.ToDictionary()` 拓展不支持 `JObject` 类型问题 <sup>4.6.5</sup> [#I5VJHC](https://gitee.com/dotnetchina/Furion/issues/I5VJHC) [a11bf8d](https://github.com/MonkSoul/Furion/commit/a11bf8d8b6bb90b41b8394d8bca35aa3539239e6)
  - &nbsp;<Tag>修复</Tag> `LoggingMonitor` 处理 `long` 类型丢精度问题 <sup>4.6.5</sup> [#I5VJHC](https://gitee.com/dotnetchina/Furion/issues/I5VJHC) [aded58d](https://gitee.com/dotnetchina/Furion/commit/aded58d0bc587d1a1844382c66ec1ab3de96be7c)
  - &nbsp;<Tag>修复</Tag> 动态 `WebAPI` 在 `class` 类型上贴 `[ApiDescriptionSettings(false)]` 导致接口 `404` 问题 <sup>4.6.7</sup> [#I5WQ18](https://gitee.com/dotnetchina/Furion/issues/I5WQ18)
  - &nbsp;<Tag>修复</Tag> 超高频率下发送事件总线消息，但是 `GC` 来不及回收导致内存和 `CPU` 爆掉问题 <sup>4.6.8</sup> [dbc7935](https://gitee.com/dotnetchina/Furion/commit/dbc7935618ff60d7f41d82c0d49042cd189e58b9)
  - &nbsp;<Tag>修复</Tag> **`JWT` 模块自动刷新 `Token` 达到临界值时导致自动刷新失败，并返回错误的 `401` 状态码** <sup>4.6.8</sup> [#I5WXHZ](https://gitee.com/dotnetchina/Furion/issues/I5WXHZ)
  - &nbsp;<Tag>修复</Tag> 自动生成 `vue/react/angular` 客户端工具库错误处理 `Token` 问题 <sup>4.6.8</sup> [#I5WXHZ](https://gitee.com/dotnetchina/Furion/issues/I5WXHZ)
  - &nbsp;<Tag>修复</Tag> 远程请求没有正确处理 `数组和集合` 类型的 `url` 参数 <sup>4.6.9</sup> [#I5XIQ4](https://gitee.com/dotnetchina/Furion/issues/I5XIQ4)
  - &nbsp;<Tag>修复</Tag> 自定义 `Tenant` 实体且包含 `TenantId` 属性且没有继承 `EntityBase/Entity` 基类出现 `The entity type 'Tenant' requires a primary key to be defined` <sup>4.6.9</sup> [#I4UM3E](https://gitee.com/dotnetchina/Furion/issues/I4UM3E)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> `LoggingMonitor` 返回值类型是 `泛型` 时获取 `FullName` 带程序集签名问题 <sup>4.6.2</sup> [f0aaec6](https://gitee.com/dotnetchina/Furion/commit/f0aaec6a5ae358bab7f4b6ed58848de8a7f32f5e)
  - &nbsp;<Tag>调整</Tag> 优化远程请求性能，添加复用池的机制，避免频繁销毁创建 <sup>4.6.4</sup> [7384c9c](https://gitee.com/dotnetchina/Furion/commit/7384c9c3efb94883421379828565e61870f1640c)

- **文档**

  - &nbsp;<Tag>新增</Tag> 远程请求设置客户端生命周期配置文档和新超时配置文档
  - &nbsp;<Tag>新增</Tag> `JSON` 序列化处理 `long` 类型说明文档
  - &nbsp;<Tag>新增</Tag> `JSON` 反序列化 `DateTimeOffset` 类型个别格式出错问题解决方案文档
  - &nbsp;<Tag>新增</Tag> `Worker Service` 实现 `串行` 操作文档
  - &nbsp;<Tag>新增</Tag> 关闭 `.NET Core` 底层日志和远程请求日志文档
  - &nbsp;<Tag>新增</Tag> 规范化结果支持特定接口配置独立序列化配置文档
  - &nbsp;<Tag>更新</Tag> 日志记录文档、事件总线文档、数据库入门文档、`JSON` 序列化文档、远程请求文档、安全授权文档、生成前端请求代理文档

---

## v4.5.9（已发布）

:::important 版本细节

- `v4.5.9` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5ULWN](https://gitee.com/dotnetchina/Furion/issues/I5ULWN) <sup>2022.10.09</sup>
- `v4.5.8` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5UGNS](https://gitee.com/dotnetchina/Furion/issues/I5UGNS) <sup>2022.10.08</sup>
- `v4.5.7` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5U8Q9](https://gitee.com/dotnetchina/Furion/issues/I5U8Q9) <sup>2022.10.06</sup>
- `v4.5.6` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5U4SG](https://gitee.com/dotnetchina/Furion/issues/I5U4SG) <sup>2022.10.03</sup>
- `v4.5.5` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5U413](https://gitee.com/dotnetchina/Furion/issues/I5U413) <sup>2022.10.02</sup>
- `v4.5.4` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5U3MK](https://gitee.com/dotnetchina/Furion/issues/I5U3MK) <sup>2022.10.01</sup>
- `v4.5.2` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5TXON](https://gitee.com/dotnetchina/Furion/issues/I5TXON) <sup>2022.09.30</sup>
- `v4.5.1` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5TLI6](https://gitee.com/dotnetchina/Furion/issues/I5TLI6) <sup>2022.09.28</sup>
- `v4.5.0` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5TD4X](https://gitee.com/dotnetchina/Furion/issues/I5TD4X) <sup>2022.09.27</sup>

:::

- **新特性**

  - &nbsp;<Tag>新增</Tag> `.AddConsoleFormatter()` 拓展简化控制台日志模板配置 <sup>4.5.0</sup> [#I5TCMO](https://gitee.com/dotnetchina/Furion/issues/I5TCMO)
  - &nbsp;<Tag>新增</Tag> 控制台和文件日志时间默认显示 `星期几` <sup>4.5.1</sup> [#I5TKL5](https://gitee.com/dotnetchina/Furion/issues/I5TKL5)
  - &nbsp;<Tag>新增</Tag> 控制台和文件日志支持配置 `options.DateFormat` 日期格式化 <sup>4.5.1</sup> [#I5TKL5](https://gitee.com/dotnetchina/Furion/issues/I5TKL5)
  - &nbsp;<Tag>新增</Tag> 控制台日志带颜色输出，比如高亮 `日志级别` <sup>4.5.1</sup> [#I5TKL5](https://gitee.com/dotnetchina/Furion/issues/I5TKL5)
  - &nbsp;<Tag>新增</Tag> 控制台格式化配置 `options.WriteHandler` 完全自定义配置 <sup>4.5.2</sup> [7fb3036](https://gitee.com/dotnetchina/Furion/commit/7fb30368f9640360017fc7f357df13eeb5031c2b)
  - &nbsp;<Tag>新增</Tag> **日志输出 `JSON` 格式化配置** <sup>4.5.2</sup> [#I5TWC1](https://gitee.com/dotnetchina/Furion/issues/I5TWC1) [#I5OUT1](https://gitee.com/dotnetchina/Furion/issues/I5OUT1)
  - &nbsp;<Tag>新增</Tag> 数据库日志写入独立日志模板配置、独立日期格式配置 <sup>4.5.2</sup> [#I5TWC1](https://gitee.com/dotnetchina/Furion/issues/I5TWC1)
  - &nbsp;<Tag>新增</Tag> `LogMessage` 结构类 `LogDateTime`，`ThreadId`，`State` 属性 <sup>4.5.2</sup> [#I5TWC1](https://gitee.com/dotnetchina/Furion/issues/I5TWC1)
  - &nbsp;<Tag>新增</Tag> `LoggingMonitor` 可配置 `JsonWriterOptions` 属性 <sup>4.5.4</sup> [#I5U375](https://gitee.com/dotnetchina/Furion/issues/I5U375)
  - &nbsp;<Tag>新增</Tag> `Log.ScopeContext` 和 `"some log".ScopeContext` 拓展 <sup>4.5.4</sup> [8129693](https://gitee.com/dotnetchina/Furion/commit/812969357a60d0b73becf105e6b77b46113b3800)
  - &nbsp;<Tag>新增</Tag> 新增 `HttpContext.SetTokensOfResponseHeaders` 拓展 <sup>4.5.7</sup> [3775e65](https://gitee.com/dotnetchina/Furion/commit/3775e659ca13615bc7f65b050fb8540daeed9433)
  - &nbsp;<Tag>新增</Tag> 新增远程请求支持 `Stream` 文件格式上传 <sup>4.5.8</sup> [#I5UF3I](https://gitee.com/dotnetchina/Furion/issues/I5UF3I)
  - &nbsp;<Tag>新增</Tag> 日志模块可配置是否启用上下文功能 `IncludeScopes` 属性 <sup>4.5.9</sup> [#I5UJRS](https://gitee.com/dotnetchina/Furion/issues/I5UJRS)
  - &nbsp;<Tag>新增</Tag> `LoggingMonitor` 日志筛选 `WriteFilter` 配置 <sup>4.5.9</sup> [6f06f12](https://gitee.com/dotnetchina/Furion/commit/6f06f12b2c115bd181f4832daa7537efe5cb3fe8)

- **突破性变化**

  - &nbsp;<Tag>调整</Tag> **😊 `Furion` 框架文档地址为 [https://furion.baiqian.ltd](https://furion.baiqian.ltd)** <sup>4.5.4</sup> [2e3d80e](https://gitee.com/dotnetchina/Furion/commit/2e3d80ec0be830c33923ef9953ff504528120f06)
  - &nbsp;<Tag>调整</Tag> `LoggingMonitor` 底层逻辑，移除原来的 `.ScopeContext` 存储监听信息设计 <sup>4.5.2</sup> [#I5TWC1](https://gitee.com/dotnetchina/Furion/issues/I5TWC1)
  - &nbsp;<Tag>移除</Tag> ~~**主机未启动时构建服务的操作权限，此操作会导致内存激增，受影响方法： `App.GetOptions` 系列和 `App.GetService` 和 `Scoped.Create`**~~ <sup>4.5.4</sup> [#I5U0A4](https://gitee.com/dotnetchina/Furion/issues/I5U0A4) [8129693](https://gitee.com/dotnetchina/Furion/commit/812969357a60d0b73becf105e6b77b46113b3800)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

近期发现许多开发者在主机还未启动时解析服务，这是非常不正确的行为，会导致启动时内存激增甚至溢出，常见的错误有：

- 在启动的时候通过 `Scoped.Create` 创建作用域
- **在启动的时候通过 `App.GetOptions` 获取选项对象**
- 在启动的时候通过 `App.GetService<T>` 解析服务

正确的做法是，启动的时候禁止使用 `Scoped.Create` 和 `App.GetService<T>`。

**如需启动时获取配置应该通过：`App.GetConfig<TOptions>("配置节点", true)` 替代 `App.GetOptions<TOptions>()`**。

  </div>
</details>

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 字符串日志拓展带泛型方法不能正确显示 `CategoryName` 日志类别 <sup>4.5.0</sup> [#I5TBKL](https://gitee.com/dotnetchina/Furion/issues/I5TBKL)
  - &nbsp;<Tag>修复</Tag> 控制台日志设置了 `.ScopeContext` 无效问题 <sup>4.5.2</sup> [7fb3036](https://gitee.com/dotnetchina/Furion/commit/7fb30368f9640360017fc7f357df13eeb5031c2b)
  - &nbsp;<Tag>修复</Tag> `LoggingMonitor` 同时配置了局部和全局日志监听触发两次问题 <sup>4.5.2</sup> [a1a97e8](https://gitee.com/dotnetchina/Furion/commit/a1a97e817c43db4c20ba6e3aae03cea96d545a4b)
  - &nbsp;<Tag>修复</Tag> `v4.4.8+` 版本更新导致远程请求在个别情况下出现并发问题 <sup>4.5.2</sup> [#I5TWL3](https://gitee.com/dotnetchina/Furion/issues/I5TWL3)
  - &nbsp;<Tag>修复</Tag> `LoggingMonitor` 配置了 `ReturnValueThreshold` 之后 `Json` 被截断引发有效性检测异常 <sup>4.5.4</sup> [#I5U375](https://gitee.com/dotnetchina/Furion/issues/I5U375)
  - &nbsp;<Tag>修复</Tag> `LoggingMonitor` 不支持 `DataTable`，`DataSet`，`Tuple` 等类型问题 <sup>4.5.5</sup> [#I5U3VO](https://gitee.com/dotnetchina/Furion/issues/I5U3VO)
  - &nbsp;<Tag>修复</Tag> **自 `v4.5.2+` 版本升级后出现启动时使用 `App.GetOptons<TOptions>` 异常问题** <sup>4.5.6</sup> [#I5U4OC](https://gitee.com/dotnetchina/Furion/issues/I5U4OC) [f9a6587](https://gitee.com/dotnetchina/Furion/commit/f9a6587e3f7893db88c905cf77c3c4ebed39b73c)
  - &nbsp;<Tag>修复</Tag> `app.UseInject(action)` 导致死循环 <sup>4.5.7</sup> [!608](https://gitee.com/dotnetchina/Furion/pulls/608)
  - &nbsp;<Tag>修复</Tag> `LoggingMonitor` 报空引用异常问题 <sup>4.5.8</sup> [#I5UGCA](https://gitee.com/dotnetchina/Furion/issues/I5UGCA) [!610](https://gitee.com/dotnetchina/Furion/pulls/610)
  - &nbsp;<Tag>修复</Tag> 并发情况下设置日志上下文出现偶然性空引用问题 <sup>4.5.9</sup> [#I5UJRS](https://gitee.com/dotnetchina/Furion/issues/I5UJRS)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> 文件日志默认模板，默认对日志时间进行格式化并显示星期几 <sup>4.5.1</sup> [#I5TKL5](https://gitee.com/dotnetchina/Furion/issues/I5TKL5)
  - &nbsp;<Tag>调整</Tag> 脚手架代码，默认启用 `services.AddConsoleFormatter()` <sup>4.5.1</sup> [#I5TLI6](https://gitee.com/dotnetchina/Furion/issues/I5TLI6)
  - &nbsp;<Tag>调整</Tag> `Serve.Run()` 代码，默认启用 `services.AddConsoleFormatter()` <sup>4.5.1</sup> [#I5TLI6](https://gitee.com/dotnetchina/Furion/issues/I5TLI6)
  - &nbsp;<Tag>调整</Tag> 减少 `MiniProfile` 不必要的监听，只在 `Swagger` 页面请求才监听 <sup>4.5.7</sup> [697ef51](https://gitee.com/dotnetchina/Furion/commit/697ef51f4869a4d533a6debd2a17cb9f0c1000c3)
  - &nbsp;<Tag>调整</Tag> 日志模块所有日志时间默认为 `24小时制`，过去是 `12小时制` <sup>4.5.9</sup> [!612](https://gitee.com/dotnetchina/Furion/pulls/612)

- **文档**

  - &nbsp;<Tag>新增</Tag> 选项监听出现触发多次的解决方案 [#I5T9PR](https://gitee.com/dotnetchina/Furion/issues/I5T9PR)
  - &nbsp;<Tag>更新</Tag> 日志记录文档、动态 WebAPI 文档、选项文档、`HttpContext` 文档、远程请求文档

- **本期亮点**

- 1. **支持日志配置 `JSON` 格式化输出**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {2,4,8,10,14,16}
// 控制台
services.AddConsoleFormatter(options =>
{
    options.MessageFormat = LoggerFormatter.Json;
});

// 文件
services.AddFileLogging("mytemplate.log", options =>
{
    options.MessageFormat = LoggerFormatter.Json;
});

// 数据库
services.AddDatabaseLogging<DatabaseLoggingWriter>(options =>
{
    options.MessageFormat = LoggerFormatter.Json;
});
```

  </div>
</details>

- 2. **支持 `LoggingMonitor` 输出 `JSON` 格式**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

1. 全局/局部启用 `Json` 输出配置

```cs showLineNumbers {4,8}
// 全局
services.AddMonitorLogging(options =>
{
    options.JsonBehavior = Furion.Logging.JsonBehavior.OnlyJson;
});

// 局部
[LoggingMonitor(JsonBehavior = Furion.Logging.JsonBehavior.OnlyJson)]
```

:::note 关于 `JsonBehavior`

只有设置为 `JsonBehavior.OnlyJson` 时才不会输出**美观的**日志。

:::

2. 写入存储介质

```cs showLineNumbers {14-18}
using Furion.Logging;

namespace Your.Core;

public class DatabaseLoggingWriter : IDatabaseLoggingWriter
{
    // 支持构造函数注入任何实例，会自动释放任何服务，比如注入 IRepository，或者 SqlSugarClient
    public DatabaseLoggingWriter()
    {
    }

    public void Write(LogMessage logMsg, bool flush)
    {
        // 如果 JsonBehavior 配置为 OnlyJson 或者 All，那么 Context 就包含 loggingMonitor 的值
        // 如果 JsonBehavior 配置为 OnlyJson，那么可直接通过 logMsg.Message 获取结果就是 json 格式
        if (logMsg.LogName == "System.Logging.LoggingMonitor")
        {
            var jsonString = logMsg.Context.Get("loggingMonitor");
        }

        // 这里写你任何插入数据库的操作，无需 try catch
    }
}
```

`Json` 输出格式如下：

```json showLineNumbers
{
  "controllerName": "test-logger",
  "controllerTypeName": "TestLoggerServices",
  "actionName": "person",
  "actionTypeName": "GetPerson",
  "areaName": null,
  "displayName": "Furion.Application.TestLoggerServices.GetPerson (Furion.Application)",
  "localIPv4": "0.0.0.1",
  "remoteIPv4": "0.0.0.1",
  "httpMethod": "GET",
  "requestUrl": "https://localhost:5001/api/test-logger/person/2",
  "refererUrl": "https://localhost:5001/api/index.html?urls.primaryName=数据库操作演示",
  "environment": "Development",
  "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36 Edg/105.0.1343.53",
  "requestHeaderAuthorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySWQiOjEsIkFjY291bnQiOiJhZG1pbiIsImlhdCI6MTY2NDQ1MDUwNSwibmJmIjoxNjY0NDUwNTA1LCJleHAiOjE2NjQ0NTE3MDUsImlzcyI6ImRvdG5ldGNoaW5hIiwiYXVkIjoicG93ZXJieSBGdXJpb24ifQ.-xocNcDQGoXClceoVU5QAHIkTcOZ7ZXo0hEbzghDfFI",
  "timeOperationElapsedMilliseconds": 55,
  "authorizationClaims": [
    {
      "type": "UserId",
      "valueType": "integer",
      "value": "1"
    },
    {
      "type": "Account",
      "valueType": "string",
      "value": "admin"
    },
    {
      "type": "iat",
      "valueType": "integer",
      "value": "1664450505"
    },
    {
      "type": "nbf",
      "valueType": "integer",
      "value": "1664450505"
    },
    {
      "type": "exp",
      "valueType": "integer",
      "value": "1664451705"
    },
    {
      "type": "iss",
      "valueType": "string",
      "value": "dotnetchina"
    },
    {
      "type": "aud",
      "valueType": "string",
      "value": "powerby Furion"
    }
  ],
  "parameters": [
    {
      "name": "id",
      "type": "System.Int32",
      "value": 2
    }
  ],
  "returnInformation": {
    "type": "Furion.UnifyResult.RESTfulResult`1[[System.Object, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]",
    "actType": "Furion.Application.Persons.PersonDto",
    "value": {
      "StatusCode": 200,
      "Data": {
        "Id": 2,
        "Name": null,
        "Age": 0,
        "Address": null,
        "PhoneNumber": null,
        "QQ": null,
        "CreatedTime": "0001-01-01T00:00:00+00:00",
        "Childrens": null,
        "Posts": null
      },
      "Succeeded": true,
      "Errors": null,
      "Extras": null,
      "Timestamp": 1664450517341
    }
  },
  "exception": {
    "type": "System.DivideByZeroException",
    "message": "Attempted to divide by zero.",
    "stackTrace": "   at Furion.Application.TestLoggerServices.测试日志监听8(Int32 id) in D:\\Workplaces\\OpenSources\\Furion\\samples\\Furion.Application\\TestLoggerServices.cs:line 78\r\n   at lambda_method103(Closure , Object , Object[] )\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)"
  },
  "validation": {
    "errorCode": null,
    "originErrorCode": null,
    "message": "出错了啊。。。。"
  }
}
```

  </div>
</details>

- 3. **支持远程请求上传文件 `Stream` 流**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

1. 单文件上传

- 字符串方式

```cs showLineNumbers {1,5,9}
var fileStream = new FileStream("image.png", FileMode.Open);

var result = await "https://localhost:44316/api/test-module/upload-file"
                    .SetContentType("multipart/form-data")
                    .SetFiles(HttpFile.Create("file", fileStream, "image.png")).PostAsync();

var fileName = await result.Content.ReadAsStringAsync();

await fileStream.DisposeAsync();
```

- 代理方式

```cs showLineNumbers {1,3,6}
var fileStream = new FileStream("image.png", FileMode.Open);

var result = await _http.TestSingleFileProxyAsync(HttpFile.Create("file", fileStream, "image.png"));
var fileName = await result.Content.ReadAsStringAsync();

await fileStream.DisposeAsync();
```

2. 多文件上传

- 字符串方式

```cs showLineNumbers {1,5,8}
var fileStream = new FileStream("image.png", FileMode.Open);

var result = await "https://localhost:44316/api/test-module/upload-muliti-file"
                    .SetContentType("multipart/form-data")
                    .SetFiles(HttpFile.CreateMultiple("files", (fileStream, "image1.png"), (fileStream, "image2.png"))).PostAsync();
var fileName = await result.Content.ReadAsStringAsync();

await fileStream.DisposeAsync();
```

- 代理方式

```cs showLineNumbers {1,3,6}
var fileStream = new FileStream("image.png", FileMode.Open);

var result = await _http.TestMultiFileProxyAsync(HttpFile.CreateMultiple("files", (fileStream, "image1.png"), (fileStream, "image2.png")));
var fileName = await result.Content.ReadAsStringAsync();

await fileStream.DisposeAsync();
```

3. 还支持 `Bytes` 和 `Stream` 混合

```cs showLineNumbers {1-2,4-10,14,18}
var fileStream = new FileStream("image.png", FileMode.Open);
var bytes = File.ReadAllBytes("image.png");

var httpFile = new HttpFile
{
    Name = name,
    Bytes = bytes,
    FileStream = fileStream,
    FileName = fileName
};

var result = await "https://localhost:44316/api/test-module/upload-file"
                    .SetContentType("multipart/form-data")
                    .SetFiles(httpFile).PostAsync();

var fileName = await result.Content.ReadAsStringAsync();

await fileStream.DisposeAsync();
```

  </div>
</details>

- 4. **`LoggingMonitor` 全局过滤**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers showLineNumbers {1,3,10}
services.AddMonitorLogging(options =>
{
    options.WriteFilter = (context) =>
    {
        // 获取控制器/操作描述器
        var controllerActionDescriptor = context.ActionDescriptor as ControllerActionDescriptor;

        // 你的逻辑....，不需要拦截返回 false，否则 true

        return true;
    };
});
```

  </div>
</details>

---

## v4.4.9（已发布）

:::important 版本细节

- `v4.4.9` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5SP37](https://gitee.com/dotnetchina/Furion/issues/I5SP37) <sup>2022.09.23</sup>
- `v4.4.8` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5SKUE](https://gitee.com/dotnetchina/Furion/issues/I5SKUE) <sup>2022.09.22</sup>
- `v4.4.7` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5SEFE](https://gitee.com/dotnetchina/Furion/issues/I5SEFE) <sup>2022.09.21</sup>
- `v4.4.6` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5RSFD](https://gitee.com/dotnetchina/Furion/issues/I5RSFD) <sup>2022.09.19</sup>
- `v4.4.5` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5RHQX](https://gitee.com/dotnetchina/Furion/issues/I5RHQX) <sup>2022.09.16</sup>
- `v4.4.4` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5R5TI](https://gitee.com/dotnetchina/Furion/issues/I5R5TI) <sup>2022.09.15</sup>
- `v4.4.3` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5QVH3](https://gitee.com/dotnetchina/Furion/issues/I5QVH3) <sup>2022.09.13</sup>
- `v4.4.2` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5QDHX](https://gitee.com/dotnetchina/Furion/issues/I5QDHX) <sup>2022.09.08</sup>
- `v4.4.1` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5Q3SX](https://gitee.com/dotnetchina/Furion/issues/I5Q3SX) <sup>2022.09.07</sup>
- `v4.4.0` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5PQHR](https://gitee.com/dotnetchina/Furion/issues/I5PQHR) <sup>2022.09.05</sup>

:::

- **新特性**

  - &nbsp;<Tag>新增</Tag> 友好异常可控制是否输出错误日志配置 `LogError: true` <sup>4.4.0</sup> [#I5PKJH](https://gitee.com/dotnetchina/Furion/issues/I5PKJH)
  - &nbsp;<Tag>新增</Tag> `DateOnlyJsonConverter` 和 `DateOnlyOffsetJsonConverter` 序列化转换器 [!565](https://gitee.com/dotnetchina/Furion/pulls/565)
  - &nbsp;<Tag>新增</Tag> 事件总线 `LogEnabled` 配置，可控制是否输出服务日志 [#I5QLY5](https://gitee.com/dotnetchina/Furion/issues/I5QLY5)
  - &nbsp;<Tag>新增</Tag> **可实现任何多套规范化结果功能，支持特定控制器，特定方法** [#I5QZ37](https://gitee.com/dotnetchina/Furion/issues/I5QZ37)
  - &nbsp;<Tag>新增</Tag> `ILoggerFactory` 日志工厂动态批量添加文件日志拓展 [#I5R9PO](https://gitee.com/dotnetchina/Furion/issues/I5R9PO)
  - &nbsp;<Tag>新增</Tag> `App.GetCommandLineConfiguration(args)` 解析命令行参数静态方法 [803542c](https://gitee.com/dotnetchina/Furion/commit/803542c3e21496e92d2bf83aaa2d00831fcb09bc)
  - &nbsp;<Tag>新增</Tag> `Sql` 代理支持返回受影响行数 [#I5REJ9](https://gitee.com/dotnetchina/Furion/issues/I5REJ9)
  - &nbsp;<Tag>新增</Tag> **任意自定义日志文件名支持滚动日志删除功能** [#I5RFBQ](https://gitee.com/dotnetchina/Furion/issues/I5RFBQ)
  - &nbsp;<Tag>新增</Tag> `.pcd` 图片类型 `MIME` 为 `image/x-photo-cd` 支持 [5fafc84](https://gitee.com/dotnetchina/Furion/commit/5fafc8477a4d213d16db92cf030f409c758fab95)
  - &nbsp;<Tag>新增</Tag> 默认日志输出当前线程 `Environment.CurrentManagedThreadId` [b8fe2cd](https://gitee.com/dotnetchina/Furion/commit/b8fe2cdc49d1bd11e38ad37fa512acafc3d96417)
  - &nbsp;<Tag>新增</Tag> `app.UseInject(Action<UseInjectOptions>)` 重载方法，简化配置 <sup>4.4.8</sup> [0b645fe](https://gitee.com/dotnetchina/Furion/commit/0b645fede0ad81c4779a8b9b4b16d9c5d60c9662)

- **突破性变化**

  - &nbsp;<Tag>调整</Tag> 框架适配 **`.NET 6.0.9` 和 `.NET 7.0 RC1`** [be5b40](https://gitee.com/dotnetchina/Furion/commit/be5b4098bae2153f8d49cf9797e454afde0d0aab) [1eee77b](https://gitee.com/dotnetchina/Furion/commit/1eee77bff0954336dcc5402a09a3195667bb80f2)
  - &nbsp;<Tag>调整</Tag> 远程请求 `.SetBodyBytes` 为 `.SetFiles` [#I5PMS5](https://gitee.com/dotnetchina/Furion/issues/I5PMS5) [#I5PIYI](https://gitee.com/dotnetchina/Furion/issues/I5PIYI)
  - &nbsp;<Tag>调整</Tag> `FS.InitialContentTypeProvider()` 名称为 `FS.GetFileExtensionContentTypeProvider()` [5fafc84](https://gitee.com/dotnetchina/Furion/commit/5fafc8477a4d213d16db92cf030f409c758fab95)
  - &nbsp;<Tag>移除</Tag> ~~远程请求 `[BodyBytes]` 设计，采用 `HttpFile` 方式~~ [#I5PMS5](https://gitee.com/dotnetchina/Furion/issues/I5PMS5) [#I5PIYI](https://gitee.com/dotnetchina/Furion/issues/I5PIYI)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {3-4,7-8,11-12}
public interface IHttp : IHttpDispatchProxy
{
    [Post("https://www.furion.icu/upload", ContentType = "multipart/form-data")]
    Task<HttpResponseMessage> PostXXXAsync(HttpFile file);

    // 支持多个文件
    [Post("https://www.furion.icu/upload", ContentType = "multipart/form-data")]
    Task<HttpResponseMessage> PostXXXAsync(HttpFile[] files);

    // 支持多个文件
    [Post("https://www.furion.icu/upload", ContentType = "multipart/form-data")]
    Task<HttpResponseMessage> PostXXXAsync(IList<HttpFile> files);
}
```

```cs showLineNumbers {3,7}
// bytes 可以通过 File.ReadAllBytes(文件路径) 获取
var res = await "https://www.furion.icu/upload".SetContentType("multipart/form-data")
                                               .SetFiles(HttpFile.Create("file", bytes, "image.png")).PostAsync();

// 支持多个文件
var res = await "https://www.furion.icu/upload".SetContentType("multipart/form-data")
                                               .SetFiles(HttpFile.CreateMultiple("files", (bytes, "image1.png"), (bytes, "image2.png"))).PostAsync();
```

  </div>
</details>

- - &nbsp;<Tag>调整</Tag> 所有的 `AddInject` 和 `UseInject` 参数设计 [#I5QCF0](https://gitee.com/dotnetchina/Furion/issues/I5QCF0)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {3,5}
public void ConfigureServices(IServiceCollection services)
{
    services.AddInject(options =>
    {
        options.ConfigureSwaggerGen(gen =>
        {
            // ...
        });
    });
}
```

```cs showLineNumbers {3,5,10}
 public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
 {
      app.UseInject(configure: options =>
      {
          options.ConfigureSwagger(swg =>
          {
              // ...
          });

          options.ConfigureSwaggerUI(ui =>
          {
             // ...
          });
      });
}
```

  </div>
</details>

- - &nbsp;<Tag>调整</Tag> **远程请求所有 `xxxAsStreamAsync` 返回值** [#I5QVEB](https://gitee.com/dotnetchina/Furion/issues/I5QVEB)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

由：

```cs showLineNumbers
var stream = await "https://www.furion.icu/".GetAsStreamAsync();
```

改为：

```cs showLineNumbers
var (stream, encoding) = await "https://www.furion.icu/".GetAsStreamAsync();
```

  </div>
</details>

- - &nbsp;<Tag>新增</Tag> <Tag>调整</Tag> ** `.Inject()` 支持配置更多参数，开放底层更多权限** <sup>4.4.9</sup> [1182283](https://gitee.com/dotnetchina/Furion/commit/1182283f6303b2d73ae4c82cdbc8b5b705d90030)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {1}
.Inject((builder, options) => {
    options.ConfigureAppConfiguration((context, config) =>
    {

    });
    options.ConfigureServices((context, services) =>
    {

    });
});
```

  </div>
</details>

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 远程请求代理模式非泛型参数导致数组溢出问题 [#I5Q3SN](https://gitee.com/dotnetchina/Furion/issues/I5Q3SN)
  - &nbsp;<Tag>修复</Tag> `LoggingMonitor` 客户端 `IP` 记录错误 [#I5QCU1](https://gitee.com/dotnetchina/Furion/issues/I5QCU1) [!562](https://gitee.com/dotnetchina/Furion/pulls/562)
  - &nbsp;<Tag>修复</Tag> 远程请求响应报文中包含 `charset=gbk` 进行序列化后乱码问题 [#I5QVEB](https://gitee.com/dotnetchina/Furion/issues/I5QVEB)
  - &nbsp;<Tag>修复</Tag> 文件日志断电时丢失日志问题 [ db7d51b](https://gitee.com/dotnetchina/Furion/commit/db7d51bba569001bc363727a6683ab3f31c3fc1d)
  - &nbsp;<Tag>修复</Tag> 动态 `WebAPI` 或控制台贴了 `[ApiDescriptionSettings(Tag = "")]` 标签之后导致注释丢失 [#I5REVF](https://gitee.com/dotnetchina/Furion/issues/I5REVF) [#I5RE4J](https://gitee.com/dotnetchina/Furion/issues/I5RE4J)
  - &nbsp;<Tag>修复</Tag> **启用数据库日志但是没有配置配置文件出现空异常问题** [33817be](https://gitee.com/dotnetchina/Furion/commit/33817bed9d47c85a57c0198c0819ad5cf1c41d0b)
  - &nbsp;<Tag>修复</Tag> **控制台日志过滤无法过滤默认主机日志问题** [33817be](https://gitee.com/dotnetchina/Furion/commit/33817bed9d47c85a57c0198c0819ad5cf1c41d0b)
  - &nbsp;<Tag>修复</Tag> **脚手架错误的日志配置问题** [33817be](https://gitee.com/dotnetchina/Furion/commit/33817bed9d47c85a57c0198c0819ad5cf1c41d0b)
  - &nbsp;<Tag>修复</Tag> **高频压测情况下写日志并设置日志上下文导致并发更新出现 `System.AggregateException` 异常问题** [#I5RFBQ](https://gitee.com/dotnetchina/Furion/issues/I5RFBQ)
  - &nbsp;<Tag>修复</Tag> **日志文件名因 `Windows` 和 `Linux` 路径分隔符不一致导致日志文件创建失败问题，`Linux` 只支持 `/` 不支持 `\`** [#I5RFBQ](https://gitee.com/dotnetchina/Furion/issues/I5RFBQ)
  - &nbsp;<Tag>修复</Tag> `Oops.Oh/Bah` 设置 `.WithData` 之后无效问题 [!580](https://gitee.com/dotnetchina/Furion/pulls/580)
  - &nbsp;<Tag>修复</Tag> 基于 `Redis` 重写事件存储器序列化 `IEventSource` 实例异常问题 <sup>4.4.7</sup> [3e45020](https://gitee.com/dotnetchina/Furion/commit/3e45020eca5948d18d5cb405a665aae44088fd20)
  - &nbsp;<Tag>修复</Tag> 使用 `Log` 静态类超高频率下写日志导致 `CPU` 激增问题 <sup>4.4.7</sup> [#I5SDK5](https://gitee.com/dotnetchina/Furion/issues/I5SDK5)
  - &nbsp;<Tag>修复</Tag> 远程请求超高频率下发送请求导致 `CPU` 激增问题和异常问题 <sup>4.4.8</sup> [#I5SJJR](https://gitee.com/dotnetchina/Furion/issues/I5SJJR)
  - &nbsp;<Tag>修复</Tag> 集成第三方配置中心时获取的不是最新数据问题 <sup>4.4.9</sup> [2cdef6b](https://gitee.com/dotnetchina/Furion/commit/2cdef6bd4274e5ea0328f209c34b9158dcded7ee)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> `JWTEncryption` 静态类，支持无需注册 `services.AddJwt()` 使用 [#I5PPKE](https://gitee.com/dotnetchina/Furion/issues/I5PPKE) [#I5POLZ](https://gitee.com/dotnetchina/Furion/issues/I5POLZ)
  - &nbsp;<Tag>调整</Tag> 事件总线默认日志类名为 `System.Logging.EventBusService` [#I5QLY5](https://gitee.com/dotnetchina/Furion/issues/I5QLY5)

- **文档**

  - &nbsp;<Tag>新增</Tag> `.NET6` 升级 `.NET7` 文档
  - &nbsp;<Tag>新增</Tag> `ASP.NET 7` 集成文档
  - &nbsp;<Tag>新增</Tag> 集成第三方配置中心文档 <sup>4.4.9</sup>
  - &nbsp;<Tag>新增</Tag> 第三方事件总线和 `Furion` 集成文档 <sup>4.4.9</sup>
  - &nbsp;<Tag>新增</Tag> 事件总线集成 `Kafka` 文档 [#I5P5UG](https://gitee.com/dotnetchina/Furion/issues/I5P5UG)
  - &nbsp;<Tag>更新</Tag> 友好异常文档、日志记录文档、远程请求文档、依赖注入文档、即时通讯文档、事件总线文档、Worker Service 文档、单元测试文档、入门指南文档、数据库新增文档

---

## v4.3.9（已发布）

:::important 版本细节

- `v4.3.9` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5PIWD](https://gitee.com/dotnetchina/Furion/issues/I5PIWD) <sup>2022.09.03</sup>
- `v4.3.8` 版本细节：[https://gitee.com/dotnetchina/Furion/issues/I5PCXK](https://gitee.com/dotnetchina/Furion/issues/I5PCXK) <sup>2022.09.02</sup>

:::

- **新特性**

  - &nbsp;<Tag>新增</Tag> `AppSettings` 配置的 `ExcludeAssemblies` 属性，支持忽略指定程序集扫描 [7b7747f](https://gitee.com/dotnetchina/Furion/commit/7b7747f38c84acfe7df3469599bebf417e5ad843)
  - &nbsp;<Tag>新增</Tag> `Oops.Oh` 和 `Oops.Bah` 支持设置额外数据 `.WithData(data)` [#I5O38E](https://gitee.com/dotnetchina/Furion/issues/I5O38E)
  - &nbsp;<Tag>新增</Tag> 定时任务 `Crontab.GetSleepMilliseconds(baseTime)` 获取下一个发生时间的时间差 [d024fae](https://gitee.com/dotnetchina/Furion/commit/d024fae670b7ce3fd4bfd26aee70ed318a4c0383)
  - &nbsp;<Tag>新增</Tag> **友好异常默认打印异常日志，避免生产环境漏掉重要异常信息 [6e3a5bd](https://gitee.com/dotnetchina/Furion/commit/6e3a5bdd0fd22a7f9ae618b7495cd64081a7f2e8)**
  - &nbsp;<Tag>新增</Tag> 日志静态类 `Log.CreateLoggerFactory()` 静态方法 [75c672a](https://gitee.com/dotnetchina/Furion/commit/75c672afc58b393313916c433cb9d92c779b9629)
  - &nbsp;<Tag>新增</Tag> 多语言 `SharedResource` 模式，避免硬编程 [18e80c7](https://gitee.com/dotnetchina/Furion/commit/18e80c7d7c2c2450c6ad429601716f546552e987)
  - &nbsp;<Tag>新增</Tag> **事件总线 `MessageCenter` 静态类，解决从 `Fur v1.x` 版本升级问题 [a29fc7c](https://gitee.com/dotnetchina/Furion/commit/a29fc7cf63a3ea41b1617a6ad98a701a243e24f8)**
  - &nbsp;<Tag>新增</Tag> 组件化 `IWebComponent` 模式，支持 `.NET5+` [08a44c3](https://gitee.com/dotnetchina/Furion/commit/08a44c347a56c467527935a8caac8966585f5d1a)
  - &nbsp;<Tag>新增</Tag> 远程请求设置自己的 `HttpClient` 功能 [#I5PBR3](https://gitee.com/dotnetchina/Furion/issues/I5PBR3) [!545](https://gitee.com/dotnetchina/Furion/pulls/544)
  - &nbsp;<Tag>新增</Tag> `LoggingMonitor` 支持添加更多自定义配置 [#I5PEPA](https://gitee.com/dotnetchina/Furion/issues/I5PEPA)
  - &nbsp;<Tag>新增</Tag> `LoggingMonitor` 可配置 `WithReturnValue` 和 `ReturnValueThreshold` [#I5PFJ1](https://gitee.com/dotnetchina/Furion/issues/I5PFJ1) [#I5PFOW](https://gitee.com/dotnetchina/Furion/issues/I5PFOW)
  - &nbsp;<Tag>新增</Tag> `LoggingMonitor` 可配置 `MethodsSettings` 更多信息 [#I5PFJ1](https://gitee.com/dotnetchina/Furion/issues/I5PFJ1) [#I5PFOW](https://gitee.com/dotnetchina/Furion/issues/I5PFOW)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {2,4,6}
Serve.Run(RunOptions.Default
     .AddWebComponent<XXXWebComponent>());

public class XXXWebComponent : IWebComponent
{
    public void Load(WebApplicationBuilder builder, ComponentContext componentContext)
    {
        // ....
    }
}
```

  </div>
</details>

- **突破性变化**

  - &nbsp;<Tag>新增</Tag> **`Furion` 程序集 `PublicKeyToken` 强签名** [26b12c0](https://gitee.com/dotnetchina/Furion/commit/26b12c0fd64b153a71496eb62110567e05450f20)
  - &nbsp;<Tag>调整</Tag> **事件总线 `IEventBusFactory` 事件工厂方法 `AddSubscriber -> Subscribe`，`RemoveSubscriber -> Unsubscribe` [a29fc7c](https://gitee.com/dotnetchina/Furion/commit/a29fc7cf63a3ea41b1617a6ad98a701a243e24f8)**
  - &nbsp;<Tag>调整</Tag> `.AddInject()` 和 `.UseInject()` 配置选项名称，移除 `Configure` 后缀 [b6953cd](https://gitee.com/dotnetchina/Furion/commit/b6953cd586936593e40ef626c3b8a1e770239e43)
  - &nbsp;<Tag>调整</Tag> **远程请求 `请求拦截`、`响应拦截` 和 `异常拦截` 委托签名，新增 `HttpClient` 参数** [#I5OWBO](https://gitee.com/dotnetchina/Furion/issues/I5OWBO)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {2,7,12}
[Interceptor(InterceptorTypes.Request)]
static void OnRequest(HttpClient client, HttpRequestMessage req)
{
}

[Interceptor(InterceptorTypes.Response)]
static void OnResponsing(HttpClien client, HttpResponseMessage res)
{
}

[Interceptor(InterceptorTypes.Exception)]
static void OnException(HttpClient client, HttpResponseMessage res, string errors)
{
}
```

  </div>
</details>

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 生成包含 `中文` 的 `JWT Token` 解密后出现乱码问题 [#I5O397](https://gitee.com/dotnetchina/Furion/issues/I5O397)
  - &nbsp;<Tag>修复</Tag> `HttpRequestMessage` 拓展中追加查询参数时的空引用异常 [#I5PENW](https://gitee.com/dotnetchina/Furion/issues/I5PENW) [!547](https://gitee.com/dotnetchina/Furion/pulls/547)
  - &nbsp;<Tag>修复</Tag> 日志模块配置多个 `IDatabaseLoggingWriter` 只有一个生效 [#I5PFQ2](https://gitee.com/dotnetchina/Furion/issues/I5PFQ2) [#I5PFJ1](https://gitee.com/dotnetchina/Furion/issues/I5PFJ1)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> 默认输出文件日志模板，使其更加美观 [#1518cf3](https://gitee.com/dotnetchina/Furion/commit/1518cf3be74524ed0d3f73360068a9a0ec6685d9)
  - &nbsp;<Tag>调整</Tag> 默认规范化结果验证处理也支持状态码设置 [2eb9390](https://gitee.com/dotnetchina/Furion/commit/2eb939074a14d29fcd3e4726937c8a8430765f48)
  - &nbsp;<Tag>更新</Tag> `SqlSugarCore` 拓展包和脚手架至 `5.1.2.6` 版本 [#I5PCXK](https://gitee.com/dotnetchina/Furion/issues/I5PCXK)
  - &nbsp;<Tag>更新</Tag> `JSON Schema` 关于 `LoggingMonitor` 更多配置 [#I5PFJ1](https://gitee.com/dotnetchina/Furion/issues/I5PFJ1)

- **文档**

  - &nbsp;<Tag>新增</Tag> `RabbitMQ` 事件总线文档
  - &nbsp;<Tag>更新</Tag> `AppSettings` 配置文档、事件总线文档、多数据库配置文档、日志文档、定时任务文档、`MessageCenter` 文档、远程请求文档、组件化文档、入门指南、多语言文档。

---

## v4.2.13（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> **事件总线工厂，支持运行时动态添加订阅程序和移除订阅程序** [#I5NNQX](https://gitee.com/dotnetchina/Furion/issues/I5NNQX)
  - &nbsp;<Tag>新增</Tag> **事件总线 `[EventSubscribe]` 事件 `Id` 支持正则表达式匹配** [#I5NNQX](https://gitee.com/dotnetchina/Furion/issues/I5NNQX)
  - &nbsp;<Tag>新增</Tag> **事件总线 `[EventSubscribe]` 支持局部失败重试配置** [#I5NNQX](https://gitee.com/dotnetchina/Furion/issues/I5NNQX)
  - &nbsp;<Tag>新增</Tag> **`Log` 全局静态类，方便随时随地记录日志** [ba9b1f1](https://gitee.com/dotnetchina/Furion/commit/ba9b1f13a0b89b6670cf7078ac15abe0eed1f2c3)
  - &nbsp;<Tag>新增</Tag> 事件总线 `options.AddSubscriber(Type)` 重载 [42446078](https://gitee.com/dotnetchina/Furion/blob/424460780b630e1c71de4db84ad8fd14e33a09f5/framework/Furion.Pure/EventBus/Builders/EventBusOptionsBuilder.cs)
  - &nbsp;<Tag>新增</Tag> `ValidationMetadata` 类型 `FirstErrorProperty` 和 `FirstErrorMessage` 属性 [#I5MFJT](https://gitee.com/dotnetchina/Furion/issues/I5MFJT)
  - &nbsp;<Tag>新增</Tag> `Serve.Run()` 模式 `WithArgs(args)` 方法 [#I5MOJB](https://gitee.com/dotnetchina/Furion/issues/I5MOJB)
  - &nbsp;<Tag>新增</Tag> `[UnitOfWork]` 分布式事务 `TransactionScope` 支持 [#I5MRTY](https://gitee.com/dotnetchina/Furion/issues/I5MRTY)
  - &nbsp;<Tag>新增</Tag> 16 位 `MD5` 加密支持 [#I5N8RC](https://gitee.com/dotnetchina/Furion/issues/I5N8RC)

- **突破性变化**

  - &nbsp;<Tag>调整</Tag> `Scoped.Create(async (f,s) => {})` 异步创建作用域方法名称为 `CreateAsync`，避免一些情况下无法区分，**同步方法不变** [#I5N9XY](https://gitee.com/dotnetchina/Furion/issues/I5N9XY)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

由：

```cs showLineNumbers {1-2}
// Scoped.CreateUow 一样
await Scoped.Create(async (f, s) => {});
```

改为：

```cs showLineNumbers {1-2}
// Scoped.CreateUowAsync 一样
await Scoped.CreateAsync(async (f, s) => {});
```

  </div>
</details>

- - &nbsp;<Tag>新增</Tag> `.NET 6.0.8` 和 `.NET 7 Preview 7` [842d4f7](https://gitee.com/dotnetchina/Furion/commit/842d4f739c92366e05fb1d2c619c9b2c2c2c21b7)
- - &nbsp;<Tag>调整</Tag> `[LoggingMonitor]` 命名空间为 `System`，因为使用频率越来越高 [b879861](https://gitee.com/dotnetchina/Furion/commit/b879861c9db5cf3cb0f4ae023d1e96b06fad3e46)
- - &nbsp;<Tag>新增</Tag> **在非 `Web` 环境中不正确使用字符串拓展方法检测机制** [6389cbd](https://gitee.com/dotnetchina/Furion/commit/6389cbdd69f5ca826fad25749a45ede079db98ce)
- - &nbsp;<Tag>调整</Tag> **所有 `.Default` 静态属性为 `.Default()` 方法** [6389cbd](https://gitee.com/dotnetchina/Furion/commit/6389cbdd69f5ca826fad25749a45ede079db98ce)
- - &nbsp;<Tag>调整</Tag> **工作单元 `IUnitOfWork` 所有方法参数类型，由 `ActionExecutingContext` 和 `ActionExecutedContext` 改为 `FilterContext`** [#I5MHX5](https://gitee.com/dotnetchina/Furion/issues/I5MHX5)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {3,5,7,9}
public interface IUnitOfWork
{
    void BeginTransaction(FilterContext context, UnitOfWorkAttribute unitOfWork);

    void CommitTransaction(FilterContext resultContext, UnitOfWorkAttribute unitOfWork);

    void RollbackTransaction(FilterContext resultContext, UnitOfWorkAttribute unitOfWork);

    void OnCompleted(FilterContext context, FilterContext resultContext);
}
```

  </div>
</details>

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 日志上下文数据多次写入被清空问题以及数据库日志出现异常后停止写入 [#I5LIWF](https://gitee.com/dotnetchina/Furion/issues/I5LIWF)
  - &nbsp;<Tag>修复</Tag> 个别情况下跨域默认配置的响应缓存导致嵌入式资源异常问题 [7a57efe](https://gitee.com/dotnetchina/Furion/commit/7a57efe15a9a2d76475d758f2b64395f96d94077)
  - &nbsp;<Tag>修复</Tag> 远程请求传入不合法的请求报文头数据触发校验失败问题 [#I5LPFE](https://gitee.com/dotnetchina/Furion/issues/I5LPFE)
  - &nbsp;<Tag>修复</Tag> 多线程中使用静态日志写数据库日志导致连接池耗光问题 [8d5cdd6](https://gitee.com/dotnetchina/Furion/commit/8d5cdd6ca04d55e33322000ecc176e47195b6f4d)
  - &nbsp;<Tag>修复</Tag> `EFCore 6.0` 之后 `IModelCacheKeyFactory` 接口方法改变导致分表分库异常问题 [#I5MCZ6](https://gitee.com/dotnetchina/Furion/issues/I5MCZ6) [EFCore#25154](https://github.com/dotnet/efcore/issues/25154#issuecomment-868804532) [EFCore!3305](https://github.com/dotnet/EntityFramework.Docs/pull/3305)
  - &nbsp;<Tag>修复</Tag> `ValidationMetadata` 对象 `Message` 字符串类型出现 `\"\"` 问题 [#I5MFJT](https://gitee.com/dotnetchina/Furion/issues/I5MFJT)
  - &nbsp;<Tag>修复</Tag> `[IfException]` 覆盖 `Oops.Oh/Bah` 错误消息问题 [4bbd854](https://gitee.com/dotnetchina/Furion/commit/4bbd854c6779bf7eca26fd69b25c4979b8cec32d)
  - &nbsp;<Tag>修复</Tag> 数据库日志写入循环写入和频繁创建数据库连接池问题 [9ce214c](https://gitee.com/dotnetchina/Furion/commit/9ce214c9cf49eb1ff59f3c52dbecd789be4f45fd)
  - &nbsp;<Tag>修复</Tag> `Razor Pages` 不支持全局异常拦截问题 [#I5MHX5](https://gitee.com/dotnetchina/Furion/issues/I5MHX5)
  - &nbsp;<Tag>修复</Tag> `Razor Pages` 不支持全局数据验证问题 [#I5MHX5](https://gitee.com/dotnetchina/Furion/issues/I5MHX5)
  - &nbsp;<Tag>修复</Tag> `Razor Pages` 不支持工作单元 `[UnitOfWork]` 问题 [#I5MHX5](https://gitee.com/dotnetchina/Furion/issues/I5MHX5)
  - &nbsp;<Tag>修复</Tag> `Razor Pages` 不支持 `EFCore` 自动 `SaveChanges` 问题 [#I5MHX5](https://gitee.com/dotnetchina/Furion/issues/I5MHX5)
  - &nbsp;<Tag>修复</Tag> `Blazor Server` 因 `v4.2.2` 版本更新导致的问题 [#I5MNFN](https://gitee.com/dotnetchina/Furion/issues/I5MNFN)
  - &nbsp;<Tag>修复</Tag> `[IfException]` 不支持多语言配置问题 [#I5MPN7](https://gitee.com/dotnetchina/Furion/issues/I5MPN7)
  - &nbsp;<Tag>修复</Tag> 通过 `services.AddMvcFilter<LoggingMonitorAttribute>()` 方式注册无效问题 [8d1477d](https://gitee.com/dotnetchina/Furion/commit/8d1477d8b44ae111bddb8e4780672bcaf4e0e467)
  - &nbsp;<Tag>修复</Tag> 事件总线默认 `Channel` 管道初始化时机过晚问题，解决部分第三方依赖使用问题 [#I5MM3O](https://gitee.com/dotnetchina/Furion/issues/I5MM3O)
  - &nbsp;<Tag>修复</Tag> 主机停止时写入日志异常问题 [#I5N7S2](https://gitee.com/dotnetchina/Furion/issues/I5N7S2)
  - &nbsp;<Tag>修复</Tag> 数据库上下文手动释放导致 `AutoSaveChange` 特性出现释放异常问题 [#I5NFWC](https://gitee.com/dotnetchina/Furion/issues/I5NFWC)
  - &nbsp;<Tag>修复</Tag> `[LoggingMonitor]` 循环引用序列化问题 [#I5NRT9](https://gitee.com/dotnetchina/Furion/issues/I5NRT9)
  - &nbsp;<Tag>修复</Tag> 远程请求传入 `null` Body 参数抛出空异常问题 [#I5NTUE](https://gitee.com/dotnetchina/Furion/issues/I5NTUE)
  - &nbsp;<Tag>修复</Tag> 事件总线默认开启模糊匹配（正则表达式）导致不必要的订阅 [#I5NVOP](https://gitee.com/dotnetchina/Furion/issues/I5NVOP)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> 事件总线默认 `Channel` 管道初始化时机，解决部分第三方依赖使用问题 [#I5MM3O](https://gitee.com/dotnetchina/Furion/issues/I5MM3O)
  - &nbsp;<Tag>更新</Tag> 底层迭代改进优化
  - &nbsp;<Tag>新增</Tag> 规范化文档获取控制器、方法分组、标签信息 [66d8d54](https://gitee.com/dotnetchina/Furion/commit/66d8d54b225b5294cd54aa76b548312f7c37903a)

- **文档**

  - &nbsp;<Tag>新增</Tag> 全局日志静态类 `Log` 文档 [ba9b1f1](https://gitee.com/dotnetchina/Furion/commit/ba9b1f13a0b89b6670cf7078ac15abe0eed1f2c3)
  - &nbsp;<Tag>新增</Tag> `Nuget` 本地测试包文档
  - &nbsp;<Tag>更新</Tag> 日志文档、静态类文档、数据校验文档、Worker Service 文档、工作单元文档、依赖注入文档

---

## v4.1.14（已发布，全新单元测试）

:::tip 关于单元测试

单元测试和集成测试是保证一个系统能够持续维护和稳定运行的必备技能，但是目前现有的单元测试组件无法直接集成 `Furion` 的功能，最常用的就是如何在单元测试中读取配置，以及**如何进行依赖注入**。

在过去，`Furion` 只能不断的去调整，以至于适配第三方单元测试写法，搞得不伦不类！

所以，这一次不再妥协，**`Furion` 推出自己的单元测试工具，可以让现有的单元测试如 `Xunit` 100% 支持 `Furion` 所有功能，全部保证一致的写法。**

:::

- **新特性**

  - &nbsp;<Tag>新增</Tag> **`Furion.Xunit` 拓展包，正式实现 `Xunit` 单元测试完整支持 `Furion` [063a034e](https://gitee.com/dotnetchina/Furion/commit/063a034edd089e88d501af4c09251611476fd238)**
  - &nbsp;<Tag>新增</Tag> `services.AddMonitorLogging()` 日志监视器服务，支持非常灵活的日志操作 [81df742](https://gitee.com/dotnetchina/Furion/commit/81df742b2784a18fbf4060fe30cc5151909c3cab)
  - &nbsp;<Tag>新增</Tag> **`Serve.Run(silence: true)` 等一系列强大的静默启动功能 [#I5JBSQ](https://gitee.com/dotnetchina/Furion/issues/I5JBSQ) [#I5J98T](https://gitee.com/dotnetchina/Furion/issues/I5J98T) [7cced4](https://gitee.com/dotnetchina/Furion/commit/7cced443ca1cdcb29226c71274e087ec2a6135ef)**
  - &nbsp;<Tag>新增</Tag> `SpecificationDocumentBuilder.GetOpenApiGroups()` 方法获取底层的规范化接口分组信息 [4ff03c5](https://gitee.com/dotnetchina/Furion/commit/4ff03c5f8342c4d9b26fb1336cd78936ab189f5e)
  - &nbsp;<Tag>新增</Tag> `logger.ScopeContext()` 配置日志上下文功能 [#I5JC0D](https://gitee.com/dotnetchina/Furion/issues/I5JC0D)
  - &nbsp;<Tag>新增</Tag> 跨域配置 `CorsAccessorSettings.SignalRSupport` 配置选项，支持配置 `SignalR` 跨域 [#I5JREM](https://gitee.com/dotnetchina/Furion/issues/I5JREM)
  - &nbsp;<Tag>新增</Tag> 事件总线 `UseUtcTimestamp` 选项配置，可选择使用 `DateTime.UtcNow` 还是 `DateTime.Now`，默认是 `DateTime.Now` [#I5JSEU](https://gitee.com/dotnetchina/Furion/issues/I5JSEU)
  - &nbsp;<Tag>新增</Tag> 规范化文档 `[OperationId]` 配置，解决自定义 `Swagger UI` 不能正确显示路由问题 [#I5K1IB](https://gitee.com/dotnetchina/Furion/issues/I5K1IB)
  - &nbsp;<Tag>新增</Tag> 远程请求 `IHttpDispatchProxy` 方式全局拦截支持多态（继承） [#I5K8FS](https://gitee.com/dotnetchina/Furion/issues/I5K8FS)

- **突破性变化**

  - &nbsp;<Tag>新增</Tag> `Furion.Xunit` 拓展包，正式实现 `Xunit` 单元测试完整支持 `Furion` [063a034e](https://gitee.com/dotnetchina/Furion/commit/063a034edd089e88d501af4c09251611476fd238)
  - &nbsp;<Tag>移除</Tag> ~~`Furion.Extras.DatabaseAccessor.SqlSugar` 拓展插件中的 `[SqlSugarUnitOfWork]` 工作单元特性，将使用通用工作单元替换\*\*~~ [查看最新实现文档](./tran.mdx#92631-自动管理)\*\*
  - &nbsp;<Tag>移除</Tag> ~~`Inject.Create()` 方法，再也不需要了，框架提供了无敌强大的 `Serve.Run()` 静默启动方式~~ [200848e](https://gitee.com/dotnetchina/Furion/commit/200848eda8c2e419c0b5be83f7768a257f3c88bd)
  - &nbsp;<Tag>调整</Tag> `Serve.Run` 的 `ConfigureConfiguration` 方法参数，由 `configuration => {}` 改为 `(environment, configuration) => {}` [83c97bb](https://gitee.com/dotnetchina/Furion/commit/83c97bb5a19d6fc4e51cfe05f635675d26067d45)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {2,6}
// 由
Serve.Run(RunOptions.Default.ConfigureConfiguration(configuration => {

}));
// 改为：
Serve.Run(RunOptions.Default.ConfigureConfiguration((environment, configuration) => {

}));
```

  </div>
</details>

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `[LoggingMonitor]` 异常消息日志级别为 `Information` 错误问题 [ab46cdf](https://gitee.com/dotnetchina/Furion/commit/ab46cdf534433f45d39ce4d3ee7c71ca84707140)
  - &nbsp;<Tag>修复</Tag> 新版本日志组件频繁提示文件占用问题，将文件独占锁改为共享锁 [#I5J3S6](https://gitee.com/dotnetchina/Furion/issues/I5J3S6)
  - &nbsp;<Tag>修复</Tag> 配置数据库日志读写器为 `EFCore` 时控制台出现无限打印问题 [#I5J474](https://gitee.com/dotnetchina/Furion/issues/I5J474)
  - &nbsp;<Tag>修复</Tag> `[LoggingMonitor]` 针对 `byte[]` 类型参数输出过大问题 [5380f35](https://gitee.com/dotnetchina/Furion/commit/5380f3551de69f8607ca0fc33c950103c7ed8174)
  - &nbsp;<Tag>修复</Tag> 友好异常和规范化结果丢失了原始 `ErrorCode` 问题 [#I5IX2R](https://gitee.com/dotnetchina/Furion/issues/I5IX2R)
  - &nbsp;<Tag>修复</Tag> 新版本日志组件自定义数据库读写器注入 `IRepository` 仓储导致死循环问题 [#I5IX2R](https://gitee.com/dotnetchina/Furion/issues/I5IX2R)
  - &nbsp;<Tag>修复</Tag> `Mvc` 默认手动验证和 `Furion` 全局验证冲突问题 [2a06c39](https://gitee.com/dotnetchina/Furion/commit/2a06c39c1d0a032bbc317e25a22c646babce2a60)
  - &nbsp;<Tag>修复</Tag> `Serve.Run()` 模式不支持 `SuperSocket` 第三方包问题，原生是支持的。[186ca0a](https://gitee.com/dotnetchina/Furion/commit/186ca0a35d696f58d9e696094848a560074cdf6f)
  - &nbsp;<Tag>修复</Tag> `SignalR` 跨域错误问题 [#I5JREM](https://gitee.com/dotnetchina/Furion/issues/I5JREM)
  - &nbsp;<Tag>修复</Tag> `[LoggingMonitor]` 将 `Oops.Oh` 和 `Oops.Bah` 记录到了错误日志中，默认应该是 `Information` 且提供可配置 [#I5JZ1H](https://gitee.com/dotnetchina/Furion/issues/I5JZ1H)
  - &nbsp;<Tag>修复</Tag> 自定义 `Swagger UI` 之后个别 `UI` 要求必须配置 `operationId`，否则出现 `guid` 序号 [#I5K1IB](https://gitee.com/dotnetchina/Furion/issues/I5K1IB)
  - &nbsp;<Tag>修复</Tag> 主动抛出 `NotFoundResult` 和 `NotFoundObjectResult` 无效问题 [#I5KALZ](https://gitee.com/dotnetchina/Furion/issues/I5KALZ)
  - &nbsp;<Tag>修复</Tag> `[LoggingMonitor]` 解析方法参数但前端未传入时出现错误问题 [#I5KC5P](https://gitee.com/dotnetchina/Furion/issues/I5KC5P)
  - &nbsp;<Tag>修复</Tag> `[LoggingMonitor]` 无法序列化 `IQueryable` 返回值问题 [#I5KJD1](https://gitee.com/dotnetchina/Furion/issues/I5KJD1)
  - &nbsp;<Tag>修复</Tag> `[LoggingMonitor]` 不能记录全局验证错误问题 [b44087d](https://gitee.com/dotnetchina/Furion/commit/b44087dcc7dbe9992b8f4518e0b0cf4ed61c56bb)
  - &nbsp;<Tag>修复</Tag> `[LoggingMonitor]` 存在注册顺序差异问题 [b44087d](https://gitee.com/dotnetchina/Furion/commit/b44087dcc7dbe9992b8f4518e0b0cf4ed61c56bb)

- **其他更改**

  - &nbsp;<Tag>新增</Tag> 底层的规范化文档 `SpecificationDocumentBuilder` 部分方法，提供更加便捷的第三方 `Swagger UI` 集成 [10f0f01](https://gitee.com/dotnetchina/Furion/commit/10f0f01996586eedb138304c7b00c6f31282dfeb)

- **文档**

  - &nbsp;<Tag>更新</Tag> 单元测试文档、入门指南文档、Worker Services 文档

- **本期亮点**

1. `Serve.Run()` 彻彻底底支持全平台，提供非常强大的静默模式

**启用静默模式可以实现无阻塞方式执行程序，而且还能体验完整的 `Furion` 功能。**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

:::tip 大革命

有了 `Serve.Run()` 静默模式后，`Furion` 彻彻底底支持全平台，不管你是 `控制台、Web、桌面、移动、单元测试，集成测试，基准测试等等应用程序`。

:::

```cs showLineNumbers {1,3}
Serve.Run(silence: true);

// 不会阻塞执行哦，而且从这里开始可以使用 Furion 任何功能，比如 App.Configuration....
Console.WriteLine("Hello, World!");
Console.ReadKey();
```

还有更多静默模式。

```cs showLineNumbers {2,5,8}
// RunOptions 方式
Serve.Run(RunOptions.DefaultSilence);

// LegacyRunOptions 方式
Serve.Run(LegacyRunOptions.DefaultSilence);

// GenericRunOptions 方式
Serve.Run(GenericRunOptions.DefaultSilence);
```

  </div>
</details>

2. 强大的 `Furion.Xunit` 单元测试、集成测试

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

单元测试中初始化 `Furion`

```cs showLineNumbers {6,13,18}
using Furion.Xunit;
using Xunit.Abstractions;
using Xunit.Sdk;

// 配置启动类类型，第一个参数是 TestProgram 类完整限定名，第二个参数是当前项目程序集名称
[assembly: TestFramework("TestProject1.TestProgram", "TestProject1")]

namespace TestProject1;

/// <summary>
/// 单元测试启动类
/// </summary>
public class TestProgram : TestStartup
{
    public TestProgram(IMessageSink messageSink) : base(messageSink)
    {
        // 初始化 Furion
        Serve.Run(silence: true);
    }
}
```

**测试类支持完整依赖注入**

```cs showLineNumbers {9,15}
using TestProject1.Services;
using Xunit;

namespace TestProject1;

public class UnitTest1
{
    private readonly ICalcService _calcService;
    public UnitTest1(ICalcService calcService)
    {
        _calcService = calcService;
    }

    [Fact]
    public void 测试两个数的和()
    {
        Assert.Equal(3, _calcService.Plus(1, 2));
    }
}
```

<img src={useBaseUrl("img/ut9.png")} />

**[查看新版本单元测试文档](./unittest.mdx)**

  </div>
</details>

3. 开放底层规范化文档分组接口，使得集成第三方 `Swagger UI` 更加容易，如集成 `IGeekFan.AspNetCore.Knife4jUI` 拓展：

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

:::note 安装包

只需要在 `YourPoject.Web.Core` 层安装 `IGeekFan.AspNetCore.Knife4jUI` 即可。

:::

3.1.1 **`Knife4jUI` 独立版本配置**

```cs showLineNumbers {1,3,12}
var routePrefix = "api";    // 定义 swagger 路由地址，如果是跟目录，设置 string.Empty 即可

app.UseKnife4UI(options =>
{
    options.RoutePrefix = routePrefix;  // 配置 Knife4UI 路由地址
    foreach (var groupInfo in SpecificationDocumentBuilder.GetOpenApiGroups())
    {
        options.SwaggerEndpoint("/" + groupInfo.RouteTemplate, groupInfo.Title);
    }
});

app.UseInject(routePrefix); // 配置 Furion 路由地址
```

3.1.2 **`Knife4jUI` 和 `Swagger` 共存版本配置**

```cs showLineNumbers {1,3,10}
app.UseKnife4UI(options =>
{
    options.RoutePrefix = "newapi";  // 配置 Knife4UI 路由地址，现在是 /newapi
    foreach (var groupInfo in SpecificationDocumentBuilder.GetOpenApiGroups())
    {
        options.SwaggerEndpoint("/" + groupInfo.RouteTemplate, groupInfo.Title);
    }
});

app.UseInject();  // Furion 默认 api 地址为  /api
```

<img src={useBaseUrl("img/sg20.png")} />

**如需实现登录之后自动将 `token` 添加到头部可在登录接口 `AfterScript` 执行以下代码：**

```js
ke.global.setAllHeader(
  "Authorization",
  "Bearer " + ke.response.headers["access-token"]
);
```

<img src={useBaseUrl("img/kni.jpg")} />

4. 提供强大的日志上下文功能

```cs showLineNumbers {2,6,12}
// 写法一
_logger.ScopeContext(ctx => ctx.Set("Name", "Furion").Set("UserId", 10))
       .LogInformation("我是一个日志 {id}", 20);

// 写法二
_logger.ScopeContext(new Dictionary<object, object> {
    { "Name", "Furion" },
    { "UserId", 10 }
}).LogInformation("我是一个日志 {id}", 20);

// 写法三
_logger.ScopeContext(new LogContext {
    // ....
}).LogInformation("我是一个日志 {id}", 20)
```

  </div>
</details>

---

## v4.0.0（重新起航）💖

:::tip 不忘初心，感恩遇见，感恩信任

2020 年 09 月 01 日，一个叫 `Fur` 的开源项目在 `Gitee` 的襁褓中悄然诞生，她的出生仿佛带着某种使命，没有包袱，无限可能。

她缓缓的张开双眼，干净雪亮的眼睛似乎对这个世界充满了好奇，任何事物在她眼前晃过都像是直击灵魂的思想碰撞，这些在她看来都是非常宝贵的财富。她貌似有用不完的精力，一路汲取知识，升级打怪，不断奔跑，乐此不疲。

记得 2020 年 11 月 11 日的单身节，她迎来了“一岁（v1.0.0）”生日，自那以后，IT 这个大银幕上频繁出现她的身影，越来越多 `.NET5` 开发者转粉，像是告诉这个世界，她就是 IT 界大明星。

每一个明星都有一个好听的艺名，她当然也不例外，2020 年 11 月 20 日，经纪人百小僧为她起名为 `Furion`。

2021 年 11 月 09 日起，她进入了每个孩子都经历过的叛逆期，年少轻狂喜新厌旧，抛弃了曾经支持她的 `.NET5` 粉丝们，投入到新的 `.NET6` 拥趸者怀抱中，自此过上了奢靡富足的生活。

但她过的不开心，时常在夜里想起 `.NET5` 的粉丝们，内心非常自责，但在双重工作压力下她毅然选择了忽视他们的诉求，仿佛他们就是累赘。

时间真的是好东西，曾经认为是对的，经过岁月的蹉跎历磨，渐渐的明白：不忘初心，方能始终。

这一次，不落下一人（`.NET5`，`.NET6`，...，`.NET N`），携手共进，重新起航，感恩遇见，感恩信任。

:::

- **新特性**

  - **`v4.0.0` 支持 `.NET5`，`.NET6`，...，`.NET N`，所有的 `Furion` 项目都能够升级到该版本，重新起航，实现大统。**

---

## v3.9.2（已发布，全新日志组件）

:::tip 关于日志

日志模块是任何应用系统都必备的功能，可以说是最重要的模块！在 `.NET` 社区中有 `Log4NET`，`NLog`，`Serilog` 等日志组件，它们无一不是优秀的开源项目。

但由于这些日志组件历史悠久，内部兼容的 `.NET` 版本非常多，功能随着时间推移变得极其强大复杂，**在实际项目使用中，发现每一个日志组件配置总是不那么友好，特别是在使用上不够简单**。

`Furion` 作为全栈开发框架，**在过去版本并没有提供足以满足开发者需求的日志模块**，转而推荐大家集成第三方组件，如 `Serilog`，**导致后续无法实现自定义功能和也增加了不少维护成本。**

**这一次，`Furion` 不再妥协，彻底重构了日志模块，实现日志功能/需求完全自主可控，提供给开发者几乎所有日志功能的需求！**

`Furion` 的使用者们，**是时候“更换”掉第三方日志组件，让我们一起迭代出更强更好的日志组件吧！** 🍖

:::

- **新特性**

  - &nbsp;<Tag>优化</Tag> 日志模块，内置写入控制台、文件、数据库功能，再也无需引入第三方日志了！[日志源码](https://gitee.com/dotnetchina/Furion/tree/v4/framework/Furion/Logging)
  - &nbsp;<Tag>新增</Tag> **强大的调试日志 `[LoggingMonitor]` [32dfc1](https://gitee.com/dotnetchina/Furion/commit/32dfc11fd6b47551a81c09e676eb7f5d018ef737)**

- **突破性变化**

  - &nbsp;<Tag>优化</Tag> **日志模块，内置写入控制台、文件、数据库功能，再也无需引入第三方日志了！[日志源码](https://gitee.com/dotnetchina/Furion/tree/v4/framework/Furion/Logging)**
  - &nbsp;<Tag>调整</Tag> **`TP.Wrapper` 规范化日志模板算法，由过去的 `[属性]` 改为 `##属性##`，解决 `JSON` 内容冲突问题 [394ecec](https://gitee.com/dotnetchina/Furion/commit/394ecec28629aee9945480155d502418d0b7a8f8)**
  - &nbsp;<Tag>移除</Tag> ~~**未来 `Furion.Extras.Logging.Serilog` 拓展将不再继续维护，因为 `Furion` 有强大的日志组件了！**~~

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 修复脱敏模块模型绑定个别情况下空异常问题 [#I5IM5C](https://gitee.com/dotnetchina/Furion/issues/I5IM5C)

- **文档**

  - &nbsp;<Tag>更新</Tag> 日志文档、静态类文档、数据校验文档

- **本期亮点**

1. **极易使用且强大的日志模块**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers
// 写入文件
services.AddFileLogging("logs/application.log");

// 写入数据库
services.AddDatabaseLogging<DatabaseLoggingWriter>();
```

**[查看更多日志文档](./logging.mdx)**

  </div>
</details>

2. **强大的 `[LoggingMonitor]` 调试日志**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {1,7}
using Furion.Logging;

namespace Furion.Application;

public class TestLoggerServices : IDynamicApiController
{
    [LoggingMonitor]
    public PersonDto GetPerson(int id)
    {
        return new PersonDto
        {
            Id = id
        };
    }
}
```

**支持控制器、操作或全局注册拦截**。

输出日志为：

```bash showLineNumbers
┏━━━━━━━━━━━  Logging Monitor ━━━━━━━━━━━
┣ Furion.Application.TestLoggerServices.GetPerson (Furion.Application)
┣
┣ 控制器名称：              TestLoggerServices
┣ 操作名称：                GetPerson
┣ 路由信息：                [area]: ; [controller]: test-logger; [action]: person
┣ 请求地址：                https://localhost:44316/api/test-logger/person/11
┣ 来源地址：                https://localhost:44316/api/index.html
┣ 浏览器标识：              Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.114 Safari/537.36 Edg/103.0.1264.62
┣ 客户端 IP 地址：          0.0.0.1
┣ 服务端 IP 地址：          0.0.0.1
┣ 服务端运行环境：          Development
┣ 执行耗时：                31ms
┣ ━━━━━━━━━━━━━━━  授权信息 ━━━━━━━━━━━━━━━
┣ JWT Token：               Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySWQiOjEsIkFjY291bnQiOiJhZG1pbiIsImlhdCI6MTY1ODcxNjc5NywibmJmIjoxNjU4NzE2Nzk3LCJleHAiOjE2NTg3MTc5OTcsImlzcyI6ImRvdG5ldGNoaW5hIiwiYXVkIjoicG93ZXJieSBGdXJpb24ifQ.VYZkwwqCwlUy3aJjuL-og62I0rkxNQ96kSjEm3VgXtg
┣
┣ UserId (integer)：        1
┣ Account (string)：        admin
┣ iat (integer)：           1658716797
┣ nbf (integer)：           1658716797
┣ exp (integer)：           1658717997
┣ iss (string)：            dotnetchina
┣ aud (string)：            powerby Furion
┣ ━━━━━━━━━━━━━━━  参数列表 ━━━━━━━━━━━━━━━
┣ Content-Type：
┣
┣ id (Int32)：              11
┣ ━━━━━━━━━━━━━━━  返回信息 ━━━━━━━━━━━━━━━
┣ 类型：                    Furion.Application.Persons.PersonDto
┣ 返回值：                  {"Id":11,"Name":null,"Age":0,"Address":null,"PhoneNumber":null,"QQ":null,"CreatedTime":"0001-01-01T00:00:00+00:00","Childrens":null,"Posts":null}
┗━━━━━━━━━━━  Logging Monitor ━━━━━━━━━━━
```

  </div>
</details>

---

## v3.8.9（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 规范化结果 `ExceptionMetadata` 和 `ValidationMetadata` 都可以获取 `ErrorCode` 属性 [#I5GJ6D](https://gitee.com/dotnetchina/Furion/issues/I5GJ6D)
  - &nbsp;<Tag>新增</Tag> `ValidationMetadata` 类 `StatusCode` 属性 [#I5HB5L](https://gitee.com/dotnetchina/Furion/issues/I5HB5L)
  - &nbsp;<Tag>新增</Tag> 远程请求对 `Url` 是否编码设置，`[Get(WithEncodeUrl = false)]` 和 `WithEncodeUrl(false)` [#I5GOBC](https://gitee.com/dotnetchina/Furion/issues/I5GOBC)
  - &nbsp;<Tag>新增</Tag> 更强大的 `JWTEncryption.SecurityReadJwtToken('token')` 读取解析 `Token` 静态方法 [574eeb6](https://gitee.com/dotnetchina/Furion/commit/574eeb601294378e68c3d57ceaf6cb17f36636e3)
  - &nbsp;<Tag>新增</Tag> `ValiationTypes.Html` 验证 `Html` 标签 [#I5HBKC](https://gitee.com/dotnetchina/Furion/issues/I5HBKC)
  - &nbsp;<Tag>新增</Tag> **[EFCore.NamingConventions](https://github.com/efcore/EFCore.NamingConventions) 支持，可自定义生成表名，字段名风格，比如小驼峰，蛇形命名等 [#I5HBEI](https://gitee.com/dotnetchina/Furion/issues/I5HBEI)**
  - &nbsp;<Tag>新增</Tag> `INamedServiceProvider` 命名服务提供器，可解析接口多实现 [#I5HF98](https://gitee.com/dotnetchina/Furion/issues/I5HF98)
  - &nbsp;<Tag>新增</Tag> 脱敏处理模块方法参数单个值处理 [a22ec3c](https://gitee.com/dotnetchina/Furion/commit/a22ec3cc3565582eea67052936e788ede8c633cb)
  - &nbsp;<Tag>新增</Tag> 脱敏词库支持 `|` 分割词语 [3106b1d](https://gitee.com/dotnetchina/Furion/commit/3106b1d78b27b24f4141f052bf804a201a268ff7)

- **突破性变化**

  - &nbsp;<Tag>升级</Tag> 所有 `.NET` 依赖包至 `6.0.7` 版本
  - &nbsp;<Tag>升级</Tag> `Serilog.AspNetCore` 包至 `6.0.0` 版本
  - &nbsp;<Tag>优化</Tag> `JWT` `Token` 刷新逻辑 [#I5GXML](https://gitee.com/dotnetchina/Furion/issues/I5GXML) [574eeb6](https://gitee.com/dotnetchina/Furion/commit/574eeb601294378e68c3d57ceaf6cb17f36636e3)
  - &nbsp;<Tag>调整</Tag> **`ExceptionMetadata` 命名空间为 `Furion.FriendlyException`** [3105d16](https://gitee.com/dotnetchina/Furion/commit/3105d168db10bfbe6e83fff2e435ba5d9ef62ed5)
  - &nbsp;<Tag>调整</Tag> `Retry.Invoke(Func<Task>...)` 为：`Retry.InvokeAsync(Func<Task>...)` [3b78999](https://gitee.com/dotnetchina/Furion/commit/3b7899942bb37423c2c4ed313069fe361aabf682)
  - &nbsp;<Tag>优化</Tag> 脱敏处理模块，大大提高性能和准确率，同时支持方法参数单个值处理 [a22ec3c](https://gitee.com/dotnetchina/Furion/commit/a22ec3cc3565582eea67052936e788ede8c633cb)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `Rider` 开发工具对同名脚手架 (`EFCore` 和 `SqlSugar`) 只显示一个问题 [!518](https://gitee.com/dotnetchina/Furion/pulls/518)
  - &nbsp;<Tag>修复</Tag> `UnitOfWork` 工作单元在 `EFCore` 中失效问题 [#I5H0T3](https://gitee.com/dotnetchina/Furion/issues/I5H0T3)
  - &nbsp;<Tag>修复</Tag> `JWT` 中 `Token` 如果存在数组类型的值时，刷新 `Token` 后丢失了历史值 [#I5GXML](https://gitee.com/dotnetchina/Furion/issues/I5GXML)
  - &nbsp;<Tag>修复</Tag> 远程请求 `WithEncodeUrl` 无法在 `[HttpMethod]` 设置问题 [574eeb6](https://gitee.com/dotnetchina/Furion/commit/574eeb601294378e68c3d57ceaf6cb17f36636e3)
  - &nbsp;<Tag>修复</Tag> `Serve.Run()` 模式下添加自定义配置导致 `EFCore` 无法获取自定义配置文件问题 [#I5GZ0F](https://gitee.com/dotnetchina/Furion/issues/I5GZ0F)
  - &nbsp;<Tag>修复</Tag> `Oops.Bah` 进入全局异常拦截器问题 [#I5H47S](https://gitee.com/dotnetchina/Furion/issues/I5H47S)
  - &nbsp;<Tag>修复</Tag> `AddDbPool/AddDb` 扩展未根据配置 `Key` 路径读取问题 [#I5H6S4](https://gitee.com/dotnetchina/Furion/issues/I5H6S4) [!520](https://gitee.com/dotnetchina/Furion/pulls/520)
  - &nbsp;<Tag>修复</Tag> `ValiationTypes.Url` 正则表达式覆盖不全问题 [#I5HBKC](https://gitee.com/dotnetchina/Furion/issues/I5HBKC)
  - &nbsp;<Tag>修复</Tag> **`v3.5.x` 版本导致集成 [EFCore.NamingConventions](https://github.com/efcore/EFCore.NamingConventions) 失效问题 [#I5HBEI](https://gitee.com/dotnetchina/Furion/issues/I5HBEI)**
  - &nbsp;<Tag>修复</Tag> `Swagger` 长路由不支持问题以及 `[Required]` 配置 `AllowEmptyStrings` 无效问题 [c014330](https://gitee.com/dotnetchina/Furion/commit/c0143300329b5a96a2fbd4d92de109f520674d33)
  - &nbsp;<Tag>修复</Tag> 远程请求上传文件时请求报文 `boundary` 和 `Content-Disposition` 设置不正确问题 [#I5HEF0](https://gitee.com/dotnetchina/Furion/issues/I5HEF0)
  - &nbsp;<Tag>修复</Tag> 脱敏模块替换敏感词汇出现多替换问题 [a22ec3c](https://gitee.com/dotnetchina/Furion/commit/a22ec3cc3565582eea67052936e788ede8c633cb)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> 多语言默认处理逻辑，**允许不配置任何语言**，过去版本会报错 [#I5GRD9](https://gitee.com/dotnetchina/Furion/issues/I5GRD9) [5077c5d](https://gitee.com/dotnetchina/Furion/commit/5077c5dab9ee94733817f55ff8224b853d0001a3)
  - &nbsp;<Tag>更新</Tag> 规范化文档 `Swagger` 性能
  - &nbsp;<Tag>调整</Tag> 调整 `MongoDB` 仓储 `TDocument` 泛型约束 [3f49055](https://gitee.com/dotnetchina/Furion/commit/3f49055b6b80ef7861f58b0c6feabf5c87a32010)

- **文档**

  - &nbsp;<Tag>更新</Tag> 远程请求文档，日志记录文档、多数据库文档、PM2 部署文档、Visual Studio 高效率文档

---

## v3.7.11（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> **`Minimal API` 应用支持：`.AddInjectMini()` [#I4KOQ5](https://gitee.com/dotnetchina/Furion/issues/I4KOQ5)**
  - &nbsp;<Tag>新增</Tag> 跨域 `WithExposedHeaders` 默认配置 `access-token` 和 `x-access-token` [42ebdfd](https://gitee.com/dotnetchina/Furion/commit/42ebdfd33a01353a0b3a801528de052990d2e4c9)
  - &nbsp;<Tag>新增</Tag> 脚手架默认启用 `app.UseHttpLogging()` `HTTP` 日志 [42ebdfd](https://gitee.com/dotnetchina/Furion/commit/42ebdfd33a01353a0b3a801528de052990d2e4c9)
  - &nbsp;<Tag>新增</Tag> **`Furion` 和 `ASP.NET Core` 完整 `json` 配置的 `JSON Schema` 架构 [JSON Schema](https://gitee.com/dotnetchina/Furion/raw/v4/schemas/v4/furion-schema.json)**
  - &nbsp;<Tag>新增</Tag> `Sql` 代理支持返回单个类类型参数 [1d7fb5b](https://gitee.com/dotnetchina/Furion/commit/1d7fb5b5330c5a30098056818a93a0879034fecd)
  - &nbsp;<Tag>新增</Tag> `Sql` 代理支持返回 `ValueTuple` 单个类类型参数 [876a2f5](https://gitee.com/dotnetchina/Furion/commit/876a2f5f7e2d07fa3bbc3f5b99c0653893e0ada8)
  - &nbsp;<Tag>新增</Tag> 组件化设计模块，支持比 `AppStartup` 更灵活便捷的设计 [#components](https://gitee.com/dotnetchina/Furion/tree/v4/framework/Furion/Components)
  - &nbsp;<Tag>新增</Tag> 独立工作单元模块，支持任何第三方 `ORM` [a02413d](https://gitee.com/dotnetchina/Furion/commit/a02413d6887d258ad3a1ba972bb6a08d29291d0c)
  - &nbsp;<Tag>新增</Tag> 跨域 `FixedClientToken` 配置参数 [bd01638](https://gitee.com/dotnetchina/Furion/commit/bd016386681631a5539bcf215c068c2069bba15f)
  - &nbsp;<Tag>新增</Tag> `throw Oops.Bah` 可以手动触发规范化验证失败处理 [83f0036](https://gitee.com/dotnetchina/Furion/commit/83f0036a4ce10c6b1cfc4a258dc61e197af38879)
  - &nbsp;<Tag>新增</Tag> `FriendlyExceptionSettings` 的 `ThrowBah` 配置，可标记 `Oops.Oh` 不进入异常处理 [76ffa7f](https://gitee.com/dotnetchina/Furion/commit/76ffa7f18d3683ad36e37e5fc90cf54a4b04e520)

- **突破性变化**

  - &nbsp;<Tag>新增</Tag> **`Minimal API` 应用支持：`.AddInjectMini()` [#I4KOQ5](https://gitee.com/dotnetchina/Furion/issues/I4KOQ5)**
  - &nbsp;<Tag>新增</Tag> **`Furion` 和 `ASP.NET Core` 完整 `json` 配置的 `JSON Schema` 架构 [JSON Schema](https://gitee.com/dotnetchina/Furion/raw/v4/schemas/v4/furion-schema.json)**
  - &nbsp;<Tag>新增</Tag> 组件化设计模块，支持比 `AppStartup` 更灵活便捷的设计 [#components](https://gitee.com/dotnetchina/Furion/tree/v4/framework/Furion/Components)
  - &nbsp;<Tag>新增</Tag> 独立工作单元单元模块，支持任何第三方 `ORM` [a02413d](https://gitee.com/dotnetchina/Furion/commit/a02413d6887d258ad3a1ba972bb6a08d29291d0c)
  - &nbsp;<Tag>优化</Tag> `DataValidationFilter` 和 `FriendlyExceptionFilter`，解决不支持手动抛出业务异常问题 [83f0036](https://gitee.com/dotnetchina/Furion/commit/83f0036a4ce10c6b1cfc4a258dc61e197af38879)
  - &nbsp;<Tag>调整</Tag> **`.AddDb<>` 和 `.AddDbPool<>` 自定义委托参数签名，由 `Action<DbContextOptionsBuilder>` 改为：`Action<IServiceProvider, DbContextOptionsBuilder>`**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {2,5}
// 由：
options.AddDbPool<TDbContext>(DbProvider.MySql, opt => {
});
// 改为
options.AddDbPool<TDbContext>(DbProvider.MySql, (services, opt)=> {
})
```

  </div>
</details>

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 自 `v3.6.3` 版本依赖，执行原生 `Sql` 添加了参数校验导致存储过程执行错误问题 [#I5ERMQ](https://gitee.com/dotnetchina/Furion/issues/I5ERMQ)
  - &nbsp;<Tag>修复</Tag> `tools/cli.ps1` 脚本工具出现数据库链接被占用问题
  - &nbsp;<Tag>修复</Tag> `JWTSettings` 算法配置 `JSON Schema` 错误问题，感谢 [@gitwentao](https://gitee.com/gitwentao) [#I5G27B](https://gitee.com/dotnetchina/Furion/issues/I5G27B) [!516](https://gitee.com/dotnetchina/Furion/pulls/516)
  - &nbsp;<Tag>修复</Tag> 基于策略授权在不配置 `Policy` 的情况下出现空异常问题 [#I5EVF2](https://gitee.com/dotnetchina/Furion/issues/I5EVF2)
  - &nbsp;<Tag>修复</Tag> 启用数据库实体跟踪时导致新增实体多次查询数据库问题 [#I4J2LZ](https://gitee.com/dotnetchina/Furion/issues/I4J2LZ)
  - &nbsp;<Tag>修复</Tag> 不启用规范化结果导致验证失效，异常失效问题 [cdb3f57](https://gitee.com/dotnetchina/Furion/commit/cdb3f570ab72cff0a5327a717f85c48e153211be)
  - &nbsp;<Tag>修复</Tag> 验证异常和友好异常冲突问题 [83f0036](https://gitee.com/dotnetchina/Furion/commit/83f0036a4ce10c6b1cfc4a258dc61e197af38879)
  - &nbsp;<Tag>修复</Tag> `CentOS 7.9` 系统部署无法指定命令 `--urls` 参数问题 [8cc8ee](https://gitee.com/dotnetchina/Furion/commit/8cc8eeff6b5b25de42367884b7c91d419557d054)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> 脚手架所有 `.json` 文件，默认添加 `JSON Schema` 支持

- **文档**

  - &nbsp;<Tag>新增</Tag> 组件化启动文档
  - &nbsp;<Tag>新增</Tag> `Vue/React/Angular` 请求代理文档
  - &nbsp;<Tag>新增</Tag> `JSON Schema` 文档，支持配置智能提示和验证
  - &nbsp;<Tag>更新</Tag> 跨域文档、规范化文档、配置文档、日志文档、IIS 部署文档

- **本期亮点**

1. **新增 `JSON Schema` 支持，所有 `.json` 文件支持智能提示和验证**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```json showLineNumbers {2}
{
  "$schema": "https://gitee.com/dotnetchina/Furion/raw/v4/schemas/v4/furion-schema.json",

  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information",
      "Microsoft.EntityFrameworkCore": "Information"
    }
  },
  "AllowedHosts": "*"
}
```

<img src={useBaseUrl("img/js1.png")} />

**[查看更多 `JSON Schema` 文档](./jsonschema)**

  </div>
</details>

2. **根据 `Swagger` 生成 `Vue/React/Angular` 前端请求代码**

**[查看文档](./clientapi)**

3. **`Sql` 代理支持返回单个类类型参数**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {7-9}
public interface ISql : ISqlDispatchProxy
{
    // 集合类型
    [SqlExecute("select * from person")]
    List<Person> GetPersons();

    // 自 v3.7.3+ 版本支持返回单个类类型参数
    [SqlExecute("select * from person where id=@id")]
    Person GetPerson(int id);
}
```

  </div>
</details>

4. **`Sql` 代理支持返回 `ValueTuple` 单个类类型参数**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {3-6}
public interface ISql : ISqlDispatchProxy
{
    [SqlExecute(@"
            select * from person where id =@id;
            select * from person")]
    (Person, List<Person>) GetData(int id); // 注意返回值是 `(Person, List<Person>)` 组合
}
```

  </div>
</details>

5. **支持 `Minimal API` 应用**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

**[了解 `Minimal API` 应用](https://docs.microsoft.com/zh-cn/aspnet/core/fundamentals/minimal-apis?view=aspnetcore-6.0)**

```cs showLineNumbers {1,3-4,10,12-15}
var builder = WebApplication.CreateBuilder(args).Inject();

// 注册 Minimal 服务
builder.Services.AddInjectMini();

var app = builder.Build();

app.UseHttpsRedirection();

app.UseInject(string.Empty);

app.MapGet("/hello", () =>
{
    return "Hello, Furion";
});

app.Run();
```

  </div>
</details>

---

## v3.6.9（已发布，全新入口组件）

:::tip 关于入口组件

相信从 `ASP.NET 5` 升级至 `ASP.NET 6` 的开发者都经历过微软多次变更初始化主机 `Program.cs` 和 `Startup.cs` 写法，甚至在 `.NET6+` 之后移除了 `Startup.cs` 的设计。

试问，`ASP.NET 7`，`ASP.NET 8` ... `ASP.NET N` 呢？会不会每一个版本都有不同的初始化方式，那后续项目如何无缝升级？

**所以，为了保证一致的代码体验和后续无缝升级，创造出了 `Serve.Run()`，即使未来创建方式变了，也不用担心，交给框架即可。**

`Serve.Run` 模式也标记着 `Furion` 进入全新的极简入门时代。

:::

- **新特性**

  - &nbsp;<Tag>新增</Tag> `Serve.Run()` 极简主机模式，真正实现极速入门。[95cac5b](https://gitee.com/dotnetchina/Furion/commit/95cac5b391b70d73bfc94147ee40eef529b2eec6)
  - &nbsp;<Tag>新增</Tag> `TP.Wrapper(...)` 拓展方法，主要用来生成规范化的日志模板 [427999a](https://gitee.com/dotnetchina/Furion/commit/427999aba4847522ea91c42df6164e5fe69c5bc0)
  - &nbsp;<Tag>新增</Tag> 项目类型为 `<Project Sdk="Microsoft.NET.Sdk">` 的控制台项目 [fb08a65](https://gitee.com/dotnetchina/Furion/commit/fb08a6548d49921aa143d01389a2592b92e94e31)
  - &nbsp;<Tag>新增</Tag> `BadPageResult` 错误页面类型 [!494](https://gitee.com/dotnetchina/Furion/pulls/494)
  - &nbsp;<Tag>新增</Tag> `[SchemaId]` 特性，解决不同程序集相同的类名生成 `Swagger` 的 `SchemaId` 冲突问题 [#I5D3CU](https://gitee.com/dotnetchina/Furion/issues/I5D3CU)
  - &nbsp;<Tag>新增</Tag> 远程请求 `options.ApproveAllCerts()` 忽略所有客户端证书拓展 [eb7d18a](https://gitee.com/dotnetchina/Furion/commit/eb7d18ac183894d604cec1d4c8527466ef9c648a)
  - &nbsp;<Tag>新增</Tag> 判断是否是单文件环境部署静态属性 `App.SingleFileEnvironment` [de556f0](https://gitee.com/dotnetchina/Furion/commit/de556f0aaf87c41fe01cca2655f086890b2638a0)
  - &nbsp;<Tag>新增</Tag> `WebApplicationBuilder.UseSerilogDefault()` 拓展 [e02524c](https://gitee.com/dotnetchina/Furion/commit/e02524c8a15fd660b6359285ef07a697878e6678)

- **突破性变化**

  - &nbsp;<Tag>新增</Tag> 项目类型为 `<Project Sdk="Microsoft.NET.Sdk">` 的控制台项目 [fb08a65](https://gitee.com/dotnetchina/Furion/commit/fb08a6548d49921aa143d01389a2592b92e94e31)
  - &nbsp;<Tag>新增</Tag> `Serve.Run()` 极简主机模式，真正实现极速入门。[95cac5b](https://gitee.com/dotnetchina/Furion/commit/95cac5b391b70d73bfc94147ee40eef529b2eec6)
  - &nbsp;<Tag>调整</Tag> 未启用规范化结果时，`MVC` 验证失败返回 `BadPageResult()` 页面类型 [!494](https://gitee.com/dotnetchina/Furion/pulls/494)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 修复默认注册的 `services.AddResponseCaching();` 服务导致 `.axd` 内嵌资源请求错误问题 [!495](https://gitee.com/dotnetchina/Furion/pulls/495)
  - &nbsp;<Tag>修复</Tag> `Oracle` 数据库执行 `sql` 必须要求命令参数和 `sql` 语言参数数量一致 [#I5D057](https://gitee.com/dotnetchina/Furion/issues/I5D057)
  - &nbsp;<Tag>修复</Tag> `IHostService` 类型不能自动注册问题，之前只扫描了 `BackgroundService` 派生类 [968344](https://gitee.com/dotnetchina/Furion/commit/968344aa07348f4c06f914abf7b6f46174633d81)
  - &nbsp;<Tag>修复</Tag> 国产芯片主机不能识别 `dotnet run --urls` 参数问题 [6d4398](https://gitee.com/dotnetchina/Furion/commit/6d43983781e0c41228c4917a242141d011088bdb)
  - &nbsp;<Tag>修复</Tag> 远程请求上传文件不支持特定文件后缀问题，如 `.pem` 文件 [ba42198](https://gitee.com/dotnetchina/Furion/commit/ba42198c1cd58612f2b383349c37068aac78cdd7)
  - &nbsp;<Tag>修复</Tag> 一些程序集已破坏或程序集不完整导致主机无法启动问题 [d2dc3e4](https://gitee.com/dotnetchina/Furion/commit/d2dc3e4d09e726699c38ebb8cb7b83de0e97f46f)
  - &nbsp;<Tag>修复</Tag> 远程请求传入 `headers` 时类型为 `Dictionary<string, string>` 导致转换异常问题 [#I5DHL9](https://gitee.com/dotnetchina/Furion/issues/I5DHL9)
  - &nbsp;<Tag>修复</Tag> `Serilog` 单文件发布不生成日志文件 [I5DQ2B](https://gitee.com/dotnetchina/Furion/issues/I5DQ2B)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> 远程请求默认客户端不检查 `SSL` 证书 [eb7d18a](https://gitee.com/dotnetchina/Furion/commit/eb7d18ac183894d604cec1d4c8527466ef9c648a)
  - &nbsp;<Tag>调整</Tag> 开放验证服务选项 `SuppressModelStateInvalidFilter` 属性为可配置 [!494](https://gitee.com/dotnetchina/Furion/pulls/495)

- **文档**

  - &nbsp;<Tag>新增</Tag> `Serve.Run()` 文档
  - &nbsp;<Tag>新增</Tag> `HttpContext` 文档
  - &nbsp;<Tag>新增</Tag> `GlobalUsings` 文档
  - &nbsp;<Tag>新增</Tag> `TP` 全局静态类文档
  - &nbsp;<Tag>新增</Tag> 中间件文档、筛选器文档、审计日志文档
  - &nbsp;<Tag>更新</Tag> 跨域文档、远程请求文档

- **精彩贡献**

  - [!494](https://gitee.com/dotnetchina/Furion/pulls/494) 优秀 `Pull Request` 辩论典范

- **本期亮点**

1. **极速入门**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers title="Program.cs" {3,6}
Serve.Run();

[DynamicApiController]
public class HelloService
{
    public string Say()
    {
        return "Hello, Furion";
    }
}
```

启动浏览器查看效果，惊呆了吗！

<img src={useBaseUrl("img/07.png")} />

  </div>
</details>

2. **内置错误页**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers{1,7}
using Furion.FriendlyException;

public IActionResult Add(Person person)
{
    if(!ModelState.IsValid)
    {
        return new BadPageResult();
    }
}
```

<img src={useBaseUrl("img/er1.png")} />

  </div>
</details>

3. **`Swagger` 支持 `Markdown`**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

````cs showLineNumbers {4-62}
/// <summary>
/// 测试 Markdown
/// </summary>
/// <remarks>
/// # 测试 `Markdown` 注释
///
/// ![](https://localhost:44316/images/logo.png)
///
/// ```cs
/// Serve.Run();
///
/// [DynamicApiController
/// public class HelloService
/// {
///     public string Say()
///     {
///         return nameof(Furion);
///     }
/// }
/// ```
///
/// 功能还不错！！！
///
/// | 商品         | 价格     | # 其他 |
/// |--------------|-----------|------------|
/// | Juicy Apples | 1.99      | *7*        |
/// | Bananas      | **1.89**  | 5234       |
/// | Bananas      | **1.89**  | 5234       |
/// | Bananas      | **1.89**  | 5234       |
///
/// -----
///
/// # Furion 探索版
///
/// > 在过去一年，实现 `Furion` 从无到有，编写文档已逾百万字，过程心酸开源人自知。
/// >
/// > 这一路日夜兼程，嘲讽批评常伴眼耳，即便辛苦无奈、想过放弃，但为了那微不足道的存在感依然努力着。
/// >
/// > 当然，也收获了不少...越来越多拥趸者，越发精湛技术能力，更高层次思维模式，还有许多跨界跨行朋友。
/// >
/// > 在 《[开源指北] (https://gitee.com/opensource-guide/comments/)》中，我曾说道：“开源如同人的脸，好坏一面便知，缺点可能会受到嘲讽批评，优点也会收获赞扬尊重。别担心，他们正在塑造更好的你。”
/// >
/// > 所以，这一次重新起航，重塑 `Furion` 重塑自己。也许未来在某个 IT 圈但凡有人谈起 `.NET` 还能瞟到 `Furion` 的身影。
///
/// ---
///
/// 🎉 探索 Furion 未来更多可能性，实现无第三方依赖的版本，所有模块功能按需安装，按需加载。
///
/// - 作者：[百小僧] (https://gitee.com/monksoul)
/// - 日期：2021 年 08 月 30 日
///
/// ## 环境
///
/// - IDE ：[Microsoft Visual Studio Enterprise 2022 Preview(64 位) 版本 17.0.0 Preview 3.1] (https://visualstudio.microsoft.com/zh-hans/vs/preview/)
/// - SDK ：[.NET SDK 6] (https://dotnet.microsoft.com/download/dotnet/6.0)
/// - 语言：[C# 10](https://docs.microsoft.com/zh-cn/dotnet/csharp/whats-new/csharp-10)
///
/// ## 包说明
///
/// - `Furion.Core`：无第三方依赖，可在 `.NET 6` 所有项目类型中运行。
/// - `Furion`：内部依赖 `Furion.Core` 且无第三方依赖，**聚焦 `Web` 应用**，采用共享框架 `<FrameworkReference Include="Microsoft.AspNetCore.App" />` 模式
///  </remarks>
public void MarkdownTest()
{
    // ....
}
````

<img src={useBaseUrl("img/mdx2.png")} />

  </div>
</details>

---

## v3.5.7（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `Options` 选项属性支持自定义 `Key` 名称，`[MapSettings("key")]` [#I5B2HN](https://gitee.com/dotnetchina/Furion/issues/I5B2HN)
  - &nbsp;<Tag>新增</Tag> `EventBus` 模块事件 `Id` 支持枚举类型 [2f328aa](https://gitee.com/dotnetchina/Furion/commit/2f328aa8213c8efe7a8480116985573cc6b7fce6)
  - &nbsp;<Tag>新增</Tag> `EventBus` 模块发布者 `PublishAsync` 和 `PublishDelayAsync` 重载 [2f328aa](https://gitee.com/dotnetchina/Furion/commit/2f328aa8213c8efe7a8480116985573cc6b7fce6)
  - &nbsp;<Tag>新增</Tag> `EventBus` 模块拓展方法：`Enum.ParseToString()` 和 `String.ParseToEnum()` [2f328aa](https://gitee.com/dotnetchina/Furion/commit/2f328aa8213c8efe7a8480116985573cc6b7fce6)
  - &nbsp;<Tag>新增</Tag> **`Furion` 和 `SqlSugar` 脚手架** 🆕🆕🆕 [8d9293d](https://gitee.com/dotnetchina/Furion/commit/8d9293d1188670626f017ccea4ffb85ac315d2fc)
  - &nbsp;<Tag>新增</Tag> `Dapper` 拓展全局配置委托 [#I5AYFX](https://gitee.com/dotnetchina/Furion/issues/I5AYFX)
  - &nbsp;<Tag>新增</Tag> `sql` 转实体支持多种命名策略（纯大写，纯小写，带下划线分割等等），如 `Oracle` 数据库 [a90e245](https://gitee.com/dotnetchina/Furion/commit/a90e24516387e088b2c427e6b99d3dab937116c9)
  - &nbsp;<Tag>新增</Tag> `FS.InitalContentTypeProvider()` 拓展方法，获取系统内所有支持的 `Content-Type` 文件提供器 [6099900](https://gitee.com/dotnetchina/Furion/commit/6099900472d93dab7012f0b091b05c914be11c4a)

- **突破性变化**

  - &nbsp;<Tag>修复</Tag> 彻底解决了 `Furion` 不能单文件发布的问题 [7e8e0b7](https://gitee.com/dotnetchina/Furion/commit/7e8e0b708bcdac670aa835dec5cd494d41ff3648)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 框架规范化文档 `Swagger` 不支持 `Controller` 派生类 `api` 路由问题，原生 `ASP.NET` 是支持的 [29e47bc](https://gitee.com/dotnetchina/Furion/commit/29e47bce3678767c4793ad254777704ab9dd7e03)
  - &nbsp;<Tag>修复</Tag> 基于 `Schema` 多租户配置无效问题 [6f820ce](https://gitee.com/dotnetchina/Furion/commit/6f820ce0f28dd27a6e265b969b5b4095de676106)
  - &nbsp;<Tag>修复</Tag> 指定实体 `[Table(schema:"dbo")]` 特性后 `Schema` 无效问题 [6f820ce](https://gitee.com/dotnetchina/Furion/commit/6f820ce0f28dd27a6e265b969b5b4095de676106)
  - &nbsp;<Tag>修复</Tag> 数据库视图不支持 `Schema` 配置问题 [6f820ce](https://gitee.com/dotnetchina/Furion/commit/6f820ce0f28dd27a6e265b969b5b4095de676106)
  - &nbsp;<Tag>修复</Tag> 规范化结果极端情况下出现 `空异常` 问题 [c9b0ef](https://gitee.com/dotnetchina/Furion/commit/c9b0ef09427418e2ccb88d3a4c02e7a29d9d510e)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> `axios-utils.ts` 和 `angular-utils.ts` ，新增请求拦截携带刷新 `Token` 的时机判断 [82f89bd](https://gitee.com/dotnetchina/Furion/commit/82f89bd95573aefa7075676af7f00c55507cb03b)
  - &nbsp;<Tag>更新</Tag> 规范化文档 `Swagger` 加载继承注释 `<inheritoc />` 性能小优化 [5f06880](https://gitee.com/dotnetchina/Furion/commit/5f06880564ee8cd2e77caa5957ff18a0c489bdd2)
  - &nbsp;<Tag>调整</Tag> 脚手架模板，新增 `GlobalUsings.cs` 模式
  - &nbsp;<Tag>调整</Tag> 对象映射默认支持忽略大小写 [!486](https://gitee.com/dotnetchina/Furion/pulls/486)

- **文档**

  - &nbsp;<Tag>新增</Tag> `Furion` 单文件发布文档
  - &nbsp;<Tag>新增</Tag> `Furion + SqlSugar` 脚手架文档
  - &nbsp;<Tag>更新</Tag> 事件总线文档、选项文档、即时通讯文档、`.NET5` 升级 `.NET6` 文档、依赖注入文档、跨域文档、数据加解密文档

- **本期亮点**

1. **事件总线 `Id` 支持枚举类型**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {7,10}
EventSubscribe("TO:DO")]  // 字符串类型
public async Task EventHandler1(EventHandlerExecutingContext context)
{
    // ....
}

[EventSubscribe(YourEnum.Some)] // 枚举类型
public async Task EventHandler2(EventHandlerExecutingContext context)
{
    var eventEnum = context.Source.EventId.ParseToEnum(); // 将事件 Id 转换成枚举对象
    // ....
}
```

  </div>
</details>

2. **事件总线发布支持更简单调用**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {5,6}
// 旧版本
await _eventPublisher.PublishAsync(new ChannelEventSource("ToDo:Create", name));

// 新版本
await _eventPublisher.PublishAsync("ToDo:Create", name);
await _eventPublisher.PublishAsync(YourEnum.Some); // 也支持枚举
```

  </div>
</details>

3. **选项支持属性自定义配置 `Key`**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```json showLineNumbers {4}
"AppInfo": {
    "Name": "Furion",
    "Version": "1.0.0",
    "Company_Name": "Baiqian" // 可以和属性不一样
}
```

```cs showLineNumbers {6,7}
public class AppInfoOptions : IConfigurableOptions
{
    public string Name { get; set; }
    public string Version { get; set; }

    [MapSettings("Company_Name")] // 支持自定义
    public string Company { get; set; }
}
```

  </div>
</details>

4. **日志规范化模板**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {2}
// 生成模板字符串
var template = TP.Wrapper("Furion 框架", "让 .NET 开发更简单，更通用，更流行。",
    "[作者] 百小僧",
    "[当前版本] v3.5.3",
    "[文档地址] https://furion.icu",
    "[Copyright] 百小僧, Baiqian Co.,Ltd.");
Console.WriteLine(template);
```

输出结果

```bash showLineNumbers
┏━━━━━━━━━━━  Furion 框架 ━━━━━━━━━━━
┣ 让 .NET 开发更简单，更通用，更流行。
┣
┣ 作者：        百小僧
┣ 当前版本：     v3.5.3
┣ 文档地址：     https://furion.icu
┣ Copyright：   百小僧, Baiqian Co.,Ltd.
┗━━━━━━━━━━━  Furion 框架 ━━━━━━━━━━━

```

  </div>
</details>

---

## v3.4.2（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 规范化文件 `EnableAllGroups` 功能，可以将多个分组合并到一个分组中 [9277b98](https://gitee.com/dotnetchina/Furion/commit/9277b982ce024bac8ab5117ba02c3bd96ad07972)
  - &nbsp;<Tag>新增</Tag> `angular-utils` 客户端工具库，专门处理 `angular` 项目接口代理问题 [6c70584](https://gitee.com/dotnetchina/Furion/commit/6c705848a77fbf7234070d0ef9f053a85cc8838a)
  - &nbsp;<Tag>新增</Tag> `Swagger` 支持单个接口更多描述功能（支持 `html`）[e5e1db0](https://gitee.com/dotnetchina/Furion/commit/e5e1db09710dab02966330063935bd5e5b7e4dc8)
  - &nbsp;<Tag>新增</Tag> `Swagger` 接口 `[Obsolete]` 过时支持功能 [e5e1db0](https://gitee.com/dotnetchina/Furion/commit/e5e1db09710dab02966330063935bd5e5b7e4dc8)
  - &nbsp;<Tag>新增</Tag> 动态 `API` 的 `[ApiDescriptionSettings]` 特性 和`DynamicApiControllerSettings` 配置 的 `ForceWithRoutePrefix` 参数，支持强制复写 `[Route]` 特性并添加 `DefaultRoutePrefix` [#I59B74](https://gitee.com/dotnetchina/Furion/issues/I59B74)

- **突破性变化**

  - &nbsp;<Tag>新增</Tag> 默认内置 `GBK`，`Windows-1252`, `Shift-JIS`, `GB2312` 等编码支持 [c456ecb](https://gitee.com/dotnetchina/Furion/commit/c456ecb225b099e5d24add32024f16c359414532)
  - &nbsp;<Tag>新增</Tag> `Furion` 和 `SqlSugar` 脚手架

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `<inheritdoc />` 不能跨程序集问题 [3b9d39c](https://gitee.com/dotnetchina/Furion/commit/3b9d39ce691f9505c5541a790103fbb0ba6d35af)
  - &nbsp;<Tag>修复</Tag> `<inheritdoc />` 不支持带参数，不支持隐式实现接口注释问题 [#I59A6W#note_10699021](https://gitee.com/dotnetchina/Furion/issues/I59A6W#note_10699021_link)
  - &nbsp;<Tag>修复</Tag> `v3.3.1` 版本导致 `Swagger` 不能显示问题 [6763352](https://gitee.com/dotnetchina/Furion/commit/676335264478d68b99db009d32b65de781702605)
  - &nbsp;<Tag>修复</Tag> 远程请求、`JSON`以及 `Web` 页面不支持 `GBK`，`GB2312` 等国标编码问题 [c456ecb](https://gitee.com/dotnetchina/Furion/commit/c456ecb225b099e5d24add32024f16c359414532)
  - &nbsp;<Tag>修复</Tag> 远程请求响应报文设置了 `Content-Type:charset=` 不能自动转换编码问题 [c456ecb](https://gitee.com/dotnetchina/Furion/commit/c456ecb225b099e5d24add32024f16c359414532)

- **其他更改**

  - &nbsp;<Tag>新增</Tag> `axios-utils.ts` 和 `angular-utils.ts` 多客户端支持

- **文档**

  - &nbsp;<Tag>新增</Tag> `GlobalUsings` 文档 [文档地址](https://furion.baiqian.ltd/blog/global-usings)
  - &nbsp;<Tag>新增</Tag> 请求大小/上传大小限制文档 [文档地址](https://furion.baiqian.ltd/docs/file-provider/#317-%E8%AF%B7%E6%B1%82%E5%A4%A7%E5%B0%8F%E6%8E%A7%E5%88%B6%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E6%8E%A7%E5%88%B6)
  - &nbsp;<Tag>更新</Tag> 规范化文档，`Worker Service` 文档，动态 API 文档

- **本期亮点**

1. **启用 `All Groups` 分组功能**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

有时候我们为了更好的对接口进行归类，配置了 `Swagger` 多个分组的功能，但这样也对生成客户端请求代码造成了困扰，所以添加了新的配置：

```json showLineNumbers {2-3}
{
  "SpecificationDocumentSettings": {
    "EnableAllGroups": true
  }
}
```

  </div>
</details>

2. **接口过时控制**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

当我们某个接口已经过时，提示尽早调用最新接口，只需要在方法上面贴 `[Obsolete]` 即可，如：

```cs showLineNumbers {1,7}
[Obsolete("GetName() 已经过时，请调用 GetFrameworkName() 替代")]
public string GetName()
{
  return nameof(Furion);
}

[Obsolete]
public string Other()
{
  // ...
}
```

<img src={useBaseUrl("img/swg2.png")} />

  </div>
</details>

3. **单一接口更多描述**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

在该版本新增了 `[ApiDescriptionSettings]` 的 `Description` 属性，支持定义更多描述，如：

```cs showLineNumbers {1}
[ApiDescriptionSettings(Description = "我是一段描述，显示更多内容 <button>我是按钮</button>")]
public string add()
{
  //....
}
```

<img src={useBaseUrl("img/swg1.png")} />

  </div>
</details>

---

## v3.3.3（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 远程请求文件上传自动识别 `Content-Type` 和 `Mime` [#I57ZMN](https://gitee.com/dotnetchina/Furion/issues/I57ZMN)
  - &nbsp;<Tag>新增</Tag> 远程请求方法支持设置 `Content-Type` 和 `Encoding` [#I57ZMN](https://gitee.com/dotnetchina/Furion/issues/I57ZMN)
  - &nbsp;<Tag>新增</Tag> 根据文件名获取 `Content-Type` 和 `Mime` 类型 [#8f78184](https://gitee.com/dotnetchina/Furion/commit/8f78184f8661830744592c054b65d503346c1b27)
  - &nbsp;<Tag>新增</Tag> 规范化文档支持授权访问 [#32aa3b6](https://gitee.com/dotnetchina/Furion/commit/32aa3b6328d23a5885033837883c7b546e898d43)
  - &nbsp;<Tag>新增</Tag> 代码注释，规范化文档注释 `inheritdoc` 语法支持 ❤️️️️ [#159A6W](https://gitee.com/dotnetchina/Furion/issues/I59A6W)
  - &nbsp;<Tag>新增</Tag> 新增 `Vue2/3`，`React 16.8+`，`Angular 9+` 前端请求工具库，实现后端 API 代理 [axios-utils](https://gitee.com/dotnetchina/Furion/tree/v4/clients/axios)

- **突破性变化**

  - &nbsp;<Tag>新增</Tag> 代码注释，规范化文档注释 `inheritdoc` 语法支持 ❤️️️️ [#159A6W](https://gitee.com/dotnetchina/Furion/issues/I59A6W)
  - &nbsp;<Tag>更新</Tag> `.NET` 所有依赖包至 `v6.0.5` 版本

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 自定义全局异常 `Exception` 后导致获取错误行号，文件空异常问题 [#I53EGM](https://gitee.com/dotnetchina/Furion/issues/I53EGM)
  - &nbsp;<Tag>修复</Tag> 配置数据库上下文传递空委托导致空引用异常问题 [#I519AW](https://gitee.com/dotnetchina/Furion/issues/I519AW)
  - &nbsp;<Tag>修复</Tag> 字符串模板模板 `Render` 拓展方法返回 `void` 问题，应该返回 `string` [Github-#99](https://github.com/MonkSoul/Furion/issues/99#issuecomment-1073131906)
  - &nbsp;<Tag>修复</Tag> 远程请求文件上传出现空情况问题（原因是缺失 `Content-Type` ）[I57ZMN](https://gitee.com/dotnetchina/Furion/issues/I57ZMN)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> 框架源码引入 `GlobalUsings` 机制，减少代码体积 [#7e9cc1c](https://gitee.com/dotnetchina/Furion/commit/7e9cc1c205750906cddd540ad08a4c02f14efa3a)
  - &nbsp;<Tag>调整</Tag> 跨域请求的预检设置，如果未设置，则默认为 24 小时，主要解决前端多次发送 204 预检问题 [4a11e7c](https://gitee.com/dotnetchina/Furion/commit/4a11e7c9fa20b4419ac00f6ad21c078500d00791)
  - &nbsp;<Tag>更新</Tag> 视图引擎反射性能

- **文档**

  - &nbsp;<Tag>新增</Tag> 粘土对象序列化 `JSON` 配置文档
  - &nbsp;<Tag>新增</Tag> 前端解密 `JWT` 文档
  - &nbsp;<Tag>新增</Tag> 将 `byte[]` 转 `url` 文档
  - &nbsp;<Tag>更新</Tag> 二级虚拟目录部署文档，远程请求文档，文件上传文档，安全授权文档、规范化文档

- **本期亮点**

  - ❤️️️️ **根据文件名获取 `MIME` 或 `Content-Type` 类型**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers
var success = FS.TryGetContentType("image.png", out var contentType);  // image/png
```

- ❤️️️️ **支持 `Swagger` 配置登录后才能访问**

```json showLineNumbers {2-6}
{
  "SpecificationDocumentSettings": {
    "LoginInfo": {
      "Enabled": true,
      "CheckUrl": "检查登录地址",
      "SubmitUrl": "提交登录地址"
    }
  }
}
```

<img src={useBaseUrl("img/swgdl.png")} />

[查看详细文档](./specification-document#6529-带登录的-swagger-文档)

  </div>
</details>

- ❤️️️️ **支持代码注释继承，Swagger 文档注释也支持**

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers {1,4,10}
/// <inheritdoc cref="ITestInheritdoc" />
public class TestInheritdoc : ITestInheritdoc, IDynamicApiController
{
    /// <inheritdoc cref="ITestInheritdoc.GetName"/>
    public string GetName()
    {
        return "Furion";
    }

    /// <inheritdoc />
    public string GetVersion()
    {
        return "3.3.3";
    }
}

/// <summary>
/// 测试注释继承
/// </summary>
public interface ITestInheritdoc
{
    /// <summary>
    /// 获取名称
    /// </summary>
    /// <returns></returns>
    string GetName();

    /// <summary>
    /// 获取版本
    /// </summary>
    /// <returns></returns>
    string GetVersion();
}
```

<img src={useBaseUrl("img/cdr22.png")} />

[查看详细文档](./specification-document#6530-inheritdoc-实现注释继承)

  </div>
</details>

---

## v3.2.0（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `IFormFile` 拓展方法 `ToByteArray()` [da69640](https://gitee.com/dotnetchina/Furion/commit/da69640da2331e2c8582b88bbda965c5ad7ecbe0)
  - &nbsp;<Tag>新增</Tag> 规范化文档 `ServeDir` 虚拟目录配置功能，支持一键将一级目录切换至二级目录部署（IIS）[8718392](https://gitee.com/dotnetchina/Furion/commit/87183921ac8b6f9856db01b4de679b858a58e753)

- **突破性变化**

  - &nbsp;<Tag>更新</Tag> 所有依赖包至最新版
  - &nbsp;<Tag>优化</Tag> 依赖注入模块核心代码，移除注册服务采用反射机制，减少反射性能损耗 [acdb315](https://gitee.com/dotnetchina/Furion/commit/acdb3157af92891610a1ba6d317b6af3f09e233f)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `Swagger` 的 `schema` 类型如果是 `C# Object` 类型无法正确生成前端代码问题 [Swagger 官方 Issue](https://github.com/swagger-api/swagger-codegen-generators/issues/692) [1a25274](https://gitee.com/dotnetchina/Furion/commit/1a252747fd60fc87a8ed4425c8edf7803f96ce43)
  - &nbsp;<Tag>修复</Tag> `Worker Service` 发布成 `Windows Services` 时日志绝对路径问题 感谢 [@jacoat](https://gitee.com/jacoat) [!467](https://gitee.com/dotnetchina/Furion/pulls/467)
  - &nbsp;<Tag>修复</Tag> `Nginx` 和 `IIS` 对二级虚拟目录配置不同导致 `404` 问题 [8718392](https://gitee.com/dotnetchina/Furion/commit/87183921ac8b6f9856db01b4de679b858a58e753)
  - &nbsp;<Tag>修复</Tag> 远程请求模块未初始化 `OnRequestFailded` 导致空异常问题 [#I54PK7](https://gitee.com/dotnetchina/Furion/issues/I54PK7)
  - &nbsp;<Tag>修复</Tag> 依赖注入反射出现 `Not found Method` bug [#I546L1](https://gitee.com/dotnetchina/Furion/issues/I546L1)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> 定时任务失败后异常处理逻辑，感谢 [@程小胜](https://gitee.com/cxs1992) [!463](https://gitee.com/dotnetchina/Furion/pulls/463)

- **文档**

  - &nbsp;<Tag>更新</Tag> 定时任务文档，日志文档
  - &nbsp;<Tag>新增</Tag> 文件上传/下载 文档，包含单文件/多文件/Base64/Byte[]

---

## v3.1.0（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 远程请求模块异常 `Http` 状态码 [!462](https://gitee.com/dotnetchina/Furion/pulls/462)
  - &nbsp;<Tag>新增</Tag> 动态 WebAPI 支持小驼峰配置 [#I4W1R4](https://gitee.com/dotnetchina/Furion/issues/I4W1R4)
  - &nbsp;<Tag>新增</Tag> 远程请求 `SendAsByteArrayAsync` 等一系列方法，支持返回 `byte[]` [!452](https://gitee.com/dotnetchina/Furion/pulls/452)
  - &nbsp;<Tag>新增</Tag> 远程请求 `GZip` 压缩支持 [#I506S5](https://gitee.com/dotnetchina/Furion/issues/I506S5)

- **突破性变化**

  - &nbsp;<Tag>升级</Tag> `.NET6` 依赖包全部升级至 `Nuget` 最新版 `v6.0.3`

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `.NET6 WebApplication` 模式二级虚拟目录问题 [#I4UZLM](https://gitee.com/dotnetchina/Furion/issues/I4UZLM) [#I4PZ0C](https://gitee.com/dotnetchina/Furion/issues/I4PZ0C)
  - &nbsp;<Tag>修复</Tag> 日期验证不支持 `2022-03-01 0:00:00`（现在支持小时域 `0` 和 `00`） 问题 [#I4Y3NT](https://gitee.com/dotnetchina/Furion/issues/I4Y3NT)
  - &nbsp;<Tag>修复</Tag> 环境配置和文件配置优先级问题
  - &nbsp;<Tag>修复</Tag> 脱敏模块替换敏感词汇只替换最后一个 bug [#I4YFA0](https://gitee.com/dotnetchina/Furion/issues/I4YFA0)
  - &nbsp;<Tag>修复</Tag> 远程请求返回字符串个别情况出现中文乱码问题 [#I50GBD](https://gitee.com/dotnetchina/Furion/issues/I50GBD)
  - &nbsp;<Tag>修复</Tag> `[DataValidate]` 配置 `AllowNullValue` 和 `AllowEmptyString` 无效问题 [#I4ZZBE](https://gitee.com/dotnetchina/Furion/issues/I4ZZBE)

- **其他更改**

  - [过时] 标记 `Furion.Extras.Logging.Serilog` 拓展包 `IWebHost` 拓展为过时状态

- **文档**

  - &nbsp;<Tag>文档</Tag> 优化文档体验，新增面包屑导航，重写文档缓存，提升文档访问速度
  - &nbsp;<Tag>文档</Tag> 更新动态 API 文档、配置文档、远程请求文档
  - &nbsp;<Tag>文档</Tag> 更新二级虚拟目录文档

- **本期亮点**

1. 新增动态 `WebApi` 支持小驼峰路径，如 `GetMyName` -> `getMyName`：

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```json showLineNumbers
{
  "DynamicApiControllerSettings": {
    "LowercaseRoute": false,
    "KeepName": true,
    "AsLowerCamelCase": true
  }
}
```

  </div>
</details>

2. 支持 `.NET6 WebApplication` 模式二级虚拟目录配置：

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

```cs showLineNumbers  {title="Progame.cs"}
app.UseVirtualPath(app =>
{
    app.UseInject(String.Empty);  // 注意 String.Empty 只是例子，可以不填或填其他的，见一分钟入门
    app.MapRouteControllers();
});
```

  </div>
</details>

---

## v3.0.0（已发布）

:::warning v3+ 版本说明

**Furion v3.x 版本采用 .NET6 构建。**

:::

- **新特性**

  - &nbsp;<Tag>新增</Tag> 远程请求支持 `GET` 请求自动转换 `类类型` 类型对象 [#I4HR5Q](https://gitee.com/dotnetchina/Furion/issues/I4HR5Q)

- **突破性变化**

  - &nbsp;<Tag>升级</Tag> 全面支持 `.NET6` 版本

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 开启规范化结果并自定义全局异常导致异常经过 `OnSucceeded` 过滤器 bug [#I4DTVL](https://gitee.com/dotnetchina/Furion/issues/I4DTVL)
  - &nbsp;<Tag>修复</Tag> `.NET5.0.5+` 和 `.NET6` 微软底层修改了 `[ApiController]` 验证失败返回 `IActionResult` 类型 [#I4ISOK](https://gitee.com/dotnetchina/Furion/issues/I4ISOK)
  - &nbsp;<Tag>修复</Tag> `EFCore 6.0` 适配 `SqlServer 2005+` 出错 [#I4ILA5](https://gitee.com/dotnetchina/Furion/issues/I4ILA5)
  - &nbsp;<Tag>修复</Tag> .NET6 获取配置对象如果不存在返回 null 问题，.NET5 则返回初始对象 [94ae4d](https://gitee.com/dotnetchina/Furion/commit/94ae4d8c9b0fe7eb4d713a171f953c0d3c5a76ac)
  - &nbsp;<Tag>修复</Tag> `Sql` 命令参数传入 `Clay` 类型异常问题 [#I4D21Q](https://gitee.com/dotnetchina/Furion/issues/I4D21Q)
  - &nbsp;<Tag>修复</Tag> `Cron` 定时任务特性方式 bug [#I4OJQI](https://gitee.com/dotnetchina/Furion/issues/I4OJQI)

- **其他更改**

  - &nbsp;<Tag>移除</Tag> ~~`ToPagedList` 泛型约束~~ [d0244d](https://gitee.com/dotnetchina/Furion/commit/d0244dc33a0e5236158cdcdff21d086e00a42ee7)

- **文档**

  - &nbsp;<Tag>文档</Tag> 查看 **[.NET6 一分钟入门](https://furion.baiqian.ltd/docs/get-start-net6)**
  - &nbsp;<Tag>文档</Tag> 查看 **[Furion v2 升级 v3](https://furion.baiqian.ltd/docs/net5-to-net6)**

- **特别鸣谢**

  - [KaneLeung](https://gitee.com/KaneLeung)

---

## v2.20（已发布，全新事件总线）

:::warning v2.20+ 版本说明

**在 `Furion v2.20+` 版本后采用 [Jaina](https://gitee.com/dotnetchina/Jaina) 事件总线替换原有的 `EventBus`**

:::

- **新特性**

  - &nbsp;<Tag>新增</Tag> 远程请求支持 `GET` 请求自动转换 `类类型` 类型对象 [#I4HR5Q](https://gitee.com/dotnetchina/Furion/issues/I4HR5Q)

- **突破性变化**

  - &nbsp;<Tag>优化</Tag> `EventBus` 模块，采用 [Jaina](https://gitee.com/dotnetchina/Jaina) 方式

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 开启规范化结果并自定义全局异常导致异常经过 `OnSucceeded` 过滤器 bug [#I4DTVL](https://gitee.com/dotnetchina/Furion/issues/I4DTVL)
  - &nbsp;<Tag>修复</Tag> `.NET5.0.5+` 微软底层修改了 `[ApiController]` 验证失败返回 `IActionResult` 类型 [#I4ISOK](https://gitee.com/dotnetchina/Furion/issues/I4ISOK)
  - &nbsp;<Tag>修复</Tag> 远程请求上传文件异常 [0c0752](https://gitee.com/dotnetchina/Furion/commit/0c0752c624799d7d3c7661a8f36a93983399bb59)
  - &nbsp;<Tag>修复</Tag> 框架启动不支持环境变量 `ASPNETCORE_HOSTINGSTARTUPASSEMBLIES` 配置 [!438](https://gitee.com/dotnetchina/Furion/pulls/438)
  - &nbsp;<Tag>修复</Tag> 定时任务内存和 CPU 占用及特殊情况下空异常问题 [12c65de](https://gitee.com/dotnetchina/Furion/commit/12c65debf552c57780679e6a567a9dd9fb077f46)
  - &nbsp;<Tag>修复</Tag> 默认控制器启用规范化结果无效 bug[c7a4a5e](https://gitee.com/dotnetchina/Furion/commit/c7a4a5ef8c3282d245cbe04124cf379d381d496f)
  - &nbsp;<Tag>修复</Tag> 依赖注入 `InjectionAttribute` 特性的 `ExceptInterfaces` 单词拼写错误问题 [!436](https://gitee.com/dotnetchina/Furion/pulls/436)
  - &nbsp;<Tag>修复</Tag> `Sql` 命令参数传入 `Clay` 类型异常问题 [#I4D21Q](https://gitee.com/dotnetchina/Furion/issues/I4D21Q)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> `InjectionAttribute` 代码 [!435](https://gitee.com/dotnetchina/Furion/pulls/435)
  - &nbsp;<Tag>移除</Tag> ~~`ToPagedList` 泛型约束~~ [d0244d](https://gitee.com/dotnetchina/Furion/commit/d0244dc33a0e5236158cdcdff21d086e00a42ee7)

- **文档**

  - &nbsp;<Tag>新增</Tag> 事件总线新文档

---

## v2.19（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 定时任务监听器 `ISpareTimeListener` [#I468Q1](https://gitee.com/dotnetchina/Furion/issues/I468Q1)
  - &nbsp;<Tag>新增</Tag> 执行 `Sql` 支持 `JsonElement` 参数 [61985d6](https://gitee.com/dotnetchina/Furion/commit/61985d6a300485d553cbe8461b01f01bcd0936ef)
  - &nbsp;<Tag>新增</Tag> `Swagger` 配置枚举及标签排序过滤器 [#I46LON](https://gitee.com/dotnetchina/Furion/issues/I46LON) [!404](https://gitee.com/dotnetchina/Furion/pulls/404)
  - &nbsp;<Tag>新增</Tag> 远程请求 `application/octet-stream` 类型默认支持 [d9bad03](https://gitee.com/dotnetchina/Furion/commit/d9bad0320cc4a204e24bc3a070517ebce4cdc5d7)
  - &nbsp;<Tag>新增</Tag> 远程请求代理模式请求报文头支持 `IDictionary<string ,object>` 类型。[0204c0a](https://gitee.com/dotnetchina/Furion/commit/0204c0afe2de5c28ebbd44b29131e701b93ae8b8)
  - &nbsp;<Tag>新增</Tag> `MongoDB` 拓展类，添加更多常用操作方法 [!423](https://gitee.com/dotnetchina/Furion/pulls/423)
  - &nbsp;<Tag>新增</Tag> `DateTimeOffset?` 转换 `DateTime` 拓展（包含互换） [!432](https://gitee.com/dotnetchina/Furion/pulls/432)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `Scoped.Create` 在 `EFCore` 进行 `Add-Migration` 时候报空异常问题，原因是在 `PM` 环境中不存在根服务[0853e74](https://gitee.com/dotnetchina/Furion/commit/0853e74de90718fce9c0892e2ee4da597f62a918)
  - &nbsp;<Tag>修复</Tag> 定时任务执行异常后异常一直驻留内存问题，修正为执行成功自动清空过去异常 [197a62b](https://gitee.com/dotnetchina/Furion/commit/197a62bb4a7df34eb2c0dbda65121e9cf00d905c)
  - &nbsp;<Tag>修复</Tag> `Jwt` 拓展包不正确的代码导致 IOptions 失效[#I46LUP](https://gitee.com/dotnetchina/Furion/issues/I46LUP)
  - &nbsp;<Tag>修复</Tag> `Swagger` 枚举 `Schema` 过滤器不输出值问题 [#I46LON](https://gitee.com/dotnetchina/Furion/issues/I46LON) [!404](https://gitee.com/dotnetchina/Furion/pulls/404)
  - &nbsp;<Tag>修复</Tag> `Swagger` 处理非 `int` 类型枚举转换 bug [#I46QJ9](https://gitee.com/dotnetchina/Furion/issues/I46QJ9)
  - &nbsp;<Tag>修复</Tag> 视图引擎编译模板生成 `dll` 后再次加载出现 `IL` 格式化错误问题 [ff52d38](https://gitee.com/dotnetchina/Furion/commit/ff52d383718b4d34968619f17c9d54d8718b4f3f)
  - &nbsp;<Tag>修复</Tag> 管道 `Channel` 读取器无法释放 `Handler` 对象问题 [10f4a90](https://gitee.com/dotnetchina/Furion/commit/10f4a900ee558a29f40ae21366a0eba83eceb3eb)
  - &nbsp;<Tag>修复</Tag> `Worker Services` 下日志不输出问题 [c482548](https://gitee.com/dotnetchina/Furion/commit/c48254822c09092906ef77f04d54497e27665a92)
  - &nbsp;<Tag>修复</Tag> 远程请求 `multipart/form-data` 类型对接微信小程序上传文件 问题 [d9bad03](https://gitee.com/dotnetchina/Furion/commit/d9bad0320cc4a204e24bc3a070517ebce4cdc5d7)
  - &nbsp;<Tag>修复</Tag> 工作单元上下文在某些情况下共享事务失效问题 [006d439](https://gitee.com/dotnetchina/Furion/commit/006d439de3357d4d58ea6d7d3f9d51771a7b604e)
  - &nbsp;<Tag>修复</Tag> `Swagger` 枚举值在 `GET` 请求中 `Schema` 显示不正确问题 [fb72fd7](https://gitee.com/dotnetchina/Furion/commit/fb72fd7c98de5bf2246dd1bf08200152bd7ab7a0)
  - &nbsp;<Tag>修复</Tag> 远程请求 `404` 不走异常过滤器问题 [!426](https://gitee.com/dotnetchina/Furion/pulls/423)
  - &nbsp;<Tag>修复</Tag> 自定义事件总线并发情况下调用完成后无法正确处理队列数据 [!429](https://gitee.com/dotnetchina/Furion/pulls/429)
  - &nbsp;<Tag>修复</Tag> `v2.19+` 版本之后模块化开发加载外部程序集失效问题 [!433](https://gitee.com/dotnetchina/Furion/pulls/433)
  - &nbsp;<Tag>修复</Tag> 定时任务 SpareTime 频繁检查导致 CPU 增高问题 [aa0a2ee](https://gitee.com/dotnetchina/Furion/commit/aa0a2eec95f6ed2b74c681877498900726267d82)

- **特别鸣谢**

  - [YaChengMu](https://gitee.com/YaChengMu)

---

## v2.18（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `Furion.Tools.CommandLine` 拓展库 [查看源码](https://gitee.com/dotnetchina/Furion/tree/v4/tools/Furion.Tools/Furion.Tools.CommandLine)
  - &nbsp;<Tag>新增</Tag> 基于 `AsyncLocal<T>` 的 `CallContext` 实现 [9057a21](https://gitee.com/dotnetchina/Furion/commit/9057a212aab8057b668086bd14369fa68ce120df)
  - &nbsp;<Tag>新增</Tag> 远程请求可配置请求异常重试策略 [656da87](https://gitee.com/dotnetchina/Furion/commit/656da87a667c2da7d82425cdcd47146e99602d65)
  - &nbsp;<Tag>新增</Tag> 远程请求 `OnRequestFailded` 事件 [4a3da4b](https://gitee.com/dotnetchina/Furion/commit/4a3da4ba2c69380fe5f8c2fda80054544c0a3468)

- **突破性变化**

  - &nbsp;<Tag>移除</Tag> ~~`Scoped` 所有带返回值方法~~ [656da87](https://gitee.com/dotnetchina/Furion/commit/656da87a667c2da7d82425cdcd47146e99602d65) - &nbsp;<Tag>调整</Tag> **在 `ConfigureService` 中调用 `App.GetOptions<>()` 获取配置逻辑** [afa4ac3](https://gitee.com/dotnetchina/Furion/commit/afa4ac347152ccac37bd1d0f9af1e8ffb665a662)

> 在过去，很多开发者总是喜欢在 `Startup.cs` 配置服务的 `ConfigureService` 方法中解析服务，这样导致内存存在溢出风险，GC 无法回收。
> 正确的方式是尽可能的避免 `ConfigureService` 中解析服务。**如果需要在【启动时】获取 `配置选项`，请使用 `App.GetConfig<TOptions>(路径, true)` 代替 `App.GetOptions<TOption>`**。

- **问题修复**

  - &nbsp;<Tag>修复</Tag> v2.16+ 版本重构 `AppDbContextBuilder` 之后写错实体类型 [#I45E6M](https://gitee.com/dotnetchina/Furion/issues/I45E6M)
  - &nbsp;<Tag>修复</Tag> 远程请求单个值序列化错误处理方式 [3282eba](https://gitee.com/dotnetchina/Furion/commit/3282eba2cecb505e339ef3f9c8e823f84dcb43f0)
  - &nbsp;<Tag>修复</Tag> v2.17.3+ 单元测试创建 `TestServer` bug [#I45JR3](https://gitee.com/dotnetchina/Furion/issues/I45JR3)
  - &nbsp;<Tag>修复</Tag> `Retry.Invoke` 正常方法死循环 bug [!392](https://gitee.com/dotnetchina/Furion/pulls/392)
  - &nbsp;<Tag>修复</Tag> 刷新 `Token` 生成新 `Token` 存在数组/集合类型导致 `Key` 重复异常问题 [aeea2b1](https://gitee.com/dotnetchina/Furion/commit/aeea2b1b19434f3171bd1c77be057ca36ecf9be2)
  - &nbsp;<Tag>修复</Tag> 远程请求序列化引用类型对象（不含 `string`）不正确的处理 [93cf63a](https://gitee.com/dotnetchina/Furion/commit/93cf63a023f3372b80edb5debc46271d2281318a)
  - &nbsp;<Tag>修复</Tag> `AppDbContext` 默认租户属性受工作单元影响问题 [e51557f](https://gitee.com/dotnetchina/Furion/commit/e51557fdf37ae5646b2ea37c227c970eccdbed38)

- **文档**

  - &nbsp;<Tag>新增</Tag> 包管理工具文档
  - &nbsp;<Tag>更新</Tag> 模板引擎、`Sql` 操作，`数据库上下文` 等等文档

---

## v2.17（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `IPC（Inter-Process Communication，进程间通信）` 模块功能，目前提供进程内通信和共享内存进程外通讯 [ProcessChannel](https://gitee.com/dotnetchina/Furion/tree/v4/framework/Furion/ProcessChannel)
  - &nbsp;<Tag>新增</Tag> 远程请求 `application/xml` 和 `text/xml` 默认支持 [4753a1a](https://gitee.com/dotnetchina/Furion/commit/4753a1aed527a6282fe6c05036de9d50bd3b3dd8)
  - &nbsp;<Tag>新增</Tag> 控制台全局异常拦截 [4a4fe1f](https://gitee.com/dotnetchina/Furion/commit/4a4fe1f40e1856ea36a0c0d19ca625d3f7bf95b7)
  - &nbsp;<Tag>新增</Tag> 支持自定义 `.json` 配置文件扫描目录 [3e2910a](https://gitee.com/dotnetchina/Furion/commit/3e2910a8b775fb6323e293b020bbe7cdfb4c6436)
  - &nbsp;<Tag>新增</Tag> 支持数据库实体接口显式实现接口配置 [9610a0a](https://gitee.com/dotnetchina/Furion/commit/9610a0a481f4f78770bc2fc3ed4cabbef2a8f937)
  - &nbsp;<Tag>新增</Tag> 控制台应用程序全局拦截 `[IfException]` 支持 [4a4fe1f](https://gitee.com/dotnetchina/Furion/commit/4a4fe1f40e1856ea36a0c0d19ca625d3f7bf95b7)
  - &nbsp;<Tag>新增</Tag> 依赖注入模块接口可以限制实现类生存周期，实现类也支持复写生存周期 [d2ce089](https://gitee.com/dotnetchina/Furion/commit/d2ce089130300cdd8b1bc6792f325c5d38ee9404)

- **突破性变化**

  - &nbsp;<Tag>新增</Tag> `Oops.Retry()` 重试策略功能至新类：`Retry.Invoke()` [6a7bbd0](https://gitee.com/dotnetchina/Furion/commit/6a7bbd0b30a653b9a42d340a63520485aa6bbfa4)
  - &nbsp;<Tag>移除</Tag> ~~`IHttpContextAccessor.SigninToSwagger()` 拓展~~，请使用 `IHttpContextAccessor.HttpContext.SigninToSwagger()`，退出也一样
  - &nbsp;<Tag>移除</Tag> ~~全局处理 `Request Body` 重复读处理 `Request.EnableBuffering()`~~ [d92c24b](https://gitee.com/dotnetchina/Furion/commit/d92c24bdb43bfb01643007ebb6a4ee42a5c738e9)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 规范化状态码过滤逻辑错误问题 [#I44JYS](https://gitee.com/dotnetchina/Furion/issues/I44JYS)
  - &nbsp;<Tag>修复</Tag> 非关系型数据库（内存数据库）注册及操作异常 [e167651](https://gitee.com/dotnetchina/Furion/commit/e1676512a54374427bedbde17cd8cb59d7852557)
  - &nbsp;<Tag>修复</Tag> 远程请求默认序列化问题 [a55603b](https://gitee.com/dotnetchina/Furion/commit/a55603bf7ed109296375dbeffc31591a6f8f8e49)
  - &nbsp;<Tag>修复</Tag> 定时任务零点/整点提前一秒触发问题 [#I4321L](https://gitee.com/dotnetchina/Furion/issues/I4321L)
  - &nbsp;<Tag>修复</Tag> 友好异常在子类重写抽象类方法内部抛异常无法获取的问题 [4a4fe1f](https://gitee.com/dotnetchina/Furion/commit/4a4fe1f40e1856ea36a0c0d19ca625d3f7bf95b7)
  - &nbsp;<Tag>修复</Tag> 修复非 Web 项目抛异常问题 [4a4fe1f](https://gitee.com/dotnetchina/Furion/commit/4a4fe1f40e1856ea36a0c0d19ca625d3f7bf95b7)
  - &nbsp;<Tag>修复</Tag> 数据库实体模型贴 `[NotMapper]` 特性无效 [#I44MNO](https://gitee.com/dotnetchina/Furion/issues/I44MNO)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> Swagger 生成泛型 SchemaIds 默认连接符，由 `Of` 改为 `_` [81946b6](https://gitee.com/dotnetchina/Furion/commit/81946b64e81d9e290f80cd5bcebdb69c99001153)

---

## v2.16（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> **`MVC` 控制器支持规范化处理 [#I427Z2](https://gitee.com/dotnetchina/Furion/issues/I427Z2)**
  - &nbsp;<Tag>新增</Tag> `throw Oops.Bah()` 抛出业务异常（状态码 `400`）
  - &nbsp;<Tag>新增</Tag> `UnifyResultSettings` 规范化 `json` 配置选项 [#I42NY7](https://gitee.com/dotnetchina/Furion/issues/I42NY7)
  - &nbsp;<Tag>新增</Tag> 多语言自定义配置资源文件名及自定义程序集 [#I434YJ](https://gitee.com/dotnetchina/Furion/issues/I434YJ)

- **突破性变化**

  - &nbsp;<Tag>调整</Tag> 规范化结果 `IUnifyResultProvider` 参数 **（破坏性更改）** [#I427Z2](https://gitee.com/dotnetchina/Furion/issues/I427Z2)
  - &nbsp;<Tag>调整</Tag> `IJsonSerializerProvider` 接口参数，去掉 `inherit` 参数 [a55603b](https://gitee.com/dotnetchina/Furion/commit/a55603bf7ed109296375dbeffc31591a6f8f8e49)

<details style={{ marginLeft: 50 }}>
  <summary>查看变化</summary>
  <div>

:::important 新版本自定义规范化结果

```cs showLineNumbers  {15-16}
using Furion.DataValidation;
using Furion.DependencyInjection;
using Furion.UnifyResult.Internal;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.Filters;
using System;
using System.Threading.Tasks;

namespace Furion.UnifyResult
{
    /// <summary>
    /// RESTful 风格返回值
    /// </summary>
    [SuppressSniffer, UnifyModel(typeof(RESTfulResult<>))]
    public class RESTfulResultProvider : IUnifyResultProvider
    {
        /// <summary>
        /// 异常返回值
        /// </summary>
        /// <param name="context"></param>
        /// <param name="metadata"></param>
        /// <returns></returns>
        public IActionResult OnException(ExceptionContext context, ExceptionMetadata metadata)
        {
            return new JsonResult(RESTfulResult(metadata.StatusCode, errors: metadata.Errors));
        }

        /// <summary>
        /// 成功返回值
        /// </summary>
        /// <param name="context"></param>
        /// <param name="data"></param>
        /// <returns></returns>
        public IActionResult OnSucceeded(ActionExecutedContext context, object data)
        {
            return new JsonResult(RESTfulResult(StatusCodes.Status200OK, true, data));
        }

        /// <summary>
        /// 验证失败返回值
        /// </summary>
        /// <param name="context"></param>
        /// <param name="metadata"></param>
        /// <returns></returns>
        public IActionResult OnValidateFailed(ActionExecutingContext context, ValidationMetadata metadata)
        {
            return new JsonResult(RESTfulResult(StatusCodes.Status400BadRequest, errors: metadata.ValidationResult));
        }

        /// <summary>
        /// 特定状态码返回值
        /// </summary>
        /// <param name="context"></param>
        /// <param name="statusCode"></param>
        /// <param name="unifyResultSettings"></param>
        /// <returns></returns>
        public async Task OnResponseStatusCodes(HttpContext context, int statusCode, UnifyResultSettingsOptions unifyResultSettings)
        {
            // 设置响应状态码
            UnifyContext.SetResponseStatusCodes(context, statusCode, unifyResultSettings);

            switch (statusCode)
            {
                // 处理 401 状态码
                case StatusCodes.Status401Unauthorized:
                    await context.Response.WriteAsJsonAsync(RESTfulResult(statusCode, errors: "401 Unauthorized")
                        , App.GetOptions<JsonOptions>()?.JsonSerializerOptions);
                    break;
                // 处理 403 状态码
                case StatusCodes.Status403Forbidden:
                    await context.Response.WriteAsJsonAsync(RESTfulResult(statusCode, errors: "403 Forbidden")
                        , App.GetOptions<JsonOptions>()?.JsonSerializerOptions);
                    break;
                default: break;
            }
        }

        /// <summary>
        /// 返回 RESTful 风格结果集
        /// </summary>
        /// <param name="statusCode"></param>
        /// <param name="succeeded"></param>
        /// <param name="data"></param>
        /// <param name="errors"></param>
        /// <returns></returns>
        private static RESTfulResult<object> RESTfulResult(int statusCode, bool succeeded = default, object data = default, object errors = default)
        {
            return new RESTfulResult<object>
            {
                StatusCode = statusCode,
                Succeeded = succeeded,
                Data = data,
                Errors = errors,
                Extras = UnifyContext.Take(),
                Timestamp = DateTimeOffset.UtcNow.ToUnixTimeMilliseconds()
            };
        }
    }
}
```

:::

  </div>
</details>

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `MVC` 控制器启用规范化处理后返回 `new Json({})` 对象为 `null` 问题 [#I4354S](https://gitee.com/dotnetchina/Furion/issues/I4354S)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 多语言底层设计，取消需要创建 `Lang.cs` 空类的要求 [#I434YJ](https://gitee.com/dotnetchina/Furion/issues/I434YJ)
  - &nbsp;<Tag>更新</Tag> `MiniProfiler` 性能，减少不必要的监听

---

## v2.15（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `Db.GetDbRepository<定位器>()` 静态方法 [#I41MZP](https://gitee.com/dotnetchina/Furion/issues/I41MZP)
  - &nbsp;<Tag>新增</Tag> 远程请求缺省序列化配置选项 [#I41PBW](https://gitee.com/dotnetchina/Furion/issues/I41PBW)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 自动扫描接口进行依赖注入获取首个接口错误 bug [#I41D1M](https://gitee.com/dotnetchina/Furion/issues/I41D1M)
  - &nbsp;<Tag>修复</Tag> `IRepository<TEntity>` 没有实现 `IRepository<TEntity, TDbContextLocator>` 问题 [#I41MZP](https://gitee.com/dotnetchina/Furion/issues/I41MZP)
  - &nbsp;<Tag>修复</Tag> 远程请求缺省序列化 bug [#I41PBW](https://gitee.com/dotnetchina/Furion/issues/I41PBW)
  - &nbsp;<Tag>修复</Tag> 修复 `AppDbContext.Tenant` 多租户空异常问题 [#I421DA](https://gitee.com/dotnetchina/Furion/issues/I421DA)
  - &nbsp;<Tag>修复</Tag> `Worker Service` 多个 `Worker` 定时任务阻塞问题 [82a79cc](https://gitee.com/dotnetchina/Furion/commit/82a79cce0a3d9b09f4090b7363c3b78327c76846)
  - &nbsp;<Tag>修复</Tag> `Jwt` 自动刷新机制时区处理问题，主要针对国外用户 [#I41UB1](https://gitee.com/dotnetchina/Furion/issues/I41UB1) [82a79cc](https://gitee.com/dotnetchina/Furion/commit/82a79cce0a3d9b09f4090b7363c3b78327c76846)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> **系统启动性能，从 106M 减少到 84M**
  - &nbsp;<Tag>更新</Tag> **大量底层代码，包大小从 391Kb 减少到 350Kb（不带注释版本仅 64Kb）**

---

## v2.13/v2.14（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 简易字符串模板功能，支持远程请求、数据库模块、日志模块、事件总线模块、定时任务模块、异常模块、数据校验模块 [#I402BL](https://gitee.com/dotnetchina/Furion/issues/I402BL)
  - &nbsp;<Tag>新增</Tag> `404` 状态码规范化默认处理 [#I408F5](https://gitee.com/dotnetchina/Furion/issues/I408F5)
  - &nbsp;<Tag>新增</Tag> 定时任务 `ISpareTimeWorker` 声明方式支持异步方法 [#I40KWR](https://gitee.com/dotnetchina/Furion/issues/I40KWR)
  - &nbsp;<Tag>新增</Tag> 自动配置二级虚拟目录 [!354](https://gitee.com/dotnetchina/Furion/pulls/354)

- **突破性变化**

  - &nbsp;<Tag>升级</Tag> **框架依赖 `SDK` 为 `.NET 5.0.8` 版本**
  - &nbsp;<Tag>移除</Tag> ~~`Db.GetNewDbContext()` 静态方法~~ [#I400BK](https://gitee.com/dotnetchina/Furion/issues/I400BK)
  - &nbsp;<Tag>移除</Tag> ~~数据库模块时态表拓展支持~~ [#I405HI](https://gitee.com/dotnetchina/Furion/issues/I405HI)
  - &nbsp;<Tag>调整</Tag> `IJsonSerializerProvider` 接口参数，新增 `inherit` 参数 [#I3ZQU5](https://gitee.com/dotnetchina/Furion/issues/I3ZQU5)
  - &nbsp;<Tag>调整</Tag> `AppSettings` 配置的 `LogEntityFrameworkCoreSqlExecuteCommand` 名称为 `OutputOriginalSqlExecuteLog` [#I40VVE](https://gitee.com/dotnetchina/Furion/issues/I40VVE)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `Worker Services` 定时任务边界值问题导致跳过单次任务 [#I405NI](https://gitee.com/dotnetchina/Furion/issues/I405NI)
  - &nbsp;<Tag>修复</Tag> `Worker Services` 独立发布后程序集扫描失效 bug [#I3ZH3X](https://gitee.com/dotnetchina/Furion/issues/I3ZH3X)
  - &nbsp;<Tag>修复</Tag> 远程请求如果配置了 `Client` 客户端但传入了空 `RequestUrl` 地址导致异常问题 [#I40BC6](https://gitee.com/dotnetchina/Furion/issues/I40BC6)
  - &nbsp;<Tag>修复</Tag> 规范化结果篡改非短路端状态码出现异常 bug [#I408F5](https://gitee.com/dotnetchina/Furion/issues/I408F5)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> `App.GetServiceProvider(type)` 解析服务性能 [#I40KXN](https://gitee.com/dotnetchina/Furion/issues/I40KXN)
  - &nbsp;<Tag>调整</Tag> 视图引擎保存成文件流默认缓存区大小，从 `4096` 提升至 `8192` [#I40KH5](https://gitee.com/dotnetchina/Furion/issues/I40KH5)

---

## v2.10/2.11/2.12 （已发布）

> 该版本有多个破坏性更改，更新时请认真查看。

- **新特性**

  - &nbsp;<Tag>新增</Tag> `App.Configuration.Reload()` 拓展 [#I3XYI8](https://gitee.com/dotnetchina/Furion/issues/I3XYI8)
  - &nbsp;<Tag>新增</Tag> `ISubscribeHandler` 支持异步方法定义 [#I3XYHJ](https://gitee.com/dotnetchina/Furion/issues/I3XYHJ)
  - &nbsp;<Tag>新增</Tag> `app.UseUnifyResultStatusCodes()` 可配置修改返回状态码 [#I3VZQH](https://gitee.com/dotnetchina/Furion/issues/I3VZQH)
  - &nbsp;<Tag>新增</Tag> 远程请求添加默认 `User-Agent` 头 [#I3W17C](https://gitee.com/dotnetchina/Furion/issues/I3W17C)
  - &nbsp;<Tag>新增</Tag> 支持 `Sql` 高级代理切换数据库上下文定位器 [#I3XFP6](https://gitee.com/dotnetchina/Furion/issues/I3XFP6) [#I3XDCR](https://gitee.com/dotnetchina/Furion/issues/I3XDCR)
  - &nbsp;<Tag>新增</Tag> 定时任务 `CronFormat` 自动识别 [#I3Y7GT](https://gitee.com/dotnetchina/Furion/issues/I3Y7GT)
  - &nbsp;<Tag>新增</Tag> `Sql 高级代理` 拦截功能 [#I3YHG4](https://gitee.com/dotnetchina/Furion/issues/I3YHG4)
  - &nbsp;<Tag>新增</Tag> 拦截远程请求所有异常处理 [#I3YPDE](https://gitee.com/dotnetchina/Furion/issues/I3YPDE)
  - &nbsp;<Tag>新增</Tag> 远程请求配置 `Timeout` 超时时间 [#I3YPPK](https://gitee.com/dotnetchina/Furion/issues/I3YPPK)
  - &nbsp;<Tag>新增</Tag> 新增 `RSA` 加密算法 [#I3YZNU](https://gitee.com/dotnetchina/Furion/issues/I3YZNU) [!345](https://gitee.com/dotnetchina/Furion/pulls/345)
  - &nbsp;<Tag>新增</Tag> `DataTable` 和 `DataSet` 支持不指定强类型返回 [#I3Z6RI](https://gitee.com/dotnetchina/Furion/issues/I3Z6RI)
  - &nbsp;<Tag>新增</Tag> `Sql` 字符串拓展方法设置 `Timeout` 超时时间 [#I3ZKWF](https://gitee.com/dotnetchina/Furion/issues/I3ZKWF)
  - &nbsp;<Tag>新增</Tag> `Sql` 高级代理 `[Timeout]` 特性，设置超时时间 [#I3ZKWF](https://gitee.com/dotnetchina/Furion/issues/I3ZKWF)

- **突破性变化**

  - &nbsp;<Tag>移除</Tag> **`FakeDelete` 假删除/软删除所有功能 [#I3XKII](https://gitee.com/dotnetchina/Furion/issues/I3XKII)**
  - &nbsp;<Tag>移除</Tag> **移除 `PBKDF2` 加密算法 [#I3Z0IO](https://gitee.com/dotnetchina/Furion/issues/I3Z0IO)**
  - &nbsp;<Tag>调整</Tag> **远程请求设置超时时间单位由 `分钟` 改为 `秒` [#I3YPPK](https://gitee.com/dotnetchina/Furion/issues/I3YPPK)**
  - &nbsp;<Tag>调整</Tag> **`IJsonSerializerProvider` 接口参数，新增 `inherit` 参数 [#I3ZQU5](https://gitee.com/dotnetchina/Furion/issues/I3ZQU5)**
  - &nbsp;<Tag>调整</Tag> `[NonAutomatic]` 特性名称为 `[Manual]` [#I3XKKX](https://gitee.com/dotnetchina/Furion/issues/I3XKKX)
  - &nbsp;<Tag>调整</Tag> `[NotChangedListener]` 特性名称为 `[SuppressChangedListener]` [#I3XKLZ](https://gitee.com/dotnetchina/Furion/issues/I3XKLZ)
  - &nbsp;<Tag>调整</Tag> `[ManualSaveChanges]` 名称为 `[ManualCommit]` [#I3XKNP](https://gitee.com/dotnetchina/Furion/issues/I3XKNP)
  - &nbsp;<Tag>调整</Tag> **`DbContext.TenantIdQueryFilterExpression` 名称为 `DbContext.BuildTenantQueryFilter` [#I3XKTB](https://gitee.com/dotnetchina/Furion/issues/I3XKTB)**
  - &nbsp;<Tag>调整</Tag> `[SkipScan]` 名称为 `[SuppressSniffer]` [#I3XN5N](https://gitee.com/dotnetchina/Furion/issues/I3XN5N)
  - &nbsp;<Tag>调整</Tag> `[SkipProxy]` 名称为 `[SuppressProxy]` [#I3XN7O](https://gitee.com/dotnetchina/Furion/issues/I3XN7O)
  - &nbsp;<Tag>优化</Tag> `Sql` 执行，性能提升 20% [#I3W33U](https://gitee.com/dotnetchina/Furion/issues/I3W33U)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 动态 WebAPI 扫描控制器没有屏蔽没有注册的第三方控制器 [#I3Y7TJ](https://gitee.com/dotnetchina/Furion/issues/I3Y7TJ)
  - &nbsp;<Tag>修复</Tag> `AppDbContext` 设置 `TablePrefix` 无效： [#I3Y57Q](https://gitee.com/dotnetchina/Furion/issues/I3Y57Q)
  - &nbsp;<Tag>修复</Tag> 修复定时任务使用异步委托导致程序终止 bug [#I3XVZ0](https://gitee.com/dotnetchina/Furion/issues/I3XVZ0)
  - &nbsp;<Tag>修复</Tag> 事件总线一个 `消息id` 对应多个 `Handler` 只触发第一个[#I3XYP0](https://gitee.com/dotnetchina/Furion/issues/I3XYP0)
  - &nbsp;<Tag>修复</Tag> `.ToPagedList()` 分页方法传入小于或等于 0 的页码 [#I3XNAN](https://gitee.com/dotnetchina/Furion/issues/I3XNAN)
  - &nbsp;<Tag>修复</Tag> `JSON` 序列化默认 `DateTimeOffset` 异常 [#I3XMOL](https://gitee.com/dotnetchina/Furion/issues/I3XMOL)
  - &nbsp;<Tag>修复</Tag> 继承 `Serilog` 日志在 `Worker Service` 生成重复日志 bug [#I3WA0L](https://gitee.com/dotnetchina/Furion/issues/I3WA0L) [!331](https://gitee.com/dotnetchina/Furion/pulls/331)
  - &nbsp;<Tag>修复</Tag> `粘土对象` 动态添加 `Clay` 类型 bug [#I3W9LW](https://gitee.com/dotnetchina/Furion/issues/I3W9LW)
  - &nbsp;<Tag>修复</Tag> `ValidationTypes.Numeric` 校验数值类型正则表达式错误 [#I3WADS](https://gitee.com/dotnetchina/Furion/issues/I3WADS)
  - &nbsp;<Tag>修复</Tag> 数据库命令参数 `DbParameter` 的 `Value` 是 `object` 类型的时候且不指定 [#I3YKM6](https://gitee.com/dotnetchina/Furion/issues/I3YKM6)
  - &nbsp;<Tag>修复</Tag> `Oracle` 数据库存储过程 `游标参数` 报错问题 [#I3ZBYE](https://gitee.com/dotnetchina/Furion/issues/I3ZBYE)
  - &nbsp;<Tag>修复</Tag> `Worker Services` 采用独立发布后无法执行问题 [#I3ZH3X](https://gitee.com/dotnetchina/Furion/issues/I3ZH3X)
  - &nbsp;<Tag>修复</Tag> 修复远程请求如果无返回值序列化异常问题 [!348](https://gitee.com/dotnetchina/Furion/pulls/348)

- **其他更改**

  - &nbsp;<Tag>新增</Tag> 支持 `appsettings.json` 等自定义配置文件中文命名 [#I3YBFD](https://gitee.com/dotnetchina/Furion/issues/I3YBFD)
  - &nbsp;<Tag>更新</Tag> 远程请求配置命名客户端 `BaseAddress` 地址兼容处理 [#I3YCRH](https://gitee.com/dotnetchina/Furion/issues/I3YCRH)
  - &nbsp;<Tag>移除</Tag> 框架无用代码、优化代码
  - &nbsp;<Tag>更新</Tag> `Furion` 在 `非 Web` 环境下性能

- **文档变化**

  - &nbsp;<Tag>新增</Tag> 会话和状态管理 文档 [#I3YI3G](https://gitee.com/dotnetchina/Furion/issues/I3YI3G)
  - &nbsp;<Tag>更新</Tag> 远程请求、日志、数据库上下文、远程请求、`Sql` 高级代理文档
  - &nbsp;<Tag>更新</Tag> 配置文件 [#I3Y2EV](https://gitee.com/dotnetchina/Furion/issues/I3Y2EV)

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> `dapper` 多个数据源如何继承 [#I3WUOI](https://gitee.com/dotnetchina/Furion/issues/I3WUOI)
  - &nbsp;<Tag>答疑</Tag> 关于 `SpareTime` 多次执行问题[#I3XEQU](https://gitee.com/dotnetchina/Furion/issues/I3XEQU)
  - &nbsp;<Tag>答疑</Tag> 选项更改通知（热更新）：数据库里的数据更改了如何通知选项进行改变？ [#I3XYI8](https://gitee.com/dotnetchina/Furion/issues/I3XYI8)
  - &nbsp;<Tag>答疑</Tag> `SaaS` 多租户添加时无法获取租户`Id` [#I3Y5CF](https://gitee.com/dotnetchina/Furion/issues/I3Y5CF)
  - &nbsp;<Tag>答疑</Tag> 获取 `_httpContextAccessor.HttpContext` 为空[#I3Y6BI](https://gitee.com/dotnetchina/Furion/issues/I3Y6BI)
  - &nbsp;<Tag>答疑</Tag> `Ubuntu` 中使用 `App.Configuration` 方法读取不到值 [#I3Y74H](https://gitee.com/dotnetchina/Furion/issues/I3Y74H)
  - &nbsp;<Tag>答疑</Tag> 数据库上下文作用域问题 [#I3YHXP](https://gitee.com/dotnetchina/Furion/issues/I3YHXP)
  - &nbsp;<Tag>答疑</Tag> 使用 `UnitofWork` 提交事务，可以提交成功，但是系统会有错误 [#I3YIWU](https://gitee.com/dotnetchina/Furion/issues/I3YIWU)
  - &nbsp;<Tag>答疑</Tag> 数据库读写分离--非默认主库的从库随机该如何配置？ [#I3YVR7](https://gitee.com/dotnetchina/Furion/issues/I3YVR7)

---

## v2.9.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> **应用全局未托管资源监听，并实现特定时机释放非托管资源** [#I3VXAU](https://gitee.com/dotnetchina/Furion/issues/I3VXAU)
  - &nbsp;<Tag>新增</Tag> 不包含 `EntityFramework.Core` 版本的 `Furion.Pure` 包[#I3VGW8](https://gitee.com/dotnetchina/Furion/issues/I3VGW8)
  - &nbsp;<Tag>新增</Tag> swagger 支持设置多语言方式，设置的语言自动添加到 api 地址后面 [#I3VDTD](https://gitee.com/dotnetchina/Furion/issues/I3VDTD)
  - &nbsp;<Tag>新增</Tag> 动态 WebAPI 支持 `[FromRoute]` 非必填（选填）参数设置 [#I3VFIM](https://gitee.com/dotnetchina/Furion/issues/I3VFIM)
  - &nbsp;<Tag>新增</Tag> 动态 WebAPI 参数支持配置路由约束 [#I3VFIR](https://gitee.com/dotnetchina/Furion/issues/I3VFIR)
  - &nbsp;<Tag>新增</Tag> `MD5` 和 `DESC` 加密支持 `大写` 输出 [#326](https://gitee.com/dotnetchina/Furion/pulls/326)

- **突破性变化**

  - &nbsp;<Tag>新增</Tag> `Furion` 所有包生成 `.snupkg` 包，支持开发阶段直接调试 `Furion` 所有包源码 [#I3VFIX](https://gitee.com/dotnetchina/Furion/issues/I3VFIX)
  - &nbsp;<Tag>调整</Tag> `repository.BuildChange()` 方法的返回值，多返回一个 `IServiceScope` 对象 [#I3VX3D](https://gitee.com/dotnetchina/Furion/issues/I3VX3D)
  - &nbsp;<Tag>调整</Tag> `JWT` 刷新 `Token` 方法 `AutoRefreshToken` 参数 `days` 改为 `minutes` [#I3VXNB](https://gitee.com/dotnetchina/Furion/issues/I3VXNB)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `App.GetOptionsSnapshot<>` 从根服务解析异常 bug [#I3VS2X](https://gitee.com/dotnetchina/Furion/issues/I3VS2X)
  - &nbsp;<Tag>修复</Tag> 修复远程请求如果出现异常，返回 `Stream` 为 null 导致异常的问题 [#I3VSTU](https://gitee.com/dotnetchina/Furion/issues/I3VSTU)
  - &nbsp;<Tag>修复</Tag> 如果实体被跟踪后，无法执行删除操作 [#I3W08P](https://gitee.com/dotnetchina/Furion/issues/I3W08P)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 运行时内存，实现请求结束自动释放未托管资源 [#I3VXAU](https://gitee.com/dotnetchina/Furion/issues/I3VXAU)

- **文档变化**

  - &nbsp;<Tag>更新</Tag> `App` 静态类文档、远程请求文档、分表分库文档

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> 动态 WebAPI，自定义根据方法名生成 [HttpMethod] 规则报错 [#I3VKQG](https://gitee.com/dotnetchina/Furion/issues/I3VKQG)
  - &nbsp;<Tag>答疑</Tag> `InsertAsync` 的时候提示 `ID` 为空 [#I3VS7E](https://gitee.com/dotnetchina/Furion/issues/I3VS7E)
  - &nbsp;<Tag>答疑</Tag> `FirstOrDefault` 自动过滤了 `TanantId` 字段 [#I3W0VH](https://gitee.com/dotnetchina/Furion/issues/I3W0VH)
  - &nbsp;<Tag>答疑</Tag> 对方接口返回 `HttpConnectionResponseContent` 远程请求拿不到返回值 [#I3W17C](https://gitee.com/dotnetchina/Furion/issues/I3W17C)
  - &nbsp;<Tag>答疑</Tag> 查询方法 `FindOrDefault` 报错 [#I3W830](https://gitee.com/dotnetchina/Furion/issues/I3W830)
  - &nbsp;<Tag>答疑</Tag> `SqlNonQuery` 在 `UnitOfWork` 循环执行[#I3W8WW](https://gitee.com/dotnetchina/Furion/issues/I3W8WW)
  - &nbsp;<Tag>答疑</Tag> 因 `Swagger` 配置问题，导致 `Swagger` 中不能自动携带 token 授权的问题 [#I3W934](https://gitee.com/dotnetchina/Furion/issues/I3W934)
  - &nbsp;<Tag>答疑</Tag> 远程请求 `SetBody` 参数识别不了[#I3WBM1](https://gitee.com/dotnetchina/Furion/issues/I3WBM1)
  - &nbsp;<Tag>答疑</Tag> `Scoped.Create` 里执行 `sql.SqlNonQuery()` 或者 `obj.insert()` 问题[#I3WB5O](https://gitee.com/dotnetchina/Furion/issues/I3WB5O)
  - &nbsp;<Tag>答疑</Tag> 调用函数或存储过程，怎么出参数据自定义对象？如 `Oracle`数据库的数组或记录 [#I3W71W](https://gitee.com/dotnetchina/Furion/issues/I3W71W)

---

## v2.7.0/2.8.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `throw Oops.On("异常消息")` 应用多语言支持 [#I3UYC2](https://gitee.com/dotnetchina/Furion/issues/I3UYC2)
  - &nbsp;<Tag>新增</Tag> `Db.GetMSRepository()` 获取主从库仓储静态方法 [#I3UBSJ](https://gitee.com/dotnetchina/Furion/issues/I3UBSJ)
  - &nbsp;<Tag>新增</Tag> 工作单元特性，支持静态类强制性开启共享事务 [#I3S9N8](https://gitee.com/dotnetchina/Furion/issues/I3S9N8)
  - &nbsp;<Tag>新增</Tag> `EFCore` 执行 `sql` 模式打印日志 [#I3SE8X](https://gitee.com/dotnetchina/Furion/issues/I3SE8X)
  - &nbsp;<Tag>新增</Tag> 远程请求支持默认 `HttpClient` 配置 [#I3SI17](https://gitee.com/dotnetchina/Furion/issues/I3SI17)
  - &nbsp;<Tag>新增</Tag> 新增 `短 ID` 生成功能 [#I3T7JP](https://gitee.com/dotnetchina/Furion/issues/I3T7JP)
  - &nbsp;<Tag>新增</Tag> `[SensitiveDetection]` 支持配置替换敏感词汇 [#I3THIA](https://gitee.com/dotnetchina/Furion/issues/I3THIA)
  - &nbsp;<Tag>新增</Tag> `SpecificationDocumentBuilder.DocumentGroups` 和 `SpecificationDocumentBuilder.CheckApiDescriptionInCurrentGroup(currentGroup, apiDescription)` 公开方法[#I3UDSY](https://gitee.com/dotnetchina/Furion/issues/I3UDSY)

- **突破性变化**

  - &nbsp;<Tag>优化</Tag> 自动扫描 `.json` 和 `.xml` 文件并加载到配置中的代码和规则，同时移除默认 `.xml` 文件加载，只保留 `.json` 文件 [#I3UJ3L](https://gitee.com/dotnetchina/Furion/issues/I3UJ3L)
  - &nbsp;<Tag>优化</Tag> 分布式连续 `GUID` 代码 [#I3UBK0](https://gitee.com/dotnetchina/Furion/issues/I3UBK0)
  - &nbsp;<Tag>调整</Tag> **`Scoped.CreateUnitOfWork` 名称为 `Scoped.CreateUow` [#I3SJPU](https://gitee.com/dotnetchina/Furion/issues/I3SJPU)**
  - &nbsp;<Tag>调整</Tag> `JWTEncryption.Validate` 返回值，支持返回 `TokenValidationResult` [#I3S2ND](https://gitee.com/dotnetchina/Furion/issues/I3S2ND)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `[DataValidation]` 和 `[SensitiveDetection]` 多语言应用失效 [#I3UH6U](https://gitee.com/dotnetchina/Furion/issues/I3UH6U)
  - &nbsp;<Tag>修复</Tag> `Scoped` 系列方法异步出现 `Task is cancel` 情况 [#I3SJF6](https://gitee.com/dotnetchina/Furion/issues/I3SJF6)
  - &nbsp;<Tag>修复</Tag> `Mysql` 数据库的 `ToPagedList` 方法返回的结果进行遍历出现 `MySqlConnection is aleady use` 问题 [#I3SJQ3](https://gitee.com/dotnetchina/Furion/issues/I3SJQ3)
  - &nbsp;<Tag>修复</Tag> `tool/cli.psl` 没有包含项目名称 [#I3S1T6](https://gitee.com/dotnetchina/Furion/issues/I3S1T6)
  - &nbsp;<Tag>修复</Tag> 远程请求做上传文件时，没有传入 `Body`，程序直接跳过 [#I3TKFH](https://gitee.com/dotnetchina/Furion/issues/I3TKFH)
  - &nbsp;<Tag>修复</Tag> 远程请求 `multipart/form-data` 内容分割符缺失 [#I3TNO9](https://gitee.com/dotnetchina/Furion/issues/I3TNO9)
  - &nbsp;<Tag>修复</Tag> 远程请求代理拦截方式返回 `HttpResponseMessage` 问题 [#I3V161](https://gitee.com/dotnetchina/Furion/issues/I3V161)
  - &nbsp;<Tag>修复</Tag> `repository.Database.SetCommandTimeout(600)` 无法生效[#I3VAQS](https://gitee.com/dotnetchina/Furion/issues/I3VAQS)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 支持规范化结果中间件判断是否跳过规范化结果 [#I3T2AA](https://gitee.com/dotnetchina/Furion/issues/I3T2AA)
  - &nbsp;<Tag>调整</Tag> 更新部分列 `UpdateIncludeNowAsync` 具有二义性 [#I3RW9Q](https://gitee.com/dotnetchina/Furion/issues/I3RW9Q)
  - &nbsp;<Tag>更新</Tag> **框架底层性能，大大减少内存占用和溢出情况，启动内存从之前 `136M` 下将到 `86M`**
  - &nbsp;<Tag>优化</Tag> 删除无用代码，优化不规范命名等

- **文档变化**

  - &nbsp;<Tag>新增</Tag> `Inject` 说明文档 [#I3TITA](https://gitee.com/dotnetchina/Furion/issues/I3TITA)
  - &nbsp;<Tag>更新</Tag> 4.2.9 的示例代码文档，方法没有放在 class 中 [#I3S9T5](https://gitee.com/dotnetchina/Furion/issues/I3S9T5)
  - &nbsp;<Tag>修复</Tag> 规范化结果 6.5.6 多分组排序图片引用错误 [#I3UBOQ](https://gitee.com/dotnetchina/Furion/issues/I3UBOQ)
  - &nbsp;<Tag>更新</Tag> 静态类 `Scoped` 文档

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> 默认 `MasterDbContextLocator` 不随自定义的参数生成 [#I3SDBB](https://gitee.com/dotnetchina/Furion/issues/I3SDBB)
  - &nbsp;<Tag>答疑</Tag> 事件总线中订阅处理程序类获取不到用户信息，这个正常吗 [#I3SS0U](https://gitee.com/dotnetchina/Furion/issues/I3SS0U)
  - &nbsp;<Tag>答疑</Tag> 在有多租户过滤器的情况下，是否有一种方式查询全量的数据 [#I3T0VI](https://gitee.com/dotnetchina/Furion/issues/I3T0VI)
  - &nbsp;<Tag>答疑</Tag> mysql 使用 `&"tools/cli.ps1"` 页面化加载表结构失败 [#I3T4F8](https://gitee.com/dotnetchina/Furion/issues/I3T4F8)
  - &nbsp;<Tag>答疑</Tag> 其他 Web 层的 Startup 优先执行 [#I3T8IP](https://gitee.com/dotnetchina/Furion/issues/I3T8IP)
  - &nbsp;<Tag>答疑</Tag> 辅助角色服务实现建议 [#I3T906](https://gitee.com/dotnetchina/Furion/issues/I3T906)
  - &nbsp;<Tag>答疑</Tag> 开启 `easy connection` 后同一内网地址浏览器可以正常访问，远程请求则无法访问[#I3TA2U](https://gitee.com/dotnetchina/Furion/issues/I3TA2U)
  - &nbsp;<Tag>答疑</Tag> `scope.ServiceProvider.GetService<IOtherService>`不存在 [#I3TQMV](https://gitee.com/dotnetchina/Furion/issues/I3TQMV)
  - &nbsp;<Tag>答疑</Tag> 能否在 WPF 项目中使用呢？ [#I3TMCC](https://gitee.com/dotnetchina/Furion/issues/I3TMCC)
  - &nbsp;<Tag>答疑</Tag> `Dapper` 多个数据源 [#I3TM9B](https://gitee.com/dotnetchina/Furion/issues/I3TM9B)
  - &nbsp;<Tag>答疑</Tag> `L.GetSelectCulture()` 方法异常 [#I3TQS4](https://gitee.com/dotnetchina/Furion/issues/I3TQS4)
  - &nbsp;<Tag>答疑</Tag> 循环中使用 `IDGen.NextID()` 得到的结果并不是连续的 [#I3UAF6](https://gitee.com/dotnetchina/Furion/issues/I3UAF6)
  - &nbsp;<Tag>答疑</Tag> 模块化动态加载插件支持通配符匹配.dll [#I3UDT8](https://gitee.com/dotnetchina/Furion/issues/I3UDT8)
  - &nbsp;<Tag>答疑</Tag> `MVC` 模式，在 `Controller` 里快捷方式创建 `View` 页面出错 [#I3UFGB](https://gitee.com/dotnetchina/Furion/issues/I3UFGB)
  - &nbsp;<Tag>答疑</Tag> 数据库迁移没有种子数据 [#I3UI7G](https://gitee.com/dotnetchina/Furion/issues/I3UI7G)
  - &nbsp;<Tag>答疑</Tag> `SpareTimeAttribute` 中 根据 Cron 表达式 自动匹配 Cron 表达式格式化方式 [#I3UTKQ](https://gitee.com/dotnetchina/Furion/issues/I3UTKQ)
  - &nbsp;<Tag>答疑</Tag> 使用 `workService` 集成 `SqlSugar` 报错 [#I3V8HJ](https://gitee.com/dotnetchina/Furion/issues/I3V8HJ)
  - &nbsp;<Tag>答疑</Tag> `sqlserver 2008` 分页报错如何解决呢 [#I3VF96](https://gitee.com/dotnetchina/Furion/issues/I3VF96)

---

## v2.5.0/2.6.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 虚拟文件服务，支持物理文件和嵌入资源文件 [#I3RBR9](https://gitee.com/dotnetchina/Furion/issues/I3RBR9)
  - &nbsp;<Tag>新增</Tag> 读写分离/主从复制仓储 `IMSRepository` 和 `IMSRepository<TMasterDbContextLocator>` 仓储，可进行随机或自定义获取从库
  - &nbsp;<Tag>新增</Tag> 数据脱敏处理 [#I3R5ZF](https://gitee.com/dotnetchina/Furion/issues/I3R5ZF)

- **突破性变化**

  - &nbsp;<Tag>移除</Tag> **`InsertOrUpdate` 一系列数据库操作方法** [#I3RI9L](https://gitee.com/dotnetchina/Furion/issues/I3RI9L)
  - &nbsp;<Tag>移除</Tag> 所有包含 `Exists` 单词的数据库操作方法 [#I3RJ0T](https://gitee.com/dotnetchina/Furion/issues/I3RJ0T)
  - &nbsp;<Tag>调整</Tag> 分布式 GUID `IDGenerater` 静态类名称为 `IDGen` [#I3RGUA](https://gitee.com/dotnetchina/Furion/issues/I3RGUA)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 远程调用方法错误，请求报文头 `Headers` 不能添加到 `IHttpDispatchProxy` 的子接口上 [#I3RAF7](https://gitee.com/dotnetchina/Furion/issues/I3RAF7)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 应用启动性能，减少内存分配

- **文档变化**

  - &nbsp;<Tag>新增</Tag> 脱敏处理文档 [#I3R6WZ](https://gitee.com/dotnetchina/Furion/issues/I3R6WZ)
  - &nbsp;<Tag>新增</Tag> 文件系统文档、`FS` 静态类文档 [#I3RCC4](https://gitee.com/dotnetchina/Furion/issues/I3RCC4)
  - &nbsp;<Tag>更新</Tag> 读写分离/主从复制、数据库仓储文档、`Db` 静态类 [#I3R3B6](https://gitee.com/dotnetchina/Furion/issues/I3R3B6)

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> 关于 `Furion` 集群部署 [#I3R3J4](https://gitee.com/dotnetchina/Furion/issues/I3R3J4)
  - &nbsp;<Tag>答疑</Tag> 升级最新框架以后， 数据库生成模型报错 [#I3R7TP](https://gitee.com/dotnetchina/Furion/issues/I3R7TP)
  - &nbsp;<Tag>答疑</Tag> 数据库上下文事务执行中，`SaveNow` 执行后有警告 [#I3RAJI](https://gitee.com/dotnetchina/Furion/issues/I3RAJI)
  - &nbsp;<Tag>答疑</Tag> `Hangfire` 使用事务出现错误 [#I3ROQ5](https://gitee.com/dotnetchina/Furion/issues/I3ROQ5)
  - &nbsp;<Tag>答疑</Tag> 如何实现 cli 不执行某些表的迁移，web 请求可以正常操作呢？ [#I3ROU5](https://gitee.com/dotnetchina/Furion/issues/I3ROU5)
  - &nbsp;<Tag>答疑</Tag> 在使用定时任务时候出现的问题：继承 `ISpareTimeWorker` [#I3RRZS](https://gitee.com/dotnetchina/Furion/issues/I3RRZS)
  - &nbsp;<Tag>答疑</Tag> `MySql` 时间差 8 小时处理 [#I3RSCO](https://gitee.com/dotnetchina/Furion/issues/I3RSCO)
  - &nbsp;<Tag>答疑</Tag> `Db.GetRepository<>` 方法结合 `[UnitOfWork]` 后不可用 [#I3RUK5](https://gitee.com/dotnetchina/Furion/issues/I3RUK5)
  - &nbsp;<Tag>答疑</Tag> 事务开启失败问题 [#I3RYJY](https://gitee.com/dotnetchina/Furion/issues/I3RYJY)
  - &nbsp;<Tag>答疑</Tag> 支持 `DbProvider` 可动态配置 [#I3RYPE](https://gitee.com/dotnetchina/Furion/issues/I3RYPE)
  - &nbsp;<Tag>答疑</Tag> `WorkService` 依赖注入 `ISingleton` 问题 [#I3RZ1L](https://gitee.com/dotnetchina/Furion/issues/I3RZ1L)
  - &nbsp;<Tag>答疑</Tag> `ISpareTimeWorker` 运行期动态修改 [#I3S33Q](https://gitee.com/dotnetchina/Furion/issues/I3S33Q)

---

## v2.4.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 支持自动加载模块化/插件 `.xml` 注释文件 [#I3Q7XY](https://gitee.com/dotnetchina/Furion/issues/I3Q7XY)
  - &nbsp;<Tag>新增</Tag> `AppDbContext.FailedAutoRollback` 属性，可配置事务是否自动回滚 [#I3QOUS](https://gitee.com/dotnetchina/Furion/issues/I3QOUS)

- **突破性变化**

  - &nbsp;<Tag>升级</Tag> **.NET 5 SDK 为 5.0.6 版本**
  - &nbsp;<Tag>新增</Tag> `IJsonSerializerProvider.GetSerializerOptions()` 接口方法 [#I3QIJN](https://gitee.com/dotnetchina/Furion/issues/I3QIJN)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 通过 `services.AddInject()` 方式注册，模块化/插件不加载 [#I3Q7XH](https://gitee.com/dotnetchina/Furion/issues/I3Q7XH)
  - &nbsp;<Tag>修复</Tag> 种子数据返回 `null` 报空异常 [#I3QCM5](https://gitee.com/dotnetchina/Furion/issues/I3QCM5)
  - &nbsp;<Tag>修复</Tag> 通过 `Clay.Object` 创建粘土对象后属性变小写问题 [#I3QRV3](https://gitee.com/dotnetchina/Furion/issues/I3QRV3)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> `Furion` 框架底层性能，减少内存占用，提高应用初始化速度 [92f8cc1](https://gitee.com/dotnetchina/Furion/commit/92f8cc1)

- **文档变化**

  - &nbsp;<Tag>更新</Tag> JSON 序列化文档、规范化结果文档、数据库上下文文档

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> `InsertOrUpdateNowAsync` 报错 [#I3QKO5](https://gitee.com/dotnetchina/Furion/issues/I3QKO5)

---

## v2.3.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `Furion.Extras.DatabaseAccessor.MongoDB` 拓展包支持 [#I3PKST](https://gitee.com/dotnetchina/Furion/issues/I3PKST)
  - &nbsp;<Tag>新增</Tag> 动态粘土类型直接转 `object` 或 `dynamic` 类型 [#I3OY27](https://gitee.com/dotnetchina/Furion/issues/I3OY27)
  - &nbsp;<Tag>新增</Tag> 新增 `Oops.Retry` 方法，支持设置方法调用失败进行重试 [#I3PJKQ](https://gitee.com/dotnetchina/Furion/issues/I3PJKQ)
  - &nbsp;<Tag>新增</Tag> `JWTSettings` 配置节点 `Algorithm`，用于配置加密算法 [#I3PQGV](https://gitee.com/dotnetchina/Furion/issues/I3PQGV)
  - &nbsp;<Tag>新增</Tag> `repository.EnsureTransaction()` 方法确保工作单元事务有效 [#I3PVF1](https://gitee.com/dotnetchina/Furion/issues/I3PVF1)

- **突破性变化**

  - &nbsp;<Tag>新增</Tag> 支持 .NET 6.0.0 Preview 3 版本 [#I3P2C7](https://gitee.com/dotnetchina/Furion/issues/I3P2C7)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 使用数据库生成模型 `tools/cli.ps1`，从数据库表生成的实体异常 [#I3PL18](https://gitee.com/dotnetchina/Furion/issues/I3PL18)
  - &nbsp;<Tag>修复</Tag> 贴了 `[NonUntify]` 特性后，`Swagger` 的 `Example Value` 没有匹配正确 [#I3PK0L](https://gitee.com/dotnetchina/Furion/issues/I3PK0L)
  - &nbsp;<Tag>修复</Tag> `SpareTimer.Tally` 在 `Cron` 表达式中计数无效 [#I3PWSE](https://gitee.com/dotnetchina/Furion/issues/I3PWSE)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 框架默认序列化应该从配置中读取，而非手动编写 [#I3P1SJ](https://gitee.com/dotnetchina/Furion/issues/I3P1SJ)
  - &nbsp;<Tag>更新</Tag> `SqlSugar` 拓展库，支持非泛型仓储获取上下文操作对象 [#I3PK2N](https://gitee.com/dotnetchina/Furion/issues/I3PK2N)
  - &nbsp;<Tag>更新</Tag> 支持分布式内存缓存可配置化 [#I3POKD](https://gitee.com/dotnetchina/Furion/issues/I3POKD)

- **文档变化**

  - &nbsp;<Tag>文档</Tag> 添加 `JWTSettings` 配置独立文档 [#I3PQGW](https://gitee.com/dotnetchina/Furion/issues/I3PQGW)

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> 软删除如果数据不存在，则报错 [#I3PTVB](https://gitee.com/dotnetchina/Furion/issues/I3PTVB)
  - &nbsp;<Tag>答疑</Tag> 多个类集成测试会造成数据库定位器多次注册，无法运行所有测试，只能一个类一个类的运行 [#I3PXGY](https://gitee.com/dotnetchina/Furion/issues/I3PXGY)

---

## v2.2.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `Clay` 粘土类型，支持让 `C#` 创建一个弱类型对象并操作弱类型 [#I3O2QQ](https://gitee.com/dotnetchina/Furion/issues/I3O2QQ)
  - &nbsp;<Tag>新增</Tag> 新增 `Scoped.Create` 带返回值重载 [#I3O47J](https://gitee.com/dotnetchina/Furion/issues/I3O47J)
  - &nbsp;<Tag>新增</Tag> 支持 `Scoped.Create()` 一系列方法支持传入作用域工厂 [#I3OAP5](https://gitee.com/dotnetchina/Furion/issues/I3OAP5)
  - &nbsp;<Tag>新增</Tag> 支持事件总线同步执行方式 [#I3OAW2](https://gitee.com/dotnetchina/Furion/issues/I3OAW2)
  - &nbsp;<Tag>新增</Tag> `[DataValidation]` 跳过空字符串和空值验证 [#I3OGEN](https://gitee.com/dotnetchina/Furion/issues/I3OGEN)
  - &nbsp;<Tag>新增</Tag> `Worker Service` 可配置是否自动注册 `Worker` [#I3OLW4](https://gitee.com/dotnetchina/Furion/issues/I3OLW4)

- **突破性变化**

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 定时任务设置 `cancelInNoneNextTime: false` 一次也不执行 [#I3O3N0](https://gitee.com/dotnetchina/Furion/issues/I3O3N0)
  - &nbsp;<Tag>修复</Tag> SpareTime 自定义下次执行时间出现空异常 [#I3O46X](https://gitee.com/dotnetchina/Furion/issues/I3O46X)
  - &nbsp;<Tag>修复</Tag> `MiniProfiler` 设置为 `false` 时，数据库上下文提交拦截器未添加 [#I3OAWX](https://gitee.com/dotnetchina/Furion/issues/I3OAWX)
  - &nbsp;<Tag>修复</Tag> `[Consumes("application/x-www-form-urlencoded")]` 和 `ModelQuery` 配置同时配置导致空引用问题 [#I3ODUR](https://gitee.com/dotnetchina/Furion/issues/I3ODUR)
  - &nbsp;<Tag>修复</Tag> 在 Grpc 中使用 jwt 授权出现空异常 [#I3OW3I](https://gitee.com/dotnetchina/Furion/issues/I3OW3I)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 支持发布后代码精简配置，减少不必要的文件夹输出 [#I3OAPF](https://gitee.com/dotnetchina/Furion/issues/I3OAPF)
  - &nbsp;<Tag>更新</Tag> 自动刷新 Token 机制，新增容错值处理，解决并发 Token 刷新失败问题 [#I3OGYF](https://gitee.com/dotnetchina/Furion/issues/I3OGYF)

- **文档变化**

  - &nbsp;<Tag>新增</Tag> 粘土对象文档 [#I3OG18](https://gitee.com/dotnetchina/Furion/issues/I3OG18)

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> 动态 WebAPI 如何获取接收文件 [#I3O29B](https://gitee.com/dotnetchina/Furion/issues/I3O29B)
  - &nbsp;<Tag>答疑</Tag> 定时任务使用 `Scope.CreateUow` 引发的问题 [#I3O2CD](https://gitee.com/dotnetchina/Furion/issues/I3O2CD)
  - &nbsp;<Tag>答疑</Tag> 单文件发布程序工作不正常 [#I3O4D8](https://gitee.com/dotnetchina/Furion/issues/I3O4D8)
  - &nbsp;<Tag>答疑</Tag> 同时配置租户过滤器和软删除过滤器，最终的 sql 只生成了一种过滤条件 [#I3OB0A](https://gitee.com/dotnetchina/Furion/issues/I3OB0A)
  - &nbsp;<Tag>答疑</Tag> HTTP 重定向 HTTPS 后跨域失效 [#I3OB8R](https://gitee.com/dotnetchina/Furion/issues/I3OB8R)
  - &nbsp;<Tag>答疑</Tag> 在 PostgreSql 数据库使用 `rep.FirstOrDefault(u => u.Id == UserId);` 引起异常 [#I3O5OF](https://gitee.com/dotnetchina/Furion/issues/I3O5OF)
  - &nbsp;<Tag>答疑</Tag> 定时任务有时能触发有时不能触发 [#I3ORBE](https://gitee.com/dotnetchina/Furion/issues/I3ORBE)

---

## v2.1.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 新增定时任务 `ISpareTimeWorker` 方式支持 `[SpareTime("{配置路径}}]` 方式 [#I3NTUX](https://gitee.com/dotnetchina/Furion/issues/I3NTUX)
  - &nbsp;<Tag>新增</Tag> 定时任务支持异步委托 [#I3NP96](https://gitee.com/dotnetchina/Furion/issues/I3NP96)
  - &nbsp;<Tag>新增</Tag> 轻量级分布式连续 GUID 生成器 [#I3NKLZ](https://gitee.com/dotnetchina/Furion/issues/I3NKLZ)
  - &nbsp;<Tag>新增</Tag> `ClayObject` 模块，处理 `ExpandoObject` 及 `IDictionary<string,object>` 类型 [#I3N3J4](https://gitee.com/dotnetchina/Furion/issues/I3N3J4)
  - &nbsp;<Tag>新增</Tag> `Scoped.CreateUow(handler)` 创建作用域并自动提交数据库更改方法 [#I3NU3G](https://gitee.com/dotnetchina/Furion/issues/I3NU3G)

- **突破性变化**

  - &nbsp;<Tag>调整</Tag> 规范化结果接口 `OnResponseStatusCodes` 方法，新增 `UnifyResultStatusCodesOptions` 参数 [#I3NDB9](https://gitee.com/dotnetchina/Furion/issues/I3NDB9)
  - &nbsp;<Tag>移除</Tag> **雪花 ID 实现代码 [#I3NKLZ](https://gitee.com/dotnetchina/Furion/issues/I3NKLZ)**

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `Swagger` 不能支持非 int 类型的枚举 [#I3NQM8](https://gitee.com/dotnetchina/Furion/issues/I3NQM8)
  - &nbsp;<Tag>修复</Tag> 数据库线程池多线程并发问题 [#I3NR4L](https://gitee.com/dotnetchina/Furion/issues/I3NR4L)
  - &nbsp;<Tag>修复</Tag> 自定义控制器路由后且为方法参数指定了 `[ApiSeat]` 后生成路由重复 [#I3NRF6](https://gitee.com/dotnetchina/Furion/issues/I3NRF6)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 支持应用启动的时候迁移种子数据 [#I3NH3M](https://gitee.com/dotnetchina/Furion/issues/I3NH3M)

- **文档变化**

  - &nbsp;<Tag>新增</Tag> 分布式 ID 生成文档 [#I3B6CX](https://gitee.com/dotnetchina/Furion/issues/I3B6CX)
  - &nbsp;<Tag>新增</Tag> 新增模块化开发文档 [#I3NSUS](https://gitee.com/dotnetchina/Furion/issues/I3NSUS)
  - &nbsp;<Tag>更新</Tag> 20.4 字符串拓展方式 > 错误`ToAESDecrypt` 写成了 `ToToAESDecrypt` [#](https://gitee.com/dotnetchina/Furion/issues/I3NNKV)

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> 有关【定时任务/委托】的疑问 [#I3N3EW](https://gitee.com/dotnetchina/Furion/issues/I3N3EW)
  - &nbsp;<Tag>答疑</Tag> 统一返回格式支持自定义 [#I3NU1G](https://gitee.com/dotnetchina/Furion/issues/I3NU1G)

---

## v2.0.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 控制台应用程序及 Worker Services 支持 [#I3K4DG](https://gitee.com/dotnetchina/Furion/issues/I3K4DG)
  - &nbsp;<Tag>新增</Tag> 完整任务调度功能 [#I3IRUX](https://gitee.com/dotnetchina/Furion/issues/I3IRUX)
  - &nbsp;<Tag>新增</Tag> `Cron` 表达式解析 [#I3IQ9Y](https://gitee.com/dotnetchina/Furion/issues/I3IQ9Y)
  - &nbsp;<Tag>新增</Tag> 支持 `Swagger` 自定义配置 `swagger.json` 地址模板 [#I3IHMX](https://gitee.com/dotnetchina/Furion/issues/I3IHMX)
  - &nbsp;<Tag>新增</Tag> 支持配置动态 WebApi 区域 [#I3IJAZ](https://gitee.com/dotnetchina/Furion/issues/I3IJAZ)
  - &nbsp;<Tag>新增</Tag> 远程请求新增支持传入服务提供器 `IServiceProvider` [#I3IVBL](https://gitee.com/dotnetchina/Furion/issues/I3IVBL)
  - &nbsp;<Tag>新增</Tag> 全局配置选型 `SupportPackageNamePrefixs` 配置，支持配置包前缀 [#I3K0SN](https://gitee.com/dotnetchina/Furion/issues/I3K0SN)
  - &nbsp;<Tag>新增</Tag> 应用启动时支持 `referenceassembly` 类型程序集扫描 [#I3K0SN](https://gitee.com/dotnetchina/Furion/issues/I3K0SN)
  - &nbsp;<Tag>新增</Tag> 依赖注入 `AOP` 拦截获取方法真实特性 [#I3LZBX](https://gitee.com/dotnetchina/Furion/issues/I3LZBX)
  - &nbsp;<Tag>新增</Tag> EFCore 手动 `SaveChanges()` 特性 [#I3N01Y](https://gitee.com/dotnetchina/Furion/issues/I3N01Y)
  - &nbsp;<Tag>新增</Tag> 支持 `Cors` 跨域更多配置 [#I3N2J0](https://gitee.com/dotnetchina/Furion/issues/I3N2J0)

- **突破性变化**

  - &nbsp;<Tag>优化</Tag> 完整任务调度功能 [#I3IRUX](https://gitee.com/dotnetchina/Furion/issues/I3IRUX)
  - &nbsp;<Tag>优化</Tag> 日志模块功能 [#I3J2K0](https://gitee.com/dotnetchina/Furion/issues/I3J2K0)
  - &nbsp;<Tag>优化</Tag> 模板引擎功能 [#I3J46E](https://gitee.com/dotnetchina/Furion/issues/I3J46E)
  - &nbsp;<Tag>优化</Tag> 底层 `EFCoreRepository` 仓储 [#I3J6W5](https://gitee.com/dotnetchina/Furion/issues/I3J6W5)
  - &nbsp;<Tag>优化</Tag> sql 字符串拓展底层代码 [#I3IVCE](https://gitee.com/dotnetchina/Furion/issues/I3IVCE)
  - &nbsp;<Tag>优化</Tag> 底层 `SqlRepository` 所有逻辑代码 [#I3J6V6](https://gitee.com/dotnetchina/Furion/issues/I3J6V6)
  - &nbsp;<Tag>优化</Tag> 数据库实体拓展方法 [#I3J609](https://gitee.com/dotnetchina/Furion/issues/I3J609)
  - &nbsp;<Tag>调整</Tag> 事件事件总线同步执行为异步方式执行 [#I3J0WA](https://gitee.com/dotnetchina/Furion/issues/I3J0WA)
  - &nbsp;<Tag>移除</Tag> 框架底层 `HttpContext.IsAjaxRequest()` 拓展 [#I3IVAA](https://gitee.com/dotnetchina/Furion/issues/I3IVAA)
  - &nbsp;<Tag>移除</Tag> `ValidationTypes.Required` 验证 [#I3KR85](https://gitee.com/dotnetchina/Furion/issues/I3KR85)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 关闭 `InjectMiniProfiler` 参数后内存缓存无效 [#I3IHLR](https://gitee.com/dotnetchina/Furion/issues/I3IHLR)
  - &nbsp;<Tag>修复</Tag> 在多租户中调用 `Tenant` 属性出现偶然性数据库上下文被释放的情况 [#I3IC70](https://gitee.com/dotnetchina/Furion/issues/I3IC70)
  - &nbsp;<Tag>修复</Tag> Sql 代理中如果返回基元类型抛出不能将 object 转换成对应类型的异常 [#I3IC84](https://gitee.com/dotnetchina/Furion/issues/I3IC84)
  - &nbsp;<Tag>修复</Tag> 存储过程多返回值的时候，outputvalues 的 name 不是定义的 MSG 的 name，是 Msg 类型。 [#I3IC7Y](https://gitee.com/dotnetchina/Furion/issues/I3IC7Y)
  - &nbsp;<Tag>修复</Tag> PhoneNumber 手机号验证正则表达式错误 [#I3ID10](https://gitee.com/dotnetchina/Furion/issues/I3ID10)
  - &nbsp;<Tag>修复</Tag> 依赖注入 AOP 拦截无法捕获内部异常 [#I3IGCC](https://gitee.com/dotnetchina/Furion/issues/I3IGCC)
  - &nbsp;<Tag>修复</Tag> 全局拦截标记异常已被处理后异常过滤器依然执行 [#I3J463](https://gitee.com/dotnetchina/Furion/issues/I3J463)
  - &nbsp;<Tag>修复</Tag> 自定义全局异常拦截器不起作用 [#I3K1SJ](https://gitee.com/dotnetchina/Furion/issues/I3K1SJ)
  - &nbsp;<Tag>修复</Tag> 在 WorkerService 模式下，还是使用 WebHostEnvironment 来判断 Host 环境，会导致错误 [#I3LCQY](https://gitee.com/dotnetchina/Furion/issues/I3LCQY)
  - &nbsp;<Tag>修复</Tag> 定时任务 `DoOnce` 抛空异常 bug [#I3M0ZT](https://gitee.com/dotnetchina/Furion/issues/I3M0ZT)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 启动时程序集扫描类型 [#I3K0SN](https://gitee.com/dotnetchina/Furion/issues/I3K0SN)
  - &nbsp;<Tag>更新</Tag> `App.GetConfig<>("key")` 不支持获取单个值问题 [#I3ILF1](https://gitee.com/dotnetchina/Furion/issues/I3ILF1)
  - &nbsp;<Tag>更新</Tag> UrlEncode 应该用 `Uri.EscapeDataString()` 而不是 `HttpUtility.UrlEncode` [#I3ICTK](https://gitee.com/dotnetchina/Furion/issues/I3ICTK)

- **文档变化**

  - &nbsp;<Tag>新增</Tag> 定位任务、后台任务文档 [#I3JHHG](https://gitee.com/dotnetchina/Furion/issues/I3JHHG)
  - &nbsp;<Tag>新增</Tag> 辅助角色服务文档 [#I3K5GN](https://gitee.com/dotnetchina/Furion/issues/I3K5GN)
  - &nbsp;<Tag>更新</Tag> 动态 WebAPI、规范化文档、数据库上下文文档

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> 数据校验，自定义 ErrorMessage 无效问题 [#I3ICL3](https://gitee.com/dotnetchina/Furion/issues/I3ICL3)
  - &nbsp;<Tag>答疑</Tag> 最新 issue 中新增的“新增常用的 JSON 序列化方法” 会导致 AOP 拦截异常 [#I3I7VE](https://gitee.com/dotnetchina/Furion/issues/I3I7VE)
  - &nbsp;<Tag>答疑</Tag> Furion.DatabaseAccessor.PrivateEntityBase 中的 TenantId 数据类型设置为 object [#I3IQV6](https://gitee.com/dotnetchina/Furion/issues/I3IQV6)
  - &nbsp;<Tag>答疑</Tag> 有关异常拦截和处理的疑问 [#I3IUFZ](https://gitee.com/dotnetchina/Furion/issues/I3IUFZ)
  - &nbsp;<Tag>答疑</Tag> `DataValidation` 在空值的情况下被忽略掉了[#I3IWSM](https://gitee.com/dotnetchina/Furion/issues/I3IWSM)
  - &nbsp;<Tag>答疑</Tag> 日志文档没有更新 [#I3J1DX](https://gitee.com/dotnetchina/Furion/issues/I3J1DX)
  - &nbsp;<Tag>答疑</Tag> 对于 webapi 简单类型参数，是否可以以 json 方式提交 [#I3J18I](https://gitee.com/dotnetchina/Furion/issues/I3J18I)
  - &nbsp;<Tag>答疑</Tag> `IUnifyResultProvider` 实现中如果 `UnifyModel` 的 type 不是范型会报错 [#I3JBXF](https://gitee.com/dotnetchina/Furion/issues/I3JBXF)
  - &nbsp;<Tag>答疑</Tag> 如何模块化开发新功能？ [#I3J7ZZ](https://gitee.com/dotnetchina/Furion/issues/I3J7ZZ)
  - &nbsp;<Tag>答疑</Tag> 建议增加微服务中间件的集成 [#I3JTZQ](https://gitee.com/dotnetchina/Furion/issues/I3JTZQ)
  - &nbsp;<Tag>答疑</Tag> 二级虚拟目录部署的 swagger 的 MiniProfiler js 报错 [#I3IWLR](https://gitee.com/dotnetchina/Furion/issues/I3IWLR)

---

## v1.19.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `EFCore 5.0` 支持 **SqlServer 2005-2008** 数据库 [#I3HZZ6](https://gitee.com/dotnetchina/Furion/issues/I3HZZ6)
  - &nbsp;<Tag>新增</Tag> `Sql` 高级代理支持模板替换了 [#I3HHWU](https://gitee.com/dotnetchina/Furion/issues/I3HHWU) [#I3HH2T](https://gitee.com/dotnetchina/Furion/issues/I3HH2T)
  - &nbsp;<Tag>新增</Tag> `PBKDF2` 加密 [#I3HN7A](https://gitee.com/dotnetchina/Furion/issues/I3HN7A)
  - &nbsp;<Tag>新增</Tag> 常用的 `JSON` 操作方法 [#I3HUYO](https://gitee.com/dotnetchina/Furion/issues/I3HUYO)
  - &nbsp;<Tag>新增</Tag> 所有解析服务的方法都支持传入 `IServiceProvidier` 参数 [#I3HXEU](https://gitee.com/dotnetchina/Furion/issues/I3HXEU)

- **突破性变化**

  - &nbsp;<Tag>升级</Tag> .NET 5 SDK 至 5.0.5 版本

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 远程请求 `application/x-www-form-urlencoded` 自动被转码了 [#I3HDPC](https://gitee.com/dotnetchina/Furion/issues/I3HDPC)
  - &nbsp;<Tag>修复</Tag> `ISqlDispatchProxy` 调用带返回值的存储过程出错 [#I3HISS](https://gitee.com/dotnetchina/Furion/issues/I3HISS)
  - &nbsp;<Tag>修复</Tag> 多数据库工作单元异常无法回滚数据 [#I3I2KN](https://gitee.com/dotnetchina/Furion/issues/I3I2KN) [#I3HYN5](https://gitee.com/zuohuaijun/Admin.NET/issues/I3HYN5)
  - &nbsp;<Tag>修复</Tag> Serilog 日志生成太多文件 [#I3I2PN](https://gitee.com/dotnetchina/Furion/issues/I3I2PN)
  - &nbsp;<Tag>修复</Tag> `1.18.0` 版本数据库连接池存在连接泄漏问题 [#I3I5KO](https://gitee.com/dotnetchina/Furion/issues/I3I5KO)
  - &nbsp;<Tag>修复</Tag> Sqlite 提示事务已完成异常 [#I3I9F2](https://gitee.com/dotnetchina/Furion/issues/I3I9F2)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 视图模板功能，默认支持可枚举泛型类型 [#I3GYEE](https://gitee.com/dotnetchina/Furion/issues/I3GYEE)
  - &nbsp;<Tag>更新</Tag> 开发阶段 MiniProfiler 打印数据库相关信息 [#I3I8VQ](https://gitee.com/dotnetchina/Furion/issues/I3I8VQ)
  - &nbsp;<Tag>更新</Tag> EFCore 5.0 未提供 Sqlite 数据库 DataAdapter 的支持 [#I3I9FC](https://gitee.com/dotnetchina/Furion/issues/I3I9FC)

- **文档变化**

  - &nbsp;<Tag>更新</Tag> 数据库上下文、多租户、仓储、日志、序列化等文档。

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> 建议 MVC 模式下增加 Furion 的功能 [#I3GY4R](https://gitee.com/dotnetchina/Furion/issues/I3GY4R)
  - &nbsp;<Tag>答疑</Tag> 数据库关联操作 [#I3H5QP](https://gitee.com/dotnetchina/Furion/issues/I3H5QP)
  - &nbsp;<Tag>答疑</Tag> 1.17.5 版本 suagger 无法生成 swagger.json [#I3HGPZ](https://gitee.com/dotnetchina/Furion/issues/I3HGPZ)
  - &nbsp;<Tag>答疑</Tag> Serilog 扩展+dll 启动与 swagger 的 MiniProfiler 冲突 [#I3HWJM](https://gitee.com/dotnetchina/Furion/issues/I3HWJM)
  - &nbsp;<Tag>答疑</Tag> Sql 高级代理返回 DataTable 时，结果为空取不到记录 [#I3HUWG](https://gitee.com/dotnetchina/Furion/issues/I3HUWG)
  - &nbsp;<Tag>答疑</Tag> Task.Run 操作数据库问题 [#I3HZ9D](https://gitee.com/dotnetchina/Furion/issues/I3HZ9D)

---

## v1.18.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `Oracle` 11 版本支持 [#I3EVL5](https://gitee.com/dotnetchina/Furion/issues/I3EVL5)
  - &nbsp;<Tag>新增</Tag> `Mysql` 官方包 `MySql.EntityFrameworkCore` 支持 [#I3E6J1](https://gitee.com/dotnetchina/Furion/issues/I3E6J1)
  - &nbsp;<Tag>新增</Tag> 全局配置 `WebApi` 参数 `[FromQury]` 化 [#I3EFYJ](https://gitee.com/dotnetchina/Furion/issues/I3EFYJ)
  - &nbsp;<Tag>新增</Tag> 公开框架底层依赖注入扫描注册拓展 `services.AddRisterTypes(types)` [#I3EIV3](https://gitee.com/dotnetchina/Furion/issues/I3EIV3)
  - &nbsp;<Tag>新增</Tag> SqlSugar 工作单元特性 [#I3EJO5](https://gitee.com/dotnetchina/Furion/issues/I3EJO5)

- **突破性变化**

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 数据库上下文池一旦有上下文操作失败还数据库上下文出现二次提交数据库的问题 [#I3EIJJ](https://gitee.com/dotnetchina/Furion/issues/I3EIJJ)
  - &nbsp;<Tag>修复</Tag> 不同数据库命令参数前缀都添加了 `@` 处理 [#I3EBJP](https://gitee.com/dotnetchina/Furion/issues/I3EBJP)
  - &nbsp;<Tag>修复</Tag> 尝试修复事件总线线程安全问题 [#I3EGSB](https://gitee.com/dotnetchina/Furion/issues/I3EGSB) [#PR236](https://gitee.com/dotnetchina/Furion/pulls/236)
  - &nbsp;<Tag>修复</Tag> `HttpContextExtensions` 的 `SignoutToSwagger` 方法无效 [#I3EHNQ](https://gitee.com/dotnetchina/Furion/issues/I3EHNQ)
  - &nbsp;<Tag>修复</Tag> 如果动态 WebApi 贴了 `[ApiController]` 特性后，导致路由参数重复生成 [#I3EOQQ](https://gitee.com/dotnetchina/Furion/issues/I3EOQQ)
  - &nbsp;<Tag>修复</Tag> 如果没有任何 webapi 控制器时，文档报错 [#I3EVLB](https://gitee.com/dotnetchina/Furion/issues/I3EVLB)
  - &nbsp;<Tag>修复</Tag> 依赖注入泛型类型注册失败 [#I3EX66](https://gitee.com/dotnetchina/Furion/issues/I3EX66)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> SqlSugar 拓展库仓储 `Context` 属性类型未 `SqlSugarClient` [#I3EHXA](https://gitee.com/dotnetchina/Furion/issues/I3EHXA)
  - &nbsp;<Tag>更新</Tag> 刷新 Token 黑名单 Redis 中分组 [#I3EQWO](https://gitee.com/dotnetchina/Furion/issues/I3EQWO)
  - &nbsp;<Tag>更新</Tag> 远程请求在请求拦截次发起二次请求导致异常问题 [#I3ER71](https://gitee.com/dotnetchina/Furion/issues/I3ER71)
  - &nbsp;<Tag>更新</Tag> 多租户默认缓存改为分布式缓存 [#I3EXEU](https://gitee.com/dotnetchina/Furion/issues/I3EXEU)

- **文档变化**

  - &nbsp;<Tag>更新</Tag> 数据库操作文档 [#I3E84X](https://gitee.com/dotnetchina/Furion/issues/I3E84X)

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> 如何方便的获取 `IDynamicApiController` API 产生的 url 和 谓词 [#I3ED17](https://gitee.com/dotnetchina/Furion/issues/I3ED17)
  - &nbsp;<Tag>答疑</Tag> Code First -执行命令 `Add-Migration` 遇到了问题 [#I3EHD0](https://gitee.com/dotnetchina/Furion/issues/I3EHD0)
  - &nbsp;<Tag>答疑</Tag> tools v1.16.0 无法生成实体，一直提示 Missing required argument `<PROVIDER>`. [#I3ENZ8](https://gitee.com/dotnetchina/Furion/issues/I3ENZ8)
  - &nbsp;<Tag>答疑</Tag> Authorize 的 Logout 按钮，无法实时请空 token[#I3EOF9](https://gitee.com/dotnetchina/Furion/issues/I3EOF9)

---

## v1.17.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 动态 WebAPI 支持继承基类配置特性 [#I3D5PX](https://gitee.com/dotnetchina/Furion/issues/I3D5PX)
  - &nbsp;<Tag>新增</Tag> 远程请求支持 `multipart/form-data` 内容类型处理 [#I3D7KG](https://gitee.com/dotnetchina/Furion/issues/I3D7KG)
  - &nbsp;<Tag>新增</Tag> 字符串加密拓展 [#I3DHBW](https://gitee.com/dotnetchina/Furion/issues/I3DHBW)
  - &nbsp;<Tag>新增</Tag> 新增远程请求可直接下载返回值内容转为 string 类型 [#I3DIGR](https://gitee.com/dotnetchina/Furion/issues/I3DIGR)
  - &nbsp;<Tag>新增</Tag> 远程请求地址支持模板引擎 [#I3D5Y8](https://gitee.com/dotnetchina/Furion/issues/I3D5Y8)
  - &nbsp;<Tag>新增</Tag> `[DataValidation]` 错误消息支持 `string.Format` 操作 [#I3E08W](https://gitee.com/dotnetchina/Furion/issues/I3E08W)
  - &nbsp;<Tag>新增</Tag> 远程请求 `HttpRequestMessage` 拓展方法 `AppendQueries()` 追加更多 `query` 参数拓展 [#I3E3DI](https://gitee.com/dotnetchina/Furion/issues/I3E3DI)

- **突破性变化**

  - &nbsp;<Tag>调整</Tag> `IRepository.AsAsyncEnumerable()` 返回值 [#I3DIQ1](https://gitee.com/dotnetchina/Furion/issues/I3DIQ1)，调整为：`rep.AsQueryable().ToListAsync()`

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 数据验证失败后也打印了成功的字段 [#I3CVBS](https://gitee.com/dotnetchina/Furion/issues/I3CVBS)
  - &nbsp;<Tag>修复</Tag> 远程请求配置 `contentType` 为 `application/x-www-form-urlencoded` 无效问题[#I3CWBS](https://gitee.com/dotnetchina/Furion/issues/I3CWBS)
  - &nbsp;<Tag>修复</Tag> 远程请求无法打印完整的请求地址，比如配置了 HttpClient 之后 [#I3CY42](https://gitee.com/dotnetchina/Furion/issues/I3CY42)
  - &nbsp;<Tag>修复</Tag> 程序启动时排除默认配置文件算法不对，应该采用正则表达式匹配 [#I3D9E7](https://gitee.com/dotnetchina/Furion/issues/I3D9E7)
  - &nbsp;<Tag>修复</Tag> 远程请求成功请求拦截不生效 [#I3DOE4](https://gitee.com/dotnetchina/Furion/issues/I3DOE4)
  - &nbsp;<Tag>修复</Tag> `Dapper` 拓展数据库切换为 oracle 时，系统找不到指定的文件 `Oracle.ManagedDataAccess.Core` [#I3DYM3](https://gitee.com/dotnetchina/Furion/issues/I3DYM3)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 获取 `JWT token` 信息支持配置 `Token` 前缀，如 `Bearer ` [#I3DJIV](https://gitee.com/dotnetchina/Furion/issues/I3DJIV)
  - &nbsp;<Tag>更新</Tag> 刷新 Token 黑名单存储方式，将内存缓存调整为分布式缓存 [#I3DPBR](https://gitee.com/dotnetchina/Furion/issues/I3DPBR)

- **文档变化**

  - &nbsp;<Tag>调整</Tag> 远程请求文档 [#I3CPJO](https://gitee.com/dotnetchina/Furion/issues/I3CPJO)

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> `LinqExpression.And` 没有 2 个参数的方法 [#I3CXKZ](https://gitee.com/dotnetchina/Furion/issues/I3CXKZ)
  - &nbsp;<Tag>答疑</Tag> 异常信息 如何记录到数据库中:) [#I3DDGO](https://gitee.com/dotnetchina/Furion/issues/I3DDGO)
  - &nbsp;<Tag>答疑</Tag> 无键实体选用 `IEntityNotKey` [#I3DWRF](https://gitee.com/dotnetchina/Furion/issues/I3DWRF)
  - &nbsp;<Tag>答疑</Tag> 根据主键删除一条记录不成功，无错误信息 [#I3DWWF](https://gitee.com/dotnetchina/Furion/issues/I3DWWF)
  - &nbsp;<Tag>答疑</Tag> 如何自定义接口返回格式 [#I3DZN6](https://gitee.com/dotnetchina/Furion/issues/I3DZN6)
  - &nbsp;<Tag>答疑</Tag> DynamicApiController 如何在运行时决定是否公开一个 Action [#I3D5UL](https://gitee.com/dotnetchina/Furion/issues/I3D5UL)
  - &nbsp;<Tag>答疑</Tag> `Furion.DatabaseAccessor.DbHelpers` 方法：`ConvertToDbParameters` 是不是应该过滤掉贴 `NotMapped` 的特性 [#I3E2XS](https://gitee.com/dotnetchina/Furion/issues/I3E2XS)

---

## v1.16.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `IDGenerator` 雪花 ID 算法，感谢 [idgenerator](https://gitee.com/yitter/idgenerator) 作者提交 PR [#PR204](https://gitee.com/dotnetchina/Furion/pulls/204) [#I3B60S](https://gitee.com/dotnetchina/Furion/issues/I3B60S)
  - &nbsp;<Tag>新增</Tag> `DbContext` 刷新多租户缓存拓展方法 [#I39N5U](https://gitee.com/dotnetchina/Furion/issues/I39N5U)
  - &nbsp;<Tag>新增</Tag> 自定义配置单个控制器名称规范，如小写路由 [#I3A5XL](https://gitee.com/dotnetchina/Furion/issues/I3A5XL)
  - &nbsp;<Tag>新增</Tag> 获取当前选择区域语言方法 [#I3BSDH](https://gitee.com/dotnetchina/Furion/issues/I3BSDH)

- **突破性变化**

  - &nbsp;<Tag>升级</Tag> .NET 5 SDK 至 5.0.4 版本 [#I3ASTL](https://gitee.com/dotnetchina/Furion/issues/I3ASTL)
  - &nbsp;<Tag>优化</Tag> 远程请求所有功能 [#I2LB7M](https://gitee.com/dotnetchina/Furion/issues/I2LB7M)
  - &nbsp;<Tag>优化</Tag> `JSON` 序列化功能，提供统一的抽象接口，方便自由替换 `JSON` 库 [#I39GT9](https://gitee.com/dotnetchina/Furion/issues/I39GT9)
  - &nbsp;<Tag>优化</Tag> 验证失败返回消息模型及规范化接口验证参数 [#I3AFQW](https://gitee.com/dotnetchina/Furion/issues/I3AFQW)
  - &nbsp;<Tag>更新</Tag> 插件式开发热插拔功能，实现动态加载卸载 [#PR200](https://gitee.com/dotnetchina/Furion/pulls/200), 感谢 [@SamWangCoder](https://gitee.com/samwangcoder)
  - &nbsp;<Tag>移除</Tag> 移除 `JsonSerializerUtility` 静态类及移除属性大写序列化拓展配置 [#I3AFRJ](https://gitee.com/dotnetchina/Furion/issues/I3AFRJ)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `MVC` 模式下不支持验证自定义验证逻辑 [#I39LM5](https://gitee.com/dotnetchina/Furion/issues/I39LM5)
  - &nbsp;<Tag>修复</Tag> 验证数值类型正则表达式不支持负数 bug [#I39YUV](https://gitee.com/dotnetchina/Furion/issues/I39YUV)
  - &nbsp;<Tag>修复</Tag> 框架启动时无法加载未被引用的程序集 bug [#I3A3Z4](https://gitee.com/dotnetchina/Furion/issues/I3A3Z4)
  - &nbsp;<Tag>修复</Tag> `EFCoreRepository.IsAttached()` 方法判断错误 bug [#I3A824](https://gitee.com/dotnetchina/Furion/issues/I3A824)
  - &nbsp;<Tag>修复</Tag> `动态API` 驼峰显示配置无效 bug [#I3AF32](https://gitee.com/dotnetchina/Furion/issues/I3AF32)
  - &nbsp;<Tag>修复</Tag> `cli.ps1` 不支持新版本 `EFCore` bug [#I3APO9](https://gitee.com/dotnetchina/Furion/issues/I3APO9)
  - &nbsp;<Tag>修复</Tag> `EFCore` 实体配置 `[Table]` 特性无效 bug [#I3BAYH](https://gitee.com/dotnetchina/Furion/issues/I3BAYH)
  - &nbsp;<Tag>修复</Tag> 动态 WebAPI `CheckIsSplitCamelCase` bug [#I3BLKX](https://gitee.com/dotnetchina/Furion/issues/I3BLKX)
  - &nbsp;<Tag>修复</Tag> 修复动态 WebAPI 配置保留 Action 的 Async 后缀无效问题 [#I3C3DA](https://gitee.com/dotnetchina/Furion/issues/I3C3DA)
  - &nbsp;<Tag>修复</Tag> `JWT` Token 刷新后旧的刷新 Token 依旧可用 bug [#I3C8ZH](https://gitee.com/dotnetchina/Furion/issues/I3C8ZH)
  - &nbsp;<Tag>修复</Tag> 多语言 `Razor` 视图变量多语言乱码问题 [#I3CBMU](https://gitee.com/dotnetchina/Furion/issues/I3CBMU)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 默认序列化提供器 `System.Text.Json` 反序列化字符串时区分大小写问题 [#I3BSXV](https://gitee.com/dotnetchina/Furion/issues/I3BSXV)
  - &nbsp;<Tag>更新</Tag> 优化 `MessageCenter` 性能问题 [#I39PRR](https://gitee.com/dotnetchina/Furion/issues/I39PRR)
  - &nbsp;<Tag>更新</Tag> 数据库上下文池小性能优化

- **文档变化**

  - &nbsp;<Tag>新增</Tag> `Docker` 环境下自动化部署 [#PR209](https://gitee.com/dotnetchina/Furion/pulls/209)
  - &nbsp;<Tag>新增</Tag> `JSON` 序列化 文档 [#I3B6D8](https://gitee.com/dotnetchina/Furion/issues/I3B6D8)
  - &nbsp;<Tag>更新</Tag> 跨域、安全授权、即时通信文档、多语言、规范化文档

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> `Furion.Extras.DatabaseAccessor.SqlSugar` 配置多个数据库打印 SQL 语句问题 [#I39PDC](https://gitee.com/dotnetchina/Furion/issues/I39PDC)
  - &nbsp;<Tag>答疑</Tag> `ORACLE` 数据库多租户模式下返回值为指定类型时系统卡死 [#I39RNH](https://gitee.com/dotnetchina/Furion/issues/I39RNH)
  - &nbsp;<Tag>答疑</Tag> 假删除指向异常 [#I39XZA](https://gitee.com/dotnetchina/Furion/issues/I39XZA)
  - &nbsp;<Tag>答疑</Tag> `Furion` 多语言配置节是放在 `AppSettings` 里面还是外面呢？ [#I3A4SB](https://gitee.com/dotnetchina/Furion/issues/I3A4SB)
  - &nbsp;<Tag>答疑</Tag> 没找到数据库上下文 [#I3A5HS](https://gitee.com/dotnetchina/Furion/issues/I3A5HS)
  - &nbsp;<Tag>答疑</Tag> 有 `QQ` 交流群吗？ [#I3AAM7](https://gitee.com/dotnetchina/Furion/issues/I3AAM7)
  - &nbsp;<Tag>答疑</Tag> `Vue3` 环境下配置 `SignalR` 跨域出错 [#I3ALQ7](https://gitee.com/dotnetchina/Furion/issues/I3ALQ7)
  - &nbsp;<Tag>答疑</Tag> 设置 `Swagger` 参数非必填 [#I3AT02](https://gitee.com/dotnetchina/Furion/issues/I3AT02)
  - &nbsp;<Tag>答疑</Tag> EFCore 调用 Insert 时报 `Unknown column 'Discriminator' in 'field list'` 异常 [#I3B2LC](https://gitee.com/dotnetchina/Furion/issues/I3B2LC)
  - &nbsp;<Tag>答疑</Tag> 逆向 `mysql` 数据库时 `cli` 出现错误 [#I3B64F](https://gitee.com/dotnetchina/Furion/issues/I3B64F)
  - &nbsp;<Tag>答疑</Tag> Sql 高级代理使用过程中 DateTime 类型的参数序列化失败 [#I3AZXK](https://gitee.com/dotnetchina/Furion/issues/I3AZXK)
  - &nbsp;<Tag>答疑</Tag> 使用 Mysql 执行 Add-Migration 报错 [#I3B8EW](https://gitee.com/dotnetchina/Furion/issues/I3B8EW)
  - &nbsp;<Tag>答疑</Tag> Saas 多租户模式-独立 Database 模式下无法获取 Tenant, 导致无法自动切换的问题[#I3AVXU](https://gitee.com/dotnetchina/Furion/issues/I3AVXU)
  - &nbsp;<Tag>答疑</Tag> 如何自定义 WebAPI 统一结果模型 [#I3BBYW](https://gitee.com/dotnetchina/Furion/issues/I3BBYW) [#I3BBYV](https://gitee.com/dotnetchina/Furion/issues/I3BBYV)
  - &nbsp;<Tag>答疑</Tag> 在 `Web.Entry` 项目新建了一个 `Controller`，多了未知方法 [#I3BKH5](https://gitee.com/dotnetchina/Furion/issues/I3BKH5)
  - &nbsp;<Tag>答疑</Tag> `AOP` 拦截如何解析服务 [#I3BUM3](https://gitee.com/dotnetchina/Furion/issues/I3BUM3)
  - &nbsp;<Tag>答疑</Tag> 动态 WebAPI 返回参数被省略 [#I3C2XR](https://gitee.com/dotnetchina/Furion/issues/I3C2XR)
  - &nbsp;<Tag>答疑</Tag> 如何设置某一个接口响应数据不自动转小写，按原始字段名返回 [#I38L9B](https://gitee.com/dotnetchina/Furion/issues/I38L9B)
  - &nbsp;<Tag>答疑</Tag> code first 如何配置自动迁移 [#I3CCR0](https://gitee.com/dotnetchina/Furion/issues/I3CCR0)
  - &nbsp;<Tag>答疑</Tag> webapi 混合授权如何区分不同系统 [#I3CJCY](https://gitee.com/dotnetchina/Furion/issues/I3CJCY)
  - &nbsp;<Tag>答疑</Tag> EFCore 不支持递归无限级遍历关系 [#I3CET9](https://gitee.com/dotnetchina/Furion/issues/I3CET9)

---

## v1.15.0 （已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 跳过特定实体数据库操作监听特性 [#I386LB](https://gitee.com/dotnetchina/Furion/issues/I386LB)
  - &nbsp;<Tag>新增</Tag> `IEntityChangedListener` 增加对 `OldEntity` 的支持 [#I385X2](https://gitee.com/dotnetchina/Furion/issues/I385X2)
  - &nbsp;<Tag>新增</Tag> 实时通信自动配置集线器拓展及特性 [#I387QX](https://gitee.com/dotnetchina/Furion/issues/I387QX)
  - &nbsp;<Tag>新增</Tag> `Mapster` 拓展支持 `IMapper` 依赖注入方式 [#I38C7C](https://gitee.com/dotnetchina/Furion/issues/I38C7C)
  - &nbsp;<Tag>新增</Tag> `[AppDbContext]` 特性默认构造函数 [#I38J97](https://gitee.com/dotnetchina/Furion/issues/I38J97)
  - &nbsp;<Tag>新增</Tag> `UnifyContext.GetExceptionMetadata(context)` 返回错误码支持 [#I38ONX](https://gitee.com/dotnetchina/Furion/issues/I38ONX)

- **突破性变化**

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 多次循环中调用 `Db.GetNewDbContext()` 还是获取到同一个对象 [#I38NNP](https://gitee.com/dotnetchina/Furion/issues/I38NNP)
  - &nbsp;<Tag>修复</Tag> `Swagger` 过滤掉 `object ` 类型属性问题 [#I38FHL](https://gitee.com/dotnetchina/Furion/issues/I38FHL)
  - &nbsp;<Tag>修复</Tag> 同一类不支持多继承 `IEntityChangedListener` 问题 [#I38UQJ](https://gitee.com/dotnetchina/Furion/issues/I38UQJ)
  - &nbsp;<Tag>修复</Tag> 自定义序列化属性名称导致验证失败属性不匹配问题 [#I38W8Z](https://gitee.com/dotnetchina/Furion/issues/I38W8Z)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 代码不规范命名导致开发者阅读代码时产生歧义

- **文档变化**

  - &nbsp;<Tag>新增</Tag> `FluentValidation` 集成文档 [#I38IOT](https://gitee.com/dotnetchina/Furion/issues/I38IOT)

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> `Furion` 框架版本向下兼容问题 [#I38WMZ](https://gitee.com/dotnetchina/Furion/issues/I38WMZ)

---

## v1.14.0（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `EFCore` 5.0 的 `Oracle` 数据库支持 [#I37Z8E](https://gitee.com/dotnetchina/Furion/issues/I37Z8E)
  - &nbsp;<Tag>新增</Tag> 控制是否在开发环境下显示数据库连接信息 [#I37YQ2](https://gitee.com/dotnetchina/Furion/issues/I37YQ2)
  - &nbsp;<Tag>新增</Tag> `[NonUnify]` 支持在类中贴此特性 [#I359Q6](https://gitee.com/dotnetchina/Furion/issues/I359Q6)
  - &nbsp;<Tag>新增</Tag> `网络请求` 字符串 `HttpClient` 拦截器 [#I35F3E](https://gitee.com/dotnetchina/Furion/issues/I35F3E)
  - &nbsp;<Tag>新增</Tag> `HttpContext` 及 `HttpRequest` 获取远程地址拓展 [#I3688Z](https://gitee.com/dotnetchina/Furion/issues/I3688Z)
  - &nbsp;<Tag>新增</Tag> `services.AddMvcFilter<>` 添加 `Mvc` 过滤器拓展 [#I368BH](https://gitee.com/dotnetchina/Furion/issues/I368BH)

- **突破性变化**

  - &nbsp;<Tag>升级</Tag> 框架依赖的 .NET 5 SDK 至最新版 5.0.3 [#I37YQQ](https://gitee.com/dotnetchina/Furion/issues/I37YQQ)
  - &nbsp;<Tag>升级</Tag> `Swashbuckle.AspNetCore` 组件包到 `6.0.x` 版本 [#I37EZK](https://gitee.com/dotnetchina/Furion/issues/I37EZK)
  - &nbsp;<Tag>移除</Tag> `Furion` 框架 `JWT` 拓展类，只在 `Furion.Extras.Authentication.JwtBearer` 中保留 [#I35D59](https://gitee.com/dotnetchina/Furion/issues/I35D59)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 传入错误 `JWT Token` 字符串导致自动刷新 `Token` 出现字符串边界值异常 bug [#I34ZE5](https://gitee.com/dotnetchina/Furion/issues/I34ZE5)
  - &nbsp;<Tag>修复</Tag> 瞬时作用域数据库上下文也会自动加入工作单元导致写日志时连锁异常 bug [#I37WTV](https://gitee.com/dotnetchina/Furion/issues/I37WTV)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 获取系统环境参数的性能 [#I36SR5](https://gitee.com/dotnetchina/Furion/issues/I36SR5)
  - &nbsp;<Tag>更新</Tag> `Furion` 底层添加 `Mvc` 过滤器代码 [#I36SKA](https://gitee.com/dotnetchina/Furion/issues/I36SKA)
  - &nbsp;<Tag>更新</Tag> 添加默认 `Json` 序列化时间默认时间格式 [#I36SL0](https://gitee.com/dotnetchina/Furion/issues/I36SL0)
  - &nbsp;<Tag>升级</Tag> 升级 `SqlSugar` 拓展包到 `5.0.2.6` 版本 [#I36SIG](https://gitee.com/dotnetchina/Furion/issues/I36SIG)

- **文档变化**

  - &nbsp;<Tag>新增</Tag> 数据库入门文档 [#I37Z8S](https://gitee.com/dotnetchina/Furion/issues/I37Z8S)
  - &nbsp;<Tag>新增</Tag> 更新日志文档 [#I36PI0](https://gitee.com/dotnetchina/Furion/issues/I36PI0)
  - &nbsp;<Tag>新增</Tag> 请求审计日志、执行 `Sql` 更新日志文档 [#I36PIK](https://gitee.com/dotnetchina/Furion/issues/I36PIK)
  - &nbsp;<Tag>新增</Tag> 前端使用 `axios` 跨域配置文档 [#I36PIT](https://gitee.com/dotnetchina/Furion/issues/I36PIT)
  - &nbsp;<Tag>新增</Tag> `App` 静态类获取应用、环境更多信息数据 [#I36SOV](https://gitee.com/dotnetchina/Furion/issues/I36SOV)
  - &nbsp;<Tag>新增</Tag> 英文版 `README.md` 介绍 [#I37QHP](https://gitee.com/dotnetchina/Furion/issues/I37QHP)

---

## v1.13.0（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 多语言功能及拓展 [#I2DOCL](https://gitee.com/dotnetchina/Furion/issues/I2DOCL)
  - &nbsp;<Tag>新增</Tag> 事件总线功能及消息中心 [#I23BKN](https://gitee.com/dotnetchina/Furion/issues/I23BKN)
  - &nbsp;<Tag>新增</Tag> `Swagger` 分组显示隐藏配置 [#I2AHH8](https://gitee.com/dotnetchina/Furion/issues/I2AHH8)
  - &nbsp;<Tag>新增</Tag> `Furion.Extras.Logging.Serilog` 拓展插件 [#I2AAN8](https://gitee.com/dotnetchina/Furion/issues/I2AAN8)
  - &nbsp;<Tag>新增</Tag> `cli.ps` 支持 `-Namespace` 命名空间指定 [#I2A175](https://gitee.com/dotnetchina/Furion/issues/I2A175)
  - &nbsp;<Tag>新增</Tag> `Swagger` 规范化化文档授权失效后自动取消授权锁 [#I2AIWC](https://gitee.com/dotnetchina/Furion/issues/I2AIWC)
  - &nbsp;<Tag>新增</Tag> `Request.Body` 支持重复读功能，主要解决微信 SDK 问题 [#I2AMG0](https://gitee.com/dotnetchina/Furion/issues/I2AMG0)
  - &nbsp;<Tag>新增</Tag> 网络请求功能及文档 [#I2APGJ](https://gitee.com/dotnetchina/Furion/issues/I2APGJ)
  - &nbsp;<Tag>新增</Tag> `SqlSugar` 拓展包支持打印 `sql` 到 `MiniProfiler` 中 [#I2ASLS](https://gitee.com/dotnetchina/Furion/issues/I2ASLS)
  - &nbsp;<Tag>新增</Tag> `Furion.Extras.DatabaseAccesssor.Dapper` 拓展插件 [#I2ASYA](https://gitee.com/dotnetchina/Furion/issues/I2ASYA)
  - &nbsp;<Tag>新增</Tag> `Furion.Extras.DatabaseAccessor.PetaPoco` 拓展插件 [#I2AUGA](https://gitee.com/dotnetchina/Furion/issues/I2AUGA)
  - &nbsp;<Tag>新增</Tag> 网络请求字符串拓展方法 [#I2CPQ0](https://gitee.com/dotnetchina/Furion/issues/I2CPQ0)
  - &nbsp;<Tag>新增</Tag> `SqlSugar` 拓展新增 `PagedList` 拓展 [#I2CW99](https://gitee.com/dotnetchina/Furion/issues/I2CW99)
  - &nbsp;<Tag>新增</Tag> 远程请求支持参数特性验证 [#I2CX5L](https://gitee.com/dotnetchina/Furion/issues/I2CX5L)
  - &nbsp;<Tag>新增</Tag> `App.User` 获取当前授权用户信息便捷方法 [#I2CZLO](https://gitee.com/dotnetchina/Furion/issues/I2CZLO)
  - &nbsp;<Tag>新增</Tag> 规范化文档可配置功能，支持 `appsettings.json` 配置 [#I2D1K9](https://gitee.com/dotnetchina/Furion/issues/I2D1K9)
  - &nbsp;<Tag>新增</Tag> 远程请求拦截器添加方法和方法参数 [#I2D2CM](https://gitee.com/dotnetchina/Furion/issues/I2D2CM)
  - &nbsp;<Tag>新增</Tag> 远程请求出错返回默认值支持 [#I2D44M](https://gitee.com/dotnetchina/Furion/issues/I2D44M)
  - &nbsp;<Tag>新增</Tag> 远程请求 `body` 参数序列化支持设置 `PropertyNamingPolicy` [#I2D685](https://gitee.com/dotnetchina/Furion/issues/I2D685)
  - &nbsp;<Tag>新增</Tag> 远程服务接口客户端配置 [#I2D7PS](https://gitee.com/dotnetchina/Furion/issues/I2D7PS)
  - &nbsp;<Tag>新增</Tag> `AddInject` 和 `UseInject` 允许自定义 `SecurityDefinitions` 和 `SwaggerUI` [#I2DIMG](https://gitee.com/dotnetchina/Furion/issues/I2DIMG)
  - &nbsp;<Tag>新增</Tag> `[SecurityDefine]` 默认构造函数 [#I2DNXT](https://gitee.com/dotnetchina/Furion/issues/I2DNXT)
  - &nbsp;<Tag>新增</Tag> `AspectDispatchProxy` 动态代理类 [#I2DO6I](https://gitee.com/dotnetchina/Furion/issues/I2DO6I)
  - &nbsp;<Tag>新增</Tag> `[QueryParameters]` 特性，支持一键将 `Action` 参数添加 `[FromQuery]` 特性 [#I2G8TF](https://gitee.com/dotnetchina/Furion/issues/I2G8TF)
  - &nbsp;<Tag>新增</Tag> 动态日志配置及拓展方法 [#I2GDGD](https://gitee.com/dotnetchina/Furion/issues/I2GDGD)
  - &nbsp;<Tag>新增</Tag> `WebApi` 请求谓词默认规则配置功能 [#I2M70X](https://gitee.com/dotnetchina/Furion/issues/I2M70X)

- **突破性变化**

  - &nbsp;<Tag>升级</Tag> `.NET 5` SDK 到 `.NET 5.0.2` 版本 [#I2D0PZ](https://gitee.com/dotnetchina/Furion/issues/I2D0PZ)
  - &nbsp;<Tag>调整</Tag> 框架内所有拓展类命名空间，全部迁移到 `Furion.模块.Extensions` 下 [#I2AH54](https://gitee.com/dotnetchina/Furion/issues/I2AH54)
  - &nbsp;<Tag>调整</Tag> `Swagger` 记住授权存储方式，替换 `Session` 存储方式为 `LocalStorage` 方式 [#I2AKUA](https://gitee.com/dotnetchina/Furion/issues/I2AKUA)
  - &nbsp;<Tag>调整</Tag> `Furion` 框架包描述文件，减少框架体积 [#I2APAU](https://gitee.com/dotnetchina/Furion/issues/I2APAU)
  - &nbsp;<Tag>调整</Tag> `App.CanBeScanTypes` 为 `App.EffectiveTypes` [#I2B0ZR](https://gitee.com/dotnetchina/Furion/issues/I2B0ZR)
  - &nbsp;<Tag>调整</Tag> `App.ServiceProvider` 属性并移除 `App.GetDuplicateXXX` 方法 [#I2CYZE](https://gitee.com/dotnetchina/Furion/issues/I2CYZE)
  - &nbsp;<Tag>调整</Tag> `Db.GetDuplicateDbContext` 为 `Db.GetNewDbContext` [#I2CZ04](https://gitee.com/dotnetchina/Furion/issues/I2CZ04)
  - &nbsp;<Tag>调整</Tag> `Db.GetSqlDispatchProxy` 为 `Db.GetSqlProxy` [#I2DO9T](https://gitee.com/dotnetchina/Furion/issues/I2DO9T)
  - &nbsp;<Tag>优化</Tag> `Aop` 服务拦截器，支持异步、同步两种方式 [#I2B9HQ](https://gitee.com/dotnetchina/Furion/issues/I2B9HQ)
  - &nbsp;<Tag>优化</Tag> 网络请求所有功能 [#I2BMR7](https://gitee.com/dotnetchina/Furion/issues/I2BMR7)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `Swagger` 规范化化结果不一致 bug [#I2ACF3](https://gitee.com/dotnetchina/Furion/issues/I2ACF3)
  - &nbsp;<Tag>修复</Tag> 数据库新增或更新忽略空值操作方法报空异常 [#I2AB6C](https://gitee.com/dotnetchina/Furion/issues/I2AB6C)
  - &nbsp;<Tag>修复</Tag> `Startup.cs` Aop 全局拦截无效 [#I2A7T2](https://gitee.com/dotnetchina/Furion/issues/I2A7T2)
  - &nbsp;<Tag>修复</Tag> `Token` 过期后自动刷新 `Token` 无法获取最新的用户信息 bug [#I2AWQI](https://gitee.com/dotnetchina/Furion/issues/I2AWQI)
  - &nbsp;<Tag>修复</Tag> `[ApiDescriptionSettings(Tag="xx")]` 导致 `swagger.json` 报错 bug [#I2B47R](https://gitee.com/dotnetchina/Furion/issues/I2B47R)
  - &nbsp;<Tag>修复</Tag> `Mysql` sql 数据库查询结果 `tinyint` 类型转换出错 bug [#I2BEBM](https://gitee.com/dotnetchina/Furion/issues/I2BEBM)
  - &nbsp;<Tag>修复</Tag> 规范化结果多次包裹类型 bug [#I2BHHZ](https://gitee.com/dotnetchina/Furion/issues/I2BHHZ)
  - &nbsp;<Tag>修复</Tag> 动态 Api 基元类型数组问题 [#I2BMS5](https://gitee.com/dotnetchina/Furion/issues/I2BMS5)
  - &nbsp;<Tag>修复</Tag> `sql` 查询枚举类型转换异常 bug [#I2BS2Y](https://gitee.com/dotnetchina/Furion/issues/I2BS2Y)
  - &nbsp;<Tag>修复</Tag> `string.SqlQuerizeAsync<T1>()` 拓展返回错误 bug [#I2BSTS](https://gitee.com/dotnetchina/Furion/issues/I2BSTS)
  - &nbsp;<Tag>修复</Tag> 动态 Api 子类重写父类方法并取别名后 `Swagger` 异常 bug [#I2C9VP](https://gitee.com/dotnetchina/Furion/issues/I2C9VP)
  - &nbsp;<Tag>修复</Tag> 网络请求 `application/json` 序列化大小写问题 [#I2CRJC](https://gitee.com/dotnetchina/Furion/issues/I2CRJC)
  - &nbsp;<Tag>修复</Tag> 多数据库定位器实体嵌套关联 bug [#I2CVN0](https://gitee.com/dotnetchina/Furion/issues/I2CVN0)
  - &nbsp;<Tag>修复</Tag> 跨域响应头设置无效 bug [#I2CW5T](https://gitee.com/dotnetchina/Furion/issues/I2CW5T)
  - &nbsp;<Tag>修复</Tag> 远程网络请求代理打印到 `MiniProfiler` bug [#I2CZBC](https://gitee.com/dotnetchina/Furion/issues/I2CZBC)
  - &nbsp;<Tag>修复</Tag> 远程请求响应拦截器 bug [#I2D4DG](https://gitee.com/dotnetchina/Furion/issues/I2D4DG)
  - &nbsp;<Tag>修复</Tag> `SqlSugar` 框架 `AsQueryable()` 一直追加参数 [#I2DH1D](https://gitee.com/dotnetchina/Furion/issues/I2DH1D)
  - &nbsp;<Tag>修复</Tag> 自动刷新 `Token` 空异常 bug [#I2DO29](https://gitee.com/dotnetchina/Furion/issues/I2DO29)
  - &nbsp;<Tag>修复</Tag> 生成 `JWT Token` 不传过期时间出现验证 401 bug [#I2DO8L](https://gitee.com/dotnetchina/Furion/issues/I2DO8L)
  - &nbsp;<Tag>修复</Tag> `AppStartup` 排序无效 [#I2DVD2](https://gitee.com/dotnetchina/Furion/issues/I2DVD2)
  - &nbsp;<Tag>修复</Tag> 未启用多语言服务时友好异常和验证出现空异常 [#I2ECUJ](https://gitee.com/dotnetchina/Furion/issues/I2ECUJ)
  - &nbsp;<Tag>修复</Tag> 数据校验字母和数字组合无法匹配 bug [#I2EF2Q](https://gitee.com/dotnetchina/Furion/issues/I2EF2Q)
  - &nbsp;<Tag>修复</Tag> 数据校验手机或固话无效 bug [#I2M5IZ](https://gitee.com/dotnetchina/Furion/issues/I2M5IZ)
  - &nbsp;<Tag>修复</Tag> `Dapper` 拓展解析 `SqlConnection` 异常 bug [#I2M5P2](https://gitee.com/dotnetchina/Furion/issues/I2M5P2)
  - &nbsp;<Tag>修复</Tag> 开启多语言后，`EF` 迁移异常 bug [#I2M7DT](https://gitee.com/dotnetchina/Furion/issues/I2M7DT)
  - &nbsp;<Tag>修复</Tag> `IEntityTypeBuilder` 不支持多重继承 bug [#I2PAOD](https://gitee.com/dotnetchina/Furion/issues/I2PAOD)
  - &nbsp;<Tag>修复</Tag> `JwtHandler` 设置自动刷新后，匿名访问无法通过 bug [#I2SDOX](https://gitee.com/dotnetchina/Furion/issues/I2SDOX)
  - &nbsp;<Tag>修复</Tag> `Dapper` 拓展中 `SqlServer` 数据库获取连接对象类型 bug [#PR159](https://gitee.com/dotnetchina/Furion/pulls/159)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> 移除 `Sql` 查询结果映射检查 `[NotMapper]` 特性机制 [#I34XD0](https://gitee.com/dotnetchina/Furion/issues/I34XD0)
  - &nbsp;<Tag>更新</Tag> 依赖注入时排除 `IDynamicApiController` 接口 [#I2ECTG](https://gitee.com/dotnetchina/Furion/issues/I2ECTG)
  - &nbsp;<Tag>更新</Tag> `MD5` 加密性能 [#PR158](https://gitee.com/dotnetchina/Furion/pulls/158)

- **文档变化**

  - &nbsp;<Tag>优化</Tag> 文档首页 [#I34XBR](https://gitee.com/dotnetchina/Furion/issues/I34XBR)
  - &nbsp;<Tag>新增</Tag> 网络请求文档 [#I2APGJ](https://gitee.com/dotnetchina/Furion/issues/I2APGJ)
  - &nbsp;<Tag>新增</Tag> 多语言文档 [#I2DOCL](https://gitee.com/dotnetchina/Furion/issues/I2DOCL)
  - &nbsp;<Tag>新增</Tag> 文档全文搜索引擎 [#I34XAW](https://gitee.com/dotnetchina/Furion/issues/I34XAW)
  - &nbsp;<Tag>新增</Tag> 全局静态类类型 [#I34XB4](https://gitee.com/dotnetchina/Furion/issues/I34XB4)
  - &nbsp;<Tag>新增</Tag> 框架可配置选项文档 [#I34XB9](https://gitee.com/dotnetchina/Furion/issues/I34XB9)
  - &nbsp;<Tag>新增</Tag> 事件总线文档 [#I34XBI](https://gitee.com/dotnetchina/Furion/issues/I34XBI)
  - &nbsp;<Tag>新增</Tag> 数据加解密文档 [#I34XC0](https://gitee.com/dotnetchina/Furion/issues/I34XC0)
  - &nbsp;<Tag>新增</Tag> 贡献指南文档 [#I34XC8](https://gitee.com/dotnetchina/Furion/issues/I34XC8)
  - &nbsp;<Tag>新增</Tag> `HttpContext` 及 `文件上传下载` 博客文章 [#I34XCB](https://gitee.com/dotnetchina/Furion/issues/I34XCB)
  - &nbsp;<Tag>优化</Tag> 文档小调整，小优化

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> 跨域设置无效 [#I2ASNJ](https://gitee.com/dotnetchina/Furion/issues/I2ASNJ)
  - &nbsp;<Tag>答疑</Tag> `MVC` 视图无效，原因是 `.cshtml` 文件没有设置为 `内容` [#I2AXUU](https://gitee.com/dotnetchina/Furion/issues/I2AXUU)
  - &nbsp;<Tag>答疑</Tag> `Sql` 操作可以实现事务吗？[#I2B0NX](https://gitee.com/dotnetchina/Furion/issues/I2B0NX)
  - &nbsp;<Tag>答疑</Tag> `IRepository` 操作数据库会打开多次数据库连接 [#I2BB7B](https://gitee.com/dotnetchina/Furion/issues/I2BB7B)
  - &nbsp;<Tag>答疑</Tag> 如何进入自定义 `AppAuthorizeHandler` 断点 [#I2BGXY](https://gitee.com/dotnetchina/Furion/issues/I2BGXY)
  - &nbsp;<Tag>答疑</Tag> `SqlSugar` 注入问题 [#I2C2AQ](https://gitee.com/dotnetchina/Furion/issues/I2C2AQ)
  - &nbsp;<Tag>答疑</Tag> 建议增加 API 签名验证，时效验证 [#I2C6ET](https://gitee.com/dotnetchina/Furion/issues/I2C6ET)
  - &nbsp;<Tag>答疑</Tag> 多数据库多租户同时使用 `Add-Migration` 报错 [#I2CEHS](https://gitee.com/dotnetchina/Furion/issues/I2CEHS)
  - &nbsp;<Tag>答疑</Tag> `ISqlSugarRepository` 没有 `Getxxx` 方法 [#I2CJLZ](https://gitee.com/dotnetchina/Furion/issues/I2CJLZ)
  - &nbsp;<Tag>答疑</Tag> `cli.ps1` 如何将 `sql` 里的表导出成 `model` 类 [#I2CSUL](https://gitee.com/dotnetchina/Furion/issues/I2CSUL)
  - &nbsp;<Tag>答疑</Tag> 手动修改 `Swagger` 终结点路径无效 [#I2D608](https://gitee.com/dotnetchina/Furion/issues/I2D608)
  - &nbsp;<Tag>答疑</Tag> `DefaultDbContext` 不能识别 [#I2DCZX](https://gitee.com/dotnetchina/Furion/issues/I2DCZX)
  - &nbsp;<Tag>答疑</Tag> 各分层项目 `Startup.cs` 支持 `Configuration` [#I2DDUP](https://gitee.com/dotnetchina/Furion/issues/I2DDUP)
  - &nbsp;<Tag>答疑</Tag> `Aop` 无法拦截，无效 [#I2DEY8](https://gitee.com/dotnetchina/Furion/issues/I2DEY8)
  - &nbsp;<Tag>答疑</Tag> `mysql` 执行 `Add-Migration` 报错 [#I2DSB8](https://gitee.com/dotnetchina/Furion/issues/I2DSB8)\
  - &nbsp;<Tag>答疑</Tag> `Entity` 创建时间和是否删除添加默认值 [#I2E04H](https://gitee.com/dotnetchina/Furion/issues/I2E04H)
  - &nbsp;<Tag>答疑</Tag> `swagger` 中多个 `servers` 设置 [#I2E0IF](https://gitee.com/dotnetchina/Furion/issues/I2E0IF)
  - &nbsp;<Tag>答疑</Tag> 全局筛选器 没有执行 [#I2E5R4](https://gitee.com/dotnetchina/Furion/issues/I2E5R4)
  - &nbsp;<Tag>答疑</Tag> 多数据库定位器疑问 [#I2E77T](https://gitee.com/dotnetchina/Furion/issues/I2E77T)
  - &nbsp;<Tag>答疑</Tag> `cli.ps` 逆向工程 `Mysql` 数据库报错 [#I2E7I5](https://gitee.com/dotnetchina/Furion/issues/I2E7I5)
  - &nbsp;<Tag>答疑</Tag> `Swagger` 开发环境 `applicationsettings.json` 中文乱码 [#I2EAG1](https://gitee.com/dotnetchina/Furion/issues/I2EAG1)
  - &nbsp;<Tag>答疑</Tag> 增加指定路径程序集映射 [#I2EEO2](https://gitee.com/dotnetchina/Furion/issues/I2EEO2)
  - &nbsp;<Tag>答疑</Tag> 动态编译 `cs` 脚本文件 [#I2EH66](https://gitee.com/dotnetchina/Furion/issues/I2EH66)
  - &nbsp;<Tag>答疑</Tag> 自定义中间件，返回的错误没有规范化结果 [#I2NV8S](https://gitee.com/dotnetchina/Furion/issues/I2NV8S)
  - &nbsp;<Tag>答疑</Tag> `Swagger` 循环引用设置生成文档层级无效 [#I2PLQQ](https://gitee.com/dotnetchina/Furion/issues/I2PLQQ)
  - &nbsp;<Tag>答疑</Tag> 配置文件支持 `yaml` 文件吗? [#I2TJ3N](https://gitee.com/dotnetchina/Furion/issues/I2TJ3N)
  - &nbsp;<Tag>答疑</Tag> 修改数据库未 `mysql` 执行 `Add-Migration` 报错 [#I2VR64](https://gitee.com/dotnetchina/Furion/issues/I2VR64)
  - &nbsp;<Tag>答疑</Tag> 多数据库使用定位器时报错 [#I2VR8F](https://gitee.com/dotnetchina/Furion/issues/I2VR8F)
  - &nbsp;<Tag>答疑</Tag> `Migration To Oracle` 异常 [#I2WBYQ](https://gitee.com/dotnetchina/Furion/issues/I2WBYQ)
  - &nbsp;<Tag>答疑</Tag> 开发时显示 `Swagger`，上线时关闭 `Swagger`，这需要怎么配置 [#I2WOYV](https://gitee.com/dotnetchina/Furion/issues/I2WOYV)
  - &nbsp;<Tag>答疑</Tag> 兼容 Mvc 复杂验证没有试验成功 [#I2X3GV](https://gitee.com/dotnetchina/Furion/issues/I2X3GV)
  - &nbsp;<Tag>答疑</Tag> `Aop` 能不能支持无接口的类 [#I2X8AS](https://gitee.com/dotnetchina/Furion/issues/I2X8AS)
  - &nbsp;<Tag>答疑</Tag> 关于 `JWT Token` 自动刷新问题 [#I2YD4K](https://gitee.com/dotnetchina/Furion/issues/I2YD4K)
  - &nbsp;<Tag>答疑</Tag> 能否增加一个拓展的 `Entity`，增加一些拓展的属性 [#I2YDKT](https://gitee.com/dotnetchina/Furion/issues/I2YDKT)
  - &nbsp;<Tag>答疑</Tag> `Furion` 无法还原包，使用`Nuget` 下载和通过最新的的脚手架下载都提示这个问题 [#I30446](https://gitee.com/dotnetchina/Furion/issues/I30446)
  - &nbsp;<Tag>答疑</Tag> 复杂校验与特性验证不能并行 [#I3046U](https://gitee.com/dotnetchina/Furion/issues/I3046U)

---

## v1.7.0（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `Furion.Extras.ObjectMapper.Mapster` 拓展包 [#I29LSJ](https://gitee.com/dotnetchina/Furion/issues/I29LSJ)
  - &nbsp;<Tag>新增</Tag> `Furion.Extras.Logging.Serilog` 拓展包 [#I2AAN8](https://gitee.com/dotnetchina/Furion/issues/I2AAN8)
  - &nbsp;<Tag>新增</Tag> `Furion.Extras.Web.HttpContext` 拓展包 [#I29LSM](https://gitee.com/dotnetchina/Furion/issues/I29LSM)
  - &nbsp;<Tag>新增</Tag> 内置 `Token` 刷新机制支持 [#I29K57](https://gitee.com/dotnetchina/Furion/issues/I29K57)
  - &nbsp;<Tag>新增</Tag> 动态数据库上下文，支持运行时执行 `OnModelCreating` [#I28UDT](https://gitee.com/dotnetchina/Furion/issues/I28UDT)
  - &nbsp;<Tag>新增</Tag> 支持依赖注入排除指定接口 [#I29693](https://gitee.com/dotnetchina/Furion/issues/I29693)
  - &nbsp;<Tag>新增</Tag> 规范化结果返回时间戳字段 [#I29697](https://gitee.com/dotnetchina/Furion/issues/I29697)
  - &nbsp;<Tag>新增</Tag> 基础 `CURD` 父类操作例子 [#I296SR](https://gitee.com/dotnetchina/Furion/issues/I296SR)
  - &nbsp;<Tag>新增</Tag> `sql.Change("定位器完整类型名称")` 支持 [#I29LAB](https://gitee.com/dotnetchina/Furion/issues/I29LAB)
  - &nbsp;<Tag>新增</Tag> `UpdateInclude` 和 `UpdateExclude` 忽略空参数支持 [#I29VUG](https://gitee.com/dotnetchina/Furion/issues/I29VUG)
  - &nbsp;<Tag>新增</Tag> 数据库上下文内置假删除查询过滤器支持 [#I29Y2R](https://gitee.com/dotnetchina/Furion/issues/I29Y2R)
  - &nbsp;<Tag>新增</Tag> 忽略空值排除默认时间格式 [#I29VUV](https://gitee.com/dotnetchina/Furion/issues/I29VUV)
  - &nbsp;<Tag>升级</Tag> `MiniProfiler` 组件 [#I297R9](https://gitee.com/dotnetchina/Furion/issues/I297R9)

- **突破性变化**

  - &nbsp;<Tag>调整</Tag> `AppAuthorizeHandler` 授权管道为异步处理 [#I29MD9](https://gitee.com/dotnetchina/Furion/issues/I29MD9)
  - &nbsp;<Tag>调整</Tag> `Swagger` 默认启用 `JWT` 授权支持 [#I29LI4](https://gitee.com/dotnetchina/Furion/issues/I29LI4)
  - &nbsp;<Tag>调整</Tag> `HttpContextUtilities` 名称改为 `HttpContextLocal` [#I29KQE](https://gitee.com/dotnetchina/Furion/issues/I29KQE)
  - &nbsp;<Tag>调整</Tag> `UnifyResultContext` 名称改为 `UnifyContext` [#I29LLZ](https://gitee.com/dotnetchina/Furion/issues/I29LLZ)
  - &nbsp;<Tag>调整</Tag> 只有执行迁移命令才扫描种子数据 [#I29E6P](https://gitee.com/dotnetchina/Furion/issues/I29E6P)
  - &nbsp;<Tag>调整</Tag> 规范化结果 `Successed` 属性名为 `Succeeded` [#I29NMV](https://gitee.com/dotnetchina/Furion/issues/I29NMV)
  - &nbsp;<Tag>移除</Tag> `Mapster` 对象组件，采用提供拓展方式 [#I29D2M](https://gitee.com/dotnetchina/Furion/issues/I29D2M)
  - &nbsp;<Tag>移除</Tag> `CacheManager` 拓展类 [#I29LU1](https://gitee.com/dotnetchina/Furion/issues/I29LU1)
  - &nbsp;<Tag>优化</Tag> `SaveChanges` 拦截器 [#I292LO](https://gitee.com/dotnetchina/Furion/issues/I292LO)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 未注册的数据库上下文也被引用全局查询拦截器 bug [#I29ZXJ](https://gitee.com/dotnetchina/Furion/issues/I29ZXJ)
  - &nbsp;<Tag>修复</Tag> 手动返回 `BadObjectResult` 或 `ValidationProblemDetails` 结果类型时规范化结果失效 bug [#I29ZU9](https://gitee.com/dotnetchina/Furion/issues/I29ZU9)
  - &nbsp;<Tag>修复</Tag> 动态 WebApi `KeepName`，`KeepVerb`、`SplitCamelCase` 无效 bug [#I29X90](https://gitee.com/dotnetchina/Furion/issues/I29X90)
  - &nbsp;<Tag>修复</Tag> `Sql代理` 返回 `元组` 类型出错 bug [#I29SMV](https://gitee.com/dotnetchina/Furion/issues/I29SMV)
  - &nbsp;<Tag>修复</Tag> `401，403` 状态码规范化返回值属性变大写 bug [#I29M8Y](https://gitee.com/dotnetchina/Furion/issues/I29M8Y)
  - &nbsp;<Tag>修复</Tag> `HttpContext` 空异常 bug [#I29LU4](https://gitee.com/dotnetchina/Furion/issues/I29LU4)
  - &nbsp;<Tag>修复</Tag> 接口无返回值没有应用规范化结果 bug [#I29GT7](https://gitee.com/dotnetchina/Furion/issues/I29GT7)
  - &nbsp;<Tag>修复</Tag> 前端 `Less` 配置文件导致主机启动失败 bug [#I29E7P](https://gitee.com/dotnetchina/Furion/issues/I29E7P)
  - &nbsp;<Tag>修复</Tag> 执行 `sql` 结果转泛型后属性重复赋值 bug [#I29BUO](https://gitee.com/dotnetchina/Furion/issues/I29BUO)
  - &nbsp;<Tag>修复</Tag> `Swagger` 关闭 `MiniProfiler` 之后 `组中组` 失效 [#I29789](https://gitee.com/dotnetchina/Furion/issues/I29789)
  - &nbsp;<Tag>修复</Tag> 未启用规范化结果时异常返回 `System.Object` 字符 [#I2969A](https://gitee.com/dotnetchina/Furion/issues/I2969A)
  - &nbsp;<Tag>修复</Tag> 正数数据验证 0 也验证通过 bug [#I2955T](https://gitee.com/dotnetchina/Furion/issues/I2955T)
  - &nbsp;<Tag>修复</Tag> 非泛型类集成泛型接口依赖注入 bug [#I294YT](https://gitee.com/dotnetchina/Furion/issues/I294YT)
  - &nbsp;<Tag>修复</Tag> `Swagger` 不支持 `new` 覆盖父类的 bug [#I28Z1A](https://gitee.com/dotnetchina/Furion/issues/I28Z1A)
  - &nbsp;<Tag>修复</Tag> `JsonSerializerUtility` 没有公开 bug [#I28WMI](https://gitee.com/dotnetchina/Furion/issues/I28WMI)
  - &nbsp;<Tag>修复</Tag> `SqlSugar` 拓展查询泛型类型注册异常 bug [#I28VMT](https://gitee.com/dotnetchina/Furion/issues/I28VMT)
  - &nbsp;<Tag>修复</Tag> `Furion Tools` 不支持生成不同命名空间的实体 bug [#I2A175](https://gitee.com/dotnetchina/Furion/issues/I2A175)
  - &nbsp;<Tag>修复</Tag> 全局拦截器无效 bug [#I2A7T2](https://gitee.com/dotnetchina/Furion/issues/I2A7T2)
  - &nbsp;<Tag>修复</Tag> 新增或更新忽略空值空异常 bug [#I2AB6C](https://gitee.com/dotnetchina/Furion/issues/I2AB6C)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> `Token` 生成加密算法 [#I29KIH](https://gitee.com/dotnetchina/Furion/issues/I29KIH)

- **文档变化**

  - &nbsp;<Tag>新增</Tag> 日志文档 [#I28Y9D](https://gitee.com/dotnetchina/Furion/issues/I28Y9D)
  - &nbsp;<Tag>调整</Tag> 数据库上下文、实体拦截器、配置、一分钟入门等等文档

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> `Swagger` 如何实现授权访问 [#I294F2](https://gitee.com/dotnetchina/Furion/issues/I294F2)
  - &nbsp;<Tag>答疑</Tag> 如何实现多个数据库多对多实体配置 [#I29G6S](https://gitee.com/dotnetchina/Furion/issues/I29G6S)
  - &nbsp;<Tag>答疑</Tag> 动态 WebApi 支持文件上传吗 [#I29R5E](https://gitee.com/dotnetchina/Furion/issues/I29R5E)
  - &nbsp;<Tag>答疑</Tag> 多个数据库上下文无法生成迁移代码 [#I2A6II](https://gitee.com/dotnetchina/Furion/issues/I2A6II)

---

## v1.4.0（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `Furion` 支持二级虚拟目录部署功能 [#I28B77](https://gitee.com/dotnetchina/Furion/issues/I28B77)
  - &nbsp;<Tag>新增</Tag> `Furion.Template.RazorWithWebApi` 脚手架 [#I28QGI](https://gitee.com/dotnetchina/Furion/issues/I28QGI)
  - &nbsp;<Tag>新增</Tag> `Furion.Template.BlazorWithWebApi` 脚手架 [#I27Z3O](https://gitee.com/dotnetchina/Furion/issues/I27Z3O)
  - &nbsp;<Tag>新增</Tag> `EFCore` 时态查询拓展 [#I28AJ](https://gitee.com/dotnetchina/Furion/issues/I28AJ6)
  - &nbsp;<Tag>新增</Tag> `[AppDbContext(连接字符串，数据库类型)]` 配置支持 [#I28QTB](https://gitee.com/dotnetchina/Furion/issues/I28QTB)
  - &nbsp;<Tag>新增</Tag> `DateTimeOffset` 转 `DateTime` 拓展方法 [#I27MQA](https://gitee.com/dotnetchina/Furion/issues/I27MQA)
  - &nbsp;<Tag>新增</Tag> `ValidationTypes` 验证正则表达式智能提示 [#I2801V](https://gitee.com/dotnetchina/Furion/issues/I2801V)
  - &nbsp;<Tag>新增</Tag> `ValiationTypes.WordWithNumber` 验证 [#I2805](https://gitee.com/dotnetchina/Furion/issues/I2805A)
  - &nbsp;<Tag>新增</Tag> 获取客户端和服务端 IP 地址 [#I28QV9](https://gitee.com/dotnetchina/Furion/issues/I28QV9)

- **突破性变化**

  - &nbsp;<Tag>升级</Tag> .NET 5.0 版本至 .NET 5.0.1 版本 [#I28QU](https://gitee.com/dotnetchina/Furion/issues/I28QU1)
  - &nbsp;<Tag>优化</Tag> 视图引擎功能，优化不规范命名和新增字符串模板编译 [#I28G0S](https://gitee.com/dotnetchina/Furion/issues/I28G0S)
  - &nbsp;<Tag>优化</Tag> 数据库实体查找算法，并优化性能 [#I28QUQ](https://gitee.com/dotnetchina/Furion/issues/I28QUQ)
  - &nbsp;<Tag>更新</Tag> 应用启动初始化性能和数据库第一次自动配置 `DbSet` 性能

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 多数据库上下文配置定位器后实体无法正确生成 bug [#I2888L](https://gitee.com/dotnetchina/Furion/issues/I2888L)
  - &nbsp;<Tag>修复</Tag> 多租户数据库上下文实体生成 bug [#I2891G](https://gitee.com/dotnetchina/Furion/issues/I2891G)
  - &nbsp;<Tag>修复</Tag> 对象验证失败提示消息没有应用 `JSON` 大小写配置 bug [#I27UTX](https://gitee.com/dotnetchina/Furion/issues/I27UTX)
  - &nbsp;<Tag>修复</Tag> 仓储 `Insert` 或 `Update` 方法指定 `ignoreNullValues` 无效 bug [#I27UN6](https://gitee.com/dotnetchina/Furion/issues/I27UN6)
  - &nbsp;<Tag>修复</Tag> `Controller` 派生类如果贴了 `[Route]` 特性后出现在 `Swagger` 中 bug [#I27TN7](https://gitee.com/dotnetchina/Furion/issues/I27TN7)
  - &nbsp;<Tag>修复</Tag> `SqlScalar` 执行 `sql` 返回 `Nullable` 类型出现转换失败 bug [#I27S2N](https://gitee.com/dotnetchina/Furion/issues/I27S2N)
  - &nbsp;<Tag>修复</Tag> `[UnitOfWork]` 特性异常 bug [#I27MLM](https://gitee.com/dotnetchina/Furion/issues/I27MLM)
  - &nbsp;<Tag>修复</Tag> `sql` 静态执行方式和 `sql` 高级代理无法监听数据库连接状态 bug [#I27M4F](https://gitee.com/dotnetchina/Furion/issues/I27M4F)
  - &nbsp;<Tag>修复</Tag> 修复更换 Json 序列化库无效 bug，如替换为 `Microsoft.AspNetCore.Mvc.NewtonsoftJson` [#I27M43](https://gitee.com/dotnetchina/Furion/issues/I27M43)
  - &nbsp;<Tag>修复</Tag> `Furion Tools` 工具生成模型 bug [#I27XI5](https://gitee.com/dotnetchina/Furion/issues/I27XI5)
  - &nbsp;<Tag>修复</Tag> 软删除没有生效 bug [#I2804I](https://gitee.com/dotnetchina/Furion/issues/I2804I)
  - &nbsp;<Tag>修复</Tag> `Furion Tools` 识别带多个 `\\` 的连接字符串识别 bug [#I280TS](https://gitee.com/dotnetchina/Furion/issues/I280TS)，[#PR91](https://gitee.com/dotnetchina/Furion/pulls/91)
  - &nbsp;<Tag>修复</Tag> `Furion Tools` 无法取消生成 bug [#I2816M](https://gitee.com/dotnetchina/Furion/issues/I2816M)
  - &nbsp;<Tag>修复</Tag> `DateTimeOffset` 转本地时间差 8 小时 bug [#I28BA9](https://gitee.com/dotnetchina/Furion/issues/I28BA9)
  - &nbsp;<Tag>修复</Tag> 启用 `bundle js&css` 压缩后启动异常 bug [#I28KR](https://gitee.com/dotnetchina/Furion/issues/I28KRP)
  - &nbsp;<Tag>修复</Tag> `ValidationTypes.Required` 无效 bug [#PR98](https://gitee.com/dotnetchina/Furion/pulls/98)
  - &nbsp;<Tag>修复</Tag> 规范化结果`OnValidateFailed` 参数名拼写错误 bug [#PR93](https://gitee.com/dotnetchina/Furion/pulls/93)，[#PR92](https://gitee.com/dotnetchina/Furion/pulls/92)
  - &nbsp;<Tag>修复</Tag> 授权管道验证失败还显示结果 bug [#PR89](https://gitee.com/dotnetchina/Furion/pulls/89)

- **其他更改**

  - &nbsp;<Tag>更新</Tag> README.md 友情连接地址 [#PR88](https://gitee.com/dotnetchina/Furion/pulls/88)
  - &nbsp;<Tag>更新</Tag> 模板脚手架源码，添加 `EFCore Tools` 库 [#PR87](https://gitee.com/dotnetchina/Furion/pulls/87)
  - &nbsp;<Tag>更新</Tag> README.md Nuget 图标 [#PR85](https://gitee.com/dotnetchina/Furion/pulls/85)
  - &nbsp;<Tag>移除</Tag> 将 `List<T>` 转 `DateTable` [#PR97](https://gitee.com/dotnetchina/Furion/pulls/97)

- **文档变化**

  - &nbsp;<Tag>新增</Tag> 视图引擎模板文档 [#I27ZVA](https://gitee.com/dotnetchina/Furion/issues/I27ZVA)
  - &nbsp;<Tag>新增</Tag> `EFCore` 时态查询文档 [#I28AJ](https://gitee.com/dotnetchina/Furion/issues/I28AJ6), [DOC](https://furion.baiqian.ltd/docs/dbcontext-hight-query/#91111-%E6%97%B6%E6%80%81%E6%9F%A5%E8%AF%A2)
  - &nbsp;<Tag>更新</Tag> 仓储文档书写纰漏 bug [#PR90](https://gitee.com/dotnetchina/Furion/pulls/90)
  - &nbsp;<Tag>更新</Tag> 选项文档错误 bug [#PR86](https://gitee.com/dotnetchina/Furion/pulls/86)
  - &nbsp;<Tag>更新</Tag> `实体数据监听器` 文档书写错误 bug [#PR83](https://gitee.com/dotnetchina/Furion/pulls/83/files)
  - &nbsp;<Tag>更新</Tag> 数据库上下文、多数据库、脚手架等文档

- **问答答疑**

  - &nbsp;<Tag>答疑</Tag> 希望 `api` 返回的值自动将 null 转为 `''` 或 `[]` [#I286IJ](https://gitee.com/dotnetchina/Furion/issues/I286IJ)
  - &nbsp;<Tag>答疑</Tag> 添加网关功能 [#I27TP7](https://gitee.com/dotnetchina/Furion/issues/I27TP7)，【已关闭】
  - &nbsp;<Tag>答疑</Tag> 新增 `SqlQuery<T>` 获取单条记录方法 [#I28M1V](https://gitee.com/dotnetchina/Furion/issues/I28M1V)
  - &nbsp;<Tag>答疑</Tag> 希望可以提供集成 `Serilog` 例子 [#I282J4](https://gitee.com/dotnetchina/Furion/issues/I282J4)
  - &nbsp;<Tag>答疑</Tag> 如何通过特性配置唯一约束 [#I2891L](https://gitee.com/dotnetchina/Furion/issues/I2891L)
  - &nbsp;<Tag>答疑</Tag> 怎么读取 `appsettings.json` 数组 [#I27WU](https://gitee.com/dotnetchina/Furion/issues/I27WUR)
  - &nbsp;<Tag>答疑</Tag> `IRepository<TEntity>` 出现空异常 [#I281IE](https://gitee.com/dotnetchina/Furion/issues/I281IE)
  - &nbsp;<Tag>答疑</Tag> 规范化接口问题问题 [#I28NMZ](https://gitee.com/dotnetchina/Furion/issues/I28NMZ)
  - &nbsp;<Tag>答疑</Tag> 统一返回值模型中 OnResponseStatusCodes 未执行 [#I28NNL](https://gitee.com/dotnetchina/Furion/issues/I28NNL)

---

## v1.2.0（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 雪花算法 [#I26OXG](https://gitee.com/dotnetchina/Furion/issues/I26OXG), [#PR78](https://gitee.com/dotnetchina/Furion/pulls/78)
  - &nbsp;<Tag>新增</Tag> `[AppDbContext]` 配置数据库提供器支持 [#I27G3T](https://gitee.com/dotnetchina/Furion/issues/I27G3T)
  - &nbsp;<Tag>新增</Tag> 实体表数据更改监听接口 `IEntityDataChangedListener` [#I278DD](https://gitee.com/dotnetchina/Furion/issues/I278DD), [#I278LQ](https://gitee.com/dotnetchina/Furion/issues/I278LQ)
  - &nbsp;<Tag>新增</Tag> 全局服务接口 AOP 拦截功能 [#I278CP](https://gitee.com/dotnetchina/Furion/issues/I278CP)
  - &nbsp;<Tag>新增</Tag> 定位器仓储 `IDbRepository<TDbContextLocator>` [#I276Q3](https://gitee.com/dotnetchina/Furion/issues/I276Q3)
  - &nbsp;<Tag>新增</Tag> 数据库操作 `InsertOrUpdate` 支持排除空字符串功能 [#I272OG](https://gitee.com/dotnetchina/Furion/issues/I272OG)
  - &nbsp;<Tag>新增</Tag> 数据库操作 `UpdateInclude` 和 `UpdateExclude` 匿名对象支持 [#I271X0](https://gitee.com/dotnetchina/Furion/issues/I271X0)
  - &nbsp;<Tag>新增</Tag> 数据验证传入空对象跳过验证支持 [#I273R4](https://gitee.com/dotnetchina/Furion/issues/I273R4)
  - &nbsp;<Tag>新增</Tag> 应用启动时支持排除特定配置文件自动加载 [#I26U0A](https://gitee.com/dotnetchina/Furion/issues/I26U0A)
  - &nbsp;<Tag>新增</Tag> 单个实体表名前缀支持 [#I26LX0](https://gitee.com/dotnetchina/Furion/issues/I26LX0)
  - &nbsp;<Tag>新增</Tag> `MySql` 数据库自动配置默认版本号 [#I26XQ6](https://gitee.com/dotnetchina/Furion/issues/I26XQ6)
  - &nbsp;<Tag>更新</Tag> 授权处理程序代码

- **突破性变化**

  - &nbsp;<Tag>新增</Tag> 实体表数据更改监听接口 `IEntityDataChangedListener` [#I278DD](https://gitee.com/dotnetchina/Furion/issues/I278DD), [#I278LQ](https://gitee.com/dotnetchina/Furion/issues/I278LQ)
  - &nbsp;<Tag>新增</Tag> 全局服务接口 AOP 拦截功能 [#I278CP](https://gitee.com/dotnetchina/Furion/issues/I278CP)
  - &nbsp;<Tag>新增</Tag> 雪花算法 [#I26OXG](https://gitee.com/dotnetchina/Furion/issues/I26OXG), [#PR78](https://gitee.com/dotnetchina/Furion/pulls/78)

- **问题修复**

  - &nbsp;<Tag>修复</Tag> 视图引擎加载外部程序集出错 bug
  - &nbsp;<Tag>修复</Tag> 依赖注入代理接口报空对象异常 bug
  - &nbsp;<Tag>修复</Tag> `EFCore` 取消附加实体出错 bug
  - &nbsp;<Tag>修复</Tag> 数据库仓储在非 Web 请求下出现空异常 bug
  - &nbsp;<Tag>修复</Tag> 多个授权策略共存问题出现无效 bug
  - &nbsp;<Tag>修复</Tag> 友好异常 `Oop.Oh` 不支持普通方法 bug
  - &nbsp;<Tag>修复</Tag> 获取多租户对象时数据库上下文出现作用域验证失败 bug
  - &nbsp;<Tag>修复</Tag> 工作单元不支持 `Sql代理` 拦截 bug [#I27GST](https://gitee.com/dotnetchina/Furion/issues/I27GST)

- **文档变化**

  - &nbsp;<Tag>新增</Tag> [实体数据监听器](https://furion.baiqian.ltd/docs/dbcontext-entitytrigger) 文档
  - &nbsp;<Tag>更新</Tag> 一分钟入门、应用启动、官方脚手架、数据库操作指南、对象映射、规范化文档、异常处理、鉴权授权文档

---

## v1.1.0（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `Db.GetDbContext()` 获取默认数据库上下文方法
  - &nbsp;<Tag>新增</Tag> `HttpContextUtility.GetCurrentHttpContext()` 获取全局 `HttpContext` 上下文
  - &nbsp;<Tag>新增</Tag> `App.GetRequiredService<>` 解析服务方法
  - &nbsp;<Tag>新增</Tag> `object.GetService<>` 对象拓展方法
  - &nbsp;<Tag>新增</Tag> 策略授权 `PolicyPipeline` 基类方法，支持多重判断授权
  - &nbsp;<Tag>新增</Tag> `JWTEncryption.ValidateJwtBearerToken` 手动验证静态方法
  - &nbsp;<Tag>新增</Tag> 全局数据库上下文 `InsertOrUpdateIgnoreNullValues` 和 `EnabledEntityStateTracked` 全局配置
  - &nbsp;<Tag>新增</Tag> `Swagger Jwt授权` 全局授权参数 [#I26GLR](https://gitee.com/dotnetchina/Furion/issues/I26GLR)
  - &nbsp;<Tag>新增</Tag> `InsertOrUpdate` 支持自定义判断条件功能 [#I269Q1](https://gitee.com/dotnetchina/Furion/issues/I269Q1)
  - &nbsp;<Tag>新增</Tag> 字符串字段小写命名支持 [#I2695D](https://gitee.com/dotnetchina/Furion/issues/I2695D)
  - &nbsp;<Tag>新增</Tag> 字符串文本对比功能 [#I268LE](https://gitee.com/dotnetchina/Furion/issues/I268LE)
  - &nbsp;<Tag>新增</Tag> 全局异常特性消息功能 [#I2662O](https://gitee.com/dotnetchina/Furion/issues/I2662O)
  - &nbsp;<Tag>新增</Tag> `Insert` 或 `Update` 数据库忽略空值功能 [#I264Q4](https://gitee.com/dotnetchina/Furion/issues/I264Q4)

- **突破性变化**

  - &nbsp;<Tag>调整</Tag> `Fur` 项目名为 `Furion`
  - &nbsp;<Tag>调整</Tag> `Db.GetRequestDbContext<>()` 命名为 `Db.GetDbContext<>()`
  - &nbsp;<Tag>调整</Tag> `Db.GetDbContext<>()` 命名为 `Db.GetDuplicateDbContext<>()`
  - &nbsp;<Tag>优化</Tag> `App.GetService<>` 解析服务的底层逻辑，大大提高了解析服务的性能
  - &nbsp;<Tag>优化</Tag> 授权核心代码，保持和微软一致的授权规范 [#I26DCB](https://gitee.com/dotnetchina/Furion/issues/I26DCB)
  - &nbsp;<Tag>移除</Tag> `App.GetRequestService<>` 方法
  - &nbsp;<Tag>移除</Tag> `ValidateJwtBearer` Jwt 授权方法，无需手动判断了

- **问题修复**

  - &nbsp;<Tag>修复</Tag> Furion 官方脚手架生成后编译异常 bug
  - &nbsp;<Tag>修复</Tag> `Tenant` 内置属性不是 `virtual` 修饰 bug
  - &nbsp;<Tag>修复</Tag> `dockerfile` 新命名构建失败 bug
  - &nbsp;<Tag>修复</Tag> 自定义角色授权和多个授权共存出现 403 bug [#I26H1L](https://gitee.com/dotnetchina/Furion/issues/I26H1L)
  - &nbsp;<Tag>修复</Tag> `httpContext.GetEndpoint()` 空异常 bug [#PR73](https://gitee.com/dotnetchina/Furion/pulls/73)
  - &nbsp;<Tag>修复</Tag> `Oops.Oh` 空异常和不支持服务抛异常 bug [#I26EFU](https://gitee.com/dotnetchina/Furion/issues/I26EFU)，[#I26GM4](https://gitee.com/dotnetchina/Furion/issues/I26GM4)
  - &nbsp;<Tag>修复</Tag> `cli.ps` 生成文件编码乱码 bug [#I26DVT](https://gitee.com/dotnetchina/Furion/issues/I26DVT)
  - &nbsp;<Tag>修复</Tag> `Swagger` 文件上传按钮不显示 [#I26B6U](https://gitee.com/dotnetchina/Furion/issues/I26B6U)
  - &nbsp;<Tag>修复</Tag> 规范化结果授权状态码序列化大小写不一致问题 [#I26B26](https://gitee.com/dotnetchina/Furion/issues/I26B26)
  - &nbsp;<Tag>修复</Tag> 未启用规范化结果时中文乱码 bug [#I268T5](https://gitee.com/dotnetchina/Furion/issues/I268T5)
  - &nbsp;<Tag>修复</Tag> `MySql` 异步异常捕获不到 bug [#I265SO](https://gitee.com/dotnetchina/Furion/issues/I265SO)
  - &nbsp;<Tag>修复</Tag> `cli.ps1` 提示找不到数据库连接字符串 bug [#I2647U](https://gitee.com/dotnetchina/Furion/issues/I2647U)

- **其他更改**

  - &nbsp;<Tag>优化</Tag> 代码性能小优化和小调整

- **文档变化**

  - &nbsp;<Tag>更新</Tag> 一分钟入门、安全鉴权、数据库等文档

---

## v1.0.3（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> Mvc 模板脚手架：`Fur.Template.Mvc`
  - &nbsp;<Tag>新增</Tag> WebApi 模板：`Fur.Template.Api`
  - &nbsp;<Tag>新增</Tag> Mvc/WebApi 模板：`Fur.Template.App`
  - &nbsp;<Tag>新增</Tag> Razar Pages 模板：`Fur.Template.Razor`
  - &nbsp;<Tag>新增</Tag> Blazor 模板：`Fur.Template.Blazor`

- **突破性变化**

  - &nbsp;<Tag>调整</Tag> `PagedList` 到 `System.Collections.Generic` 命名空间下
  - &nbsp;<Tag>更新</Tag> 解析服务性能问题，底层代码大量优化

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `ApiSears.ControllerEnd`不起作用 bug [#I25KH6](https://gitee.com/dotnetchina/Furion/issues/I25KH6)
  - &nbsp;<Tag>修复</Tag> `RemoteRequest` 请求完成结果序列化属性大小写问题 [#I25I8R](https://gitee.com/dotnetchina/Furion/issues/I25I8R)
  - &nbsp;<Tag>修复</Tag> `HttpContext.GetEndpoinet()` 空异常 bug [#PR73](https://gitee.com/dotnetchina/Furion/pulls/73)

- **文档变化**

  - &nbsp;<Tag>更新</Tag> 入门文档、数据库上下文文档、多数据库操作文档

---

## v1.0.2（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> `Pomelo.EntityFrameworkCore.MySql` 最新 .NET 5 包配置 [#I24ZQK](https://gitee.com/dotnetchina/Furion/issues/I24ZQK)
  - &nbsp;<Tag>新增</Tag> `.AddDateTimeJsonConverter(format)` 时间格式序列化配置
  - &nbsp;<Tag>新增</Tag> `DateTime` 和 `DateTimeOffset` 类型序列化格式配置 [#I253FI](https://gitee.com/dotnetchina/Furion/issues/I253FI)

- **突破性变化**

  - &nbsp;<Tag>更新</Tag> `Mapster` 包至 `7.0.0` 版
  - &nbsp;<Tag>调整</Tag> `App.Services` 名为 `App.ServiceProvider`
  - &nbsp;<Tag>移除</Tag> `App.ApplicationServices` 和 `App.GetRequestService<>()`
  - &nbsp;<Tag>移除</Tag> 非 Web 主机注入拓展

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `services.AddFriendlyException()` 缺少配置注入 bug
  - &nbsp;<Tag>修复</Tag> 数据库上下文池被释放和高并发下内存溢出 bug [#I2524K](https://gitee.com/dotnetchina/Furion/issues/I2524K)，[#I24UMN](https://gitee.com/dotnetchina/Furion/issues/I24UMN)
  - &nbsp;<Tag>修复</Tag> `Sql代理` 返回空数据时异常 bug [#I24TCK](https://gitee.com/dotnetchina/Furion/issues/I24TCK)
  - &nbsp;<Tag>修复</Tag> 工作单元 `[UnitOfWork]` 多数据库被释放 bug [#I24Q6W](https://gitee.com/dotnetchina/Furion/issues/I24Q6W)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> `EntityBase` 和 `Entity` 所有属性为 `vitural` 修饰
  - &nbsp;<Tag>更新</Tag> `Jwt` 读取和解析性能
  - &nbsp;<Tag>更新</Tag> 优化代码支持 C# 9.0 最新语法
  - &nbsp;<Tag>更新</Tag> `MD5` 加密性能 [#PR71](https://gitee.com/dotnetchina/Furion/pulls/71)
  - &nbsp;<Tag>移除</Tag> 无用或未使用代码

- **文档**

  - &nbsp;<Tag>更新</Tag> 数据库上下文、多数据库、一分钟入门文档

---

## v1.0.0（已发布）

- **新特性**

  - &nbsp;<Tag>新增</Tag> 网络请求 `RemoteRequest` 组件 [#I1YYWD](https://gitee.com/dotnetchina/Furion/issues/I1YYWD)
  - &nbsp;<Tag>新增</Tag> `.AddInjectBase()` 注入，只包含基础服务注入
  - &nbsp;<Tag>新增</Tag> 所有服务都支持 `IServiceCollection` 和 `IMvcBuilder` 注入
  - &nbsp;<Tag>新增</Tag> 抛异常状态码设置功能 `StatusCode`
  - &nbsp;<Tag>新增</Tag> `Swagger` 序列化支持 `Pascal` 属性命名方式

- **突破性变化**

  - &nbsp;<Tag>更新</Tag> **所有的包为 `.NET 5` 正式版**

- **问题修复**

  - &nbsp;<Tag>修复</Tag> `SqlProxy` 代理异步处理 bug
  - &nbsp;<Tag>修复</Tag> 数据库类型 `Datetime` 转 `DateTimeOffset` bug
  - &nbsp;<Tag>修复</Tag> 属性首字母大小写序列化不匹配出现 `null` bug
  - &nbsp;<Tag>修复</Tag> 对象序列化中文出现乱码 bug
  - &nbsp;<Tag>修复</Tag> 默认序列化配置无效 bug
  - &nbsp;<Tag>修复</Tag> 数据库非依赖注入方式提交无效 bug
  - &nbsp;<Tag>修复</Tag> 应用程序池提交所有 `DbContext` 空异常 bug
  - &nbsp;<Tag>修复</Tag> `Saas` 多租户 `Tenant` 类型字符串属性在 `MySql` 数据库下出现 `longtext` 类型 bug
  - &nbsp;<Tag>修复</Tag> `Mvc` 自动验证字符串空值 bug [#I24M2T](https://gitee.com/dotnetchina/Furion/issues/I24M2T)
  - &nbsp;<Tag>修复</Tag> 枚举注释被覆盖 bug [#I24N6J](https://gitee.com/dotnetchina/Furion/issues/I24N6J)
  - &nbsp;<Tag>修复</Tag> 忽略规范化结果无效 bug [#I24B8P](https://gitee.com/dotnetchina/Furion/issues/I24B8P)
  - &nbsp;<Tag>修复</Tag> `Swagger` 默认 `ContentType` 不是 `applicaiton/json` bug [#I24F3U](https://gitee.com/dotnetchina/Furion/issues/I24F3U)
  - &nbsp;<Tag>修复</Tag> 内置 `System.Text.Json` 和 `Newtonsoft.Json` 冲突 bug [#I24F3U](https://gitee.com/dotnetchina/Furion/issues/I24F3U)

- **其他更改**

  - &nbsp;<Tag>调整</Tag> `Fur` 框架域名为：[https://furion.icu](https://furion.icu)
  - &nbsp;<Tag>调整</Tag> 仓储 `FromSqlRaw` 和 `FromSqlInterpolated` 接口位置
  - &nbsp;<Tag>更新</Tag> 数据加解密性能，[#PR70](https://gitee.com/dotnetchina/Furion/pulls/70)

- **文档**

  - &nbsp;<Tag>更新</Tag> README.md、框架介绍、数据库上下文、配置选项、多租户、跨域文档
